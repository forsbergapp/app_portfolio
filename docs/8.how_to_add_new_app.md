# How to add a new app
    ECMAScript is used in project meaning package.json contains type:module.
    pm2 starts server setting current work directory to app root directory so use process.cwd() when needed.
    Import module with dynamic import() from ES2020 with this example syntax:
        import(`file://${process.cwd()}/apps/index.js`).then(function({ check_app_subdomain}){
# Required
    /apps/{APP_ID}/scripts/			database scripts, run as database admin
                                    required (change [] values):
                                    
                                    CREATE USER app[APP_ID] ...
                                    GRANT role_app_common TO app[APP_ID];
                                    
                                    INSERT INTO app_portfolio.app 
                                    (id, app_name, url, logo, enabled, app_category_id) 
                                    VALUES ([APP_ID]],[APP_NAME],[APP_URL],[APP_LOGO_PATH], 1, [APP_CATEGORY_ID]);
                                    INSERT INTO app_portfolio.app_parameter 
                                    (app_id, parameter_type_id, parameter_name, parameter_value, parameter_comment) 
                                    VALUES ([APP_ID],'2','SERVICE_DB_APP_USER',[DB_USERNAME],NULL);
                                    INSERT INTO app_portfolio.app_parameter (app_id, parameter_type_id, parameter_name, parameter_value, parameter_comment) 
                                    VALUES ([APP_ID],'2','SERVICE_DB_APP_PASSWORD',[DB_PASSWORD],NULL);
                    

    required files and folders
    /apps/{APP_ID}*					contains client app files and server code
    /apps/{APP_ID}/server.js		review /apps/[OTHER APP_ID]/server.js										
                                    minimum:
                                    const APP[APP_ID]_ID = [APP_ID];
                                    app.get('/',function (req, res, next) {
                                        import(`file://${process.cwd()}/apps/index.js`).then(function({ check_app_subdomain}){
                                            if (check_app_subdomain(APP[APP_ID]_ID, req.headers.host)){
                                                import(`file://${process.cwd()}/service/forms/forms.controller.js`).then(function({getForm}){
                                                    getForm(req, res, APP[APP_ID]_ID, null,(err, app_result)=>{
                                                                                                return res.send(app_result);
                                                                                            })
                                                })
                                            }
                                            else
                                                next();
                                        })
                                    });
                                    

    /apps/{APP_ID}/client.js		review /apps/[OTHER APP_ID]/client.js
                                    minimum:
                                    
                                    function getApp(app_id, params, gps_lat, gps_long, gps_place){
                                        return new Promise(function (resolve, reject){
                                            const files = [
                                                ['APP', process.cwd() + '/apps/app[APP_ID]]/src/index.html']
                                            ];
                                            import(`file://${process.cwd()}/apps/index.js`).then(function({read_app_files}){
                                                read_app_files(app_id, files, (err, app)=>{
                                                    if (err)
                                                        reject(err);
                                                    else
                                                        resolve(app_init);
                                                })
                                            })
                                        })
                                    }
                                    export{getApp};

    /apps/{APP_ID}/src				app files referred from /apps/{APP_ID}/client.js
                                    minimum:
                                    index.html
                                        <!DOCTYPE html>
                                        <html>
                                        <head>
                                            <meta charset='UTF-8'>
                                            <title></title>
                                        </head>	
                                        <body>
                                        </body>
                                        </html>

# Optional
    client:
    /apps/{APP_ID}/css						styles
    /apps/{APP_ID}/images					images
    /apps/{APP_ID}/js						javascript
    /apps/{APP_ID}/scripts					database scripts
    /apps/{APP_ID}/sw.js					service worker for PWA apps
    server:
    /apps/{APP_ID}/info						info pages about disclaimer, privacy_policy, terms
    /apps/{APP_ID}/mail						mail
    /apps/{APP_ID}/report					reports
    /service/db/app_portfolio/app{APP_ID}*	rest api for app{APP_ID}

    common client:
    /apps/common/audio						audio
    /apps/common/css						styles
    /apps/common/images						images
    /apps/common/js							javascript
    /apps/common/modules					referred from /apps/common/src/head_[MODULE].html files
                                            use /apps/common/src/
    common server:
    /apps/common/src/						referred from /apps/{APP_ID}/client.js
    /apps/common/report/					referred from /apps/{APP_ID}/report

# How apps are identified
    Apps clients use window.global_app_id to identify themselves
    Common and admin uses window.global_common_app_id derived from server parameter APP_COMMON_APP_ID.

#   Restart NodeJS server to automatically load the new app.
    pm2 restart all

    Observe that apps can be enabled and disabled in table app_portfolio.app and 
    updating column enabled to 0 or 1.