# Install Docker
    
    Install Docker if used. Alternative database installation is local installation.

    Ubuntu
        sudo apt-get update
        sudo install -m 0755 -d /etc/apt/keyrings
        curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg
        sudo chmod a+r /etc/apt/keyrings/docker.gpg
        echo \
        "deb [arch="$(dpkg --print-architecture)" signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/ubuntu \
        "$(. /etc/os-release && echo "$VERSION_CODENAME")" stable" | \
        sudo tee /etc/apt/sources.list.d/docker.list > /dev/null
        sudo apt-get update
        sudo apt-get install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin

    Windows
        --download from https://www.docker.com/get-started/
        in Docker Desktop:
        disable "send usage statistics", "Automatically check for updates", "Enable docker extensions"
		choose troubleshoot icon, click restart

# Install database
    MariaDB

        docker installation:

            Ubuntu
            sudo docker pull mariadb:11.1.2

            --set value for nodejs module authentication plugin setting, to accept connection from all sources
            --and network performance tweak
            --use single quote for password on Ubuntu
            sudo docker run --name mariadb -p 3306:3306 -e MYSQL_ROOT_PASSWORD=['PASSWORD'] -d mariadb:11.1.2 --default-authentication-plugin=mysql_native_password --skip-name-resolve --bind-address=0.0.0.0

            --enter filesystem when needed
            sudo docker exec -t -i mariadb bash

            Windows
            
            docker pull mariadb:11.1.2

            --set value for nodejs module authentication plugin setting and network performance tweak
            docker run --name mariadb -p 3306:3306 -e MYSQL_ROOT_PASSWORD=[ROOT_PASSWORD] -d mariadb:11.1.2 --default-authentication-plugin=mysql_native_password --skip-name-resolve
            
        local installation:

            Ubuntu
            sudo apt install software-properties-common dirmngr apt-transport-https 
	        sudo apt-key adv --fetch-keys 'https://mariadb.org/mariadb_release_signing_key.asc' 
	        sudo add-apt-repository 'deb [arch=amd64,arm64,ppc64el] https://atl.mirrors.knownhost.com/mariadb/repo/10.8/ubuntu jammy main' 
	        sudo apt update 
	        sudo apt install mariadb-server 
            --accept remote connections
            sudo cp /etc/mysql/mariadb.conf.d/50-server.cnf /etc/mysql/mariadb.conf.d/50-server.cnf.bkp
	        sudo vi /etc/mysql/mariadb.conf.d/50-server.cnf 
	        --set bind-address = 0.0.0.0
	        sudo systemctl restart mariadb

            --set admin password
            sudo mysql -u root

            ALTER USER 'root'@'localhost' IDENTIFIED BY 'PASSWORD';
            --alternative
            ALTER USER 'root'@'localhost' IDENTIFIED VIA mysql_native_password USING PASSWORD('PASSWORD');
            --remote access
            CREATE USER 'root'@'%' identified by 'PASSWORD';
            GRANT ALL PRIVILEGES ON *.* to 'root'@'%' WITH GRANT OPTION;

            Windows
            --download from https://mariadb.com/downloads/
            --set admin password
            mysql -u root
        
        Ubuntu for both docker and local installation:

            --firewall
	        sudo firewall-cmd --zone=public --permanent --add-port=3306/tcp
	        sudo firewall-cmd --reload

    MySQL

        docker installation:

            Ubuntu
            //use Oracle Linux (or mysql:8.0.34-debian if not using arm64 platform)
            sudo docker pull mysql:8.0.34

            --set value for nodejs module authentication plugin setting, to accept connection from all sources
            --and network performance tweak
            --use single quote for password on Ubuntu
            sudo docker run --name mysql -p 3307:3306 -e MYSQL_ROOT_PASSWORD=['PASSWORD'] -d mysql:8.0.34 --default-authentication-plugin=mysql_native_password --skip-name-resolve --bind-address=0.0.0.0 

            --enter filesystem when needed
            sudo docker exec -t -i mysql bash

            Windows
            
            docker pull mysql:8.0.34-debian

            --set value for nodejs module authentication plugin setting and network performance tweak
            docker run --name mysql -p 3307:3306 -e MYSQL_ROOT_PASSWORD=[ROOT_PASSWORD] -d mysql:8.0.34-debian --default-authentication-plugin=mysql_native_password --skip-name-resolve
            
        local installation:

            Ubuntu
            sudo apt install mysql-server
            sudo systemctl start mysql.service

            --if using both MariaDB and MySQL on same server use different path to mysql
            mysql -uroot -p
            ALTER USER 'root'@'localhost' IDENTIFIED WITH mysql_native_password BY 'PASSWORD';

            --remote access
            CREATE USER 'root'@'%' IDENTIFIED WITH mysql_native_password BY 'PASSWORD';
            GRANT ALL PRIVILEGES ON *.* to 'root'@'%' WITH GRANT OPTION;

            --accept remote connections
            sudo cp /etc/mysql/mysql.conf.d/mysqld.cnf /etc/mysql/mysql.conf.d/mysqld.cnf.bkp
            sudo vi /etc/mysql/mysql.conf.d/mysqld.cnf
            --set bind-address = 0.0.0.0

            Windows
            --download from https://dev.mysql.com/downloads/

        Ubuntu for both docker and local installation:

            --firewall
            --if using both MariaDB and MySQL on same server use different ports
            sudo firewall-cmd --zone=public --permanent --add-port=3307/tcp
	        sudo firewall-cmd --reload

    PostgreSQL

        docker installation:

            Ubuntu
            sudo docker pull postgres:15.4
            --add accept connections from any source
            sudo docker run --name postgres -p 5432:5432 -e POSTGRES_PASSWORD=['PASSWORD'] -d postgres:15.4 -c listen_addresses='*'

            --enter filesystem when needed
            sudo docker exec -t -i postgres bash

            windows
            docker pull postgres:15.4
            docker run --name postgres -p 5432:5432 -e POSTGRES_PASSWORD=[PASSWORD] -d postgres:15.4

        local installation:

            Ubuntu
            --install v 14
            sudo apt install postgresql

            --install v 15.X
            sudo sh -c 'echo "deb http://apt.postgresql.org/pub/repos/apt $(lsb_release -cs)-pgdg main" > /etc/apt/sources.list.d/pgdg.list'
	        wget --quiet -O - https://www.postgresql.org/media/keys/ACCC4CF8.asc | sudo apt-key add -
	        --edit if necessary for arm64 platform or skip edit
            sudo vi /etc/apt/sources.list.d/pgdg.list
    		    add [arch=arm64]: deb [arch=arm64] http://apt.postgresql.org/pub/repos/apt jammy-pgdg main
	        sudo apt-get update
	        sudo apt-get -y install postgresql
            sudo systemctl start postgresql.service

            --set admin password
            sudo -i -u postgres
            psql
            ALTER USER postgres PASSWORD 'PASSWORD';

            --remote access
            sudo cp /etc/postgresql/15/main/postgresql.conf /etc/postgresql/15/main/postgresql.conf.bkp
	        sudo vi /etc/postgresql/15/main/postgresql.conf
	        --edit
    	        #listen_addresses = 'localhost'
	        --with
    	        #listen_addresses = '*'

	        sudo cp /etc/postgresql/15/main/pg_hba.conf /etc/postgresql/15/main/pg_hba.conf.bkp
	        sudo vi /etc/postgresql/15/main/pg_hba.conf
	        --edit	
    	        host    all             all             127.0.0.1/32            scram-sha-256
	        --with
    	        host    all             all             0.0.0.0/0            	scram-sha-256
            
            remove postgresql
	        sudo apt-get --purge remove postgresql postgresql-15 postgresql-client-15  postgresql-client-common postgresql-common postgresql-14
            sudo rm -rfv /var/log/postgresql
            sudo rm -rfv /var/lib/postgresql
            sudo rm -rfv /etc/postgresql
            sudo rm -rfv /etc/postgresql-common

            Windows

            --download from https://www.postgresql.org/download/windows/
            psql
            ALTER USER postgres PASSWORD 'PASSWORD';

        Ubuntu for both docker and local installation:
        --firewall
        sudo firewall-cmd --zone=public --permanent --add-port=5432/tcp
	    sudo firewall-cmd --reload

        
    Oracle
        Ubuntu
        --No local database installation support, recommend to use Oracle Cloud
        --Oracle Instant Client for NodeJS, arm64 example
        sudo apt install unzip
        cd $HOME
        wget https://download.oracle.com/otn_software/linux/instantclient/191000/instantclient-basic-linux.arm64-19.10.0.0.0dbru.zip
	    wget https://download.oracle.com/otn_software/linux/instantclient/191000/instantclient-sqlplus-linux.arm64-19.10.0.0.0dbru.zip
	    wget https://download.oracle.com/otn_software/linux/instantclient/191000/instantclient-tools-linux.arm64-19.10.0.0.0dbru.zip
        unzip instantclient-basic-linux.arm64-19.10.0.0.0dbru.zip
        unzip instantclient-sqlplus-linux.arm64-19.10.0.0.0dbru.zip
        unzip instantclient-tools-linux.arm64-19.10.0.0.0dbru.zip
        cd instantclient_19_10
        sudo apt -y install patchelf
	    patchelf --set-interpreter /lib/ld-linux-aarch64.so.1 sqlplus
	    patchelf --set-interpreter /lib/ld-linux-aarch64.so.1 adrci
	    patchelf --set-interpreter /lib/ld-linux-aarch64.so.1 exp
	    patchelf --set-interpreter /lib/ld-linux-aarch64.so.1 expdp
	    patchelf --set-interpreter /lib/ld-linux-aarch64.so.1 genezi
	    patchelf --set-interpreter /lib/ld-linux-aarch64.so.1 imp
	    patchelf --set-interpreter /lib/ld-linux-aarch64.so.1 impdp
	    patchelf --set-interpreter /lib/ld-linux-aarch64.so.1 sqlldr
	    patchelf --set-interpreter /lib/ld-linux-aarch64.so.1 sqlplus
	    patchelf --set-interpreter /lib/ld-linux-aarch64.so.1 uidrvci
	    patchelf --set-interpreter /lib/ld-linux-aarch64.so.1 wrc
        mkdir $HOME/app_portfolio/config/oracle_instantclient
        mkdir $HOME/app_portfolio/config/oracle_instantclient/network
        mkdir $HOME/app_portfolio/config/oracle_instantclient/network/admin
        cp * $HOME/app_portfolio/config/oracle_instantclient
        sudo sh -c "echo $HOME/app_portfolio/config/oracle_instantclient > /etc/ld.so.conf.d/oracle-instantclient.conf"
	    sudo ldconfig
        --download wallet.zip from Oracle Cloud
        unzip wallet.zip $HOME/app_portfolio/config/oracle_instantclient/network/admin
        --edit DIRECTORY in sqlnet.ora ${HOME}/app_portfolio/config/oracle_instantclient/network/admin
        --serverparameters for Oracle Client to be set in /service/db/config/config.json (set full path without variables):
            LIBRARY_DIR :[$HOME/app_portfolio/config/oracle_instantclient]
            CONFIG_DIR  :[$HOME/app_portfolio/config/oracle_instantclient/network/admin]
        
        Windows
        --no local database support, recommend to use Oracle Cloud
        --Oracle Instant Client for NodeJS
        --download from https://www.oracle.com/database/technologies/instant-client/winx64-64-downloads.html
        --copy files to %HOMEPATH%\app_portfolio\config\oracle_instantclient
        --download wallet.zip from Oracle Cloud
        unzip wallet.zip %HOMEPATH%\app_portfolio\config\oracle_instantclient\network\admin
        --edit DIRECTORY in sqlnet.ora ${HOMEPATH}\app_portfolio\config\oracle_instantclient\network\admin
        --serverparameters for Oracle Client to be set in /service/db/config/config.json (set full path without variables):
            LIBRARY_DIR :[%HOMEPATH%\app_portfolio\config\oracle_instantclient]
            CONFIG_DIR  :[%HOMEPATH%\app_portfolio\config\oracle_instantclient\network\admin]

# Install database scripts
    Install and uninstall database from admin app. When finished a list of usernames and password
    will be shown with passwords using SHA256 encryption.
    
    No extra database utilites needed. Using npm database modules to create and drop database.

    Estimated time to install a new database:
    Without optional translations: 20 seconds - 1 minute   (about 7000 records)
    With optional translations:    3 minutes - 20 minutes  (about 140000 records)
    Demo data:                     10 seconds - 1 minute   (1770 records with images)
    
# Info users and roles
    USER CREATED		ROLE AND APP_ID INFO
    ------------		--------------------
    app_portfolio		role ROLE_APP_DBA
                        database user, do not use in app,
                        use app users with less privileges for a more secure app

    app_admin			role ROLE_APP_ADMIN
                        app admin in app
                        DELETE/INSERT/SELECT/UPATE all tables, but no DDL
    app[app_id]	users	role ROLE_APP_COMMON

    admin               super admin user for admin app