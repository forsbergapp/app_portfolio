<script type="importmap">
    {
        "imports": {
            "app"       : "/app4/js/app.js",
            "common"	: "/common/js/common.js",
            "leaflet"   : "/common/modules/leaflet/leaflet-src.module.js",
            "React" 	: "/common/modules/react/react.development.js",
            "ReactDOM" 	: "/common/modules/react/react-dom.development.js"
        }
    }
</script>
<script type="module">
    import React from 'React';
    import ReactDOM from 'ReactDOM';
    import('common').then(({APP_SPINNER})=>{
        document.querySelector('#loading').innerHTML = APP_SPINNER;
    });
</script>
<script src="/common/modules/babel/babel.7.22.7.js"></script>
<script>
    function console_custom(stack, message, message_type){
        let e = stack.split("@");
        for (let line of [...e].reverse()) {
            if (line.includes('react')==true){
                //console.log('React log:' +  message);
                console.log('React...');
                return null;
            }                        
            if (line.includes('babel')==true){
                //console.log('Babel log:'  +  message);   
                console.log('Babel...');
                return null;
            }
        }
        //No React or babel found use normal console function
        if (message_type =='i')
            console.info(message);
        if (message_type =='w')
            console.warn(message);
        return null;
    }
    //Babel uses console.warn
    console.warn = (e) => {let stack = new Error().stack; console_custom(stack, e, 'w');};
    //React uses console.info
    console.info = (i) => {let stack = new Error().stack; console_custom(stack, i, 'i');};
</script>
<script type="text/babel" data-type="module">
    import('app').then((app)=>{
        const App = () => {
            //onClick handles single and doubleclick in this React component since onClick and onDoubleClick does not work in React
            //without tricks
            //using dblClick on leaflet on() function to get coordinates
            return (<div id='mapid' onClick={(e) => {app.map_click_event(event)}}></div>);
        };
        const application = ReactDOM.createRoot(document.querySelector('#app_react'));
        application.render( <App/>); 
        //div mapid must be mounted in React before app.init() in this case
        app.init(<ITEM_COMMON_PARAMETERS/>).then(()=>{});
    });
</script>


<link rel='stylesheet' type='text/css' href='/app4/css/app.css' />
<link rel='icon' type='image/png' href='/app4/images/favicon-32x32.png' sizes='32x32'>
<link rel='icon' type='image/png' href='/app4/images/favicon-192x192.png' sizes='192x192'>
