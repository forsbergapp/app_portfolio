



    
    <div class='section'>
        <div class='article'>
            <pre class="prettyprint source linenums"><code>/**
 * Displays stat of users
 * @module apps/admin/component/menu_users_list
 */

/**
 * @import {CommonModuleCommon, COMMON_DOCUMENT,CommonComponentLifecycle}  from '../../../common_types.js'
 */

/**
 * @name template
 * @description Template
 * @function
 * @param {{user_account_id:number,
 *          users:[{id:number,
 *                  avatar:string, 
 *                  active:0|1|null,
 *                  user_level:number|null,
 *                  private:number|null,
 *                  username:string,
 *                  bio:string,
 *                  email:string,
 *                  email_unverified:string,
 *                  password_reminder:string,
 *                  verification_code:string,
 *                  identity_provider:number,
 *                  provider_name:string,
 *                  provider_id:string,
 *                  provider_first_name:string,
 *                  provider_last_name:string,
 *                  provider_image:string,
 *                  provider_image_url:string,
 *                  provider_email:string,
 *                  date_created:string
 *                  date_modified:string
 *                  }]|[],
 *          function_get_order_by:function}} props
 * @returns {string}
 */
const template = props => ` &lt;div class='menu_users_list_row'>
                                &lt;div data-column='avatar' class='menu_users_list_col list_title common_icon ${props.function_get_order_by('avatar')}'>&lt;/div>
                                &lt;div data-column='id' class='menu_users_list_col list_sort_click list_title common_icon ${props.function_get_order_by('id')}'>&lt;/div>
                                &lt;div data-column='active' class='menu_users_list_col list_sort_click list_title common_icon ${props.function_get_order_by('active')}'>&lt;/div>
                                &lt;div data-column='user_level' class='menu_users_list_col list_sort_click list_title ${props.function_get_order_by('user_level')}'>&lt;/div>
                                &lt;div data-column='private' class='menu_users_list_col list_sort_click list_title common_icon ${props.function_get_order_by('private')}'>&lt;/div>
                                &lt;div data-column='username' class='menu_users_list_col list_sort_click list_title common_icon ${props.function_get_order_by('username')}'>&lt;/div>
                                &lt;div data-column='bio' class='menu_users_list_col list_sort_click list_title common_icon ${props.function_get_order_by('bio')}'>&lt;/div>
                                &lt;div data-column='email' class='menu_users_list_col list_sort_click list_title common_icon ${props.function_get_order_by('email')}'>&lt;/div>
                                &lt;div data-column='emal_unverified' class='menu_users_list_col list_sort_click list_title common_icon ${props.function_get_order_by('email_unverified')}'>&lt;/div>
                                &lt;div data-column='password' class='menu_users_list_col list_sort_click list_title common_icon ${props.function_get_order_by('password')}'>&lt;/div>
                                &lt;div data-column='password_reminder' class='menu_users_list_col list_sort_click list_title common_icon ${props.function_get_order_by('password_reminder')}'>&lt;/div>
                                &lt;div data-column='verification_code' class='menu_users_list_col list_sort_click list_title common_icon ${props.function_get_order_by('verification_code')}'>&lt;/div>
                                &lt;div data-column='identity_provider_id' class='menu_users_list_col list_sort_click list_title common_icon ${props.function_get_order_by('provider_id')}'>&lt;/div>
                                &lt;div data-column='provider_name' class='menu_users_list_col list_sort_click list_title common_icon ${props.function_get_order_by('provider_name')}'>&lt;/div>
                                &lt;div data-column='provider_id' class='menu_users_list_col list_sort_click list_title common_icon ${props.function_get_order_by('provider_id')}'>&lt;/div>
                                &lt;div data-column='provider_first_name' class='menu_users_list_col list_sort_click list_title common_icon ${props.function_get_order_by('provider_name')}'>&lt;/div>
                                &lt;div data-column='provider_last_name' class='menu_users_list_col list_sort_click list_title common_icon ${props.function_get_order_by('provider_last_name')}'>&lt;/div>
                                &lt;div data-column='provider_image' class='menu_users_list_col list_title common_icon ${props.function_get_order_by('provider_image')}'>&lt;/div>
                                &lt;div data-column='provider_image_url' class='menu_users_list_col list_sort_click list_title common_icon ${props.function_get_order_by('provider_image_url')}'>&lt;/div>
                                &lt;div data-column='provider_email' class='menu_users_list_col list_sort_click list_title common_icon ${props.function_get_order_by('provider_email')}'>&lt;/div>
                                &lt;div data-column='date_created' class='menu_users_list_col list_sort_click list_title common_icon ${props.function_get_order_by('date_created')}'>&lt;/div>
                                &lt;div data-column='date_modified' class='menu_apps_col list_sort_click list_title common_icon ${props.function_get_order_by('date_modified')}'>&lt;/div>
                            &lt;/div>
                            ${props.users.map(user=>
                                `&lt;div data-changed-record='0' data-user_account_id='${user.id}' class='menu_users_list_row ${user.id==props.user_account_id?'list_current_user_row':''} common_row' >
                                    &lt;div data-column='avatar' class='menu_users_list_col list_readonly common_image common_image_avatar_list' style='${user.avatar==null?'':`background-image:url(${user.avatar});`}'>&lt;/div>
                                    &lt;div data-column='id' class='menu_users_list_col list_readonly'>${user.id}&lt;/div>
                                    &lt;div data-column='active' class='menu_users_list_col common_input list_edit' contentEditable='true'>${user.active ?? ''}&lt;/div>
                                    &lt;div data-column='user_level' class='menu_users_list_col common_input list_edit' contentEditable='true'>${user.user_level ?? ''}&lt;/div>
                                    &lt;div data-column='private' class='menu_users_list_col common_input list_edit' contentEditable='true'>${user.private ?? ''}&lt;/div>
                                    &lt;div data-column='username' class='menu_users_list_col common_input list_edit' contentEditable='true'>${user.username ?? ''}&lt;/div>
                                    &lt;div data-column='bio' class='menu_users_list_col common_input list_edit' contentEditable='true'>${user.bio ?? ''}&lt;/div>
                                    &lt;div data-column='email' class='menu_users_list_col common_input list_edit' contentEditable='true'>${user.email ?? ''}&lt;/div>
                                    &lt;div data-column='email_unverified' class='menu_users_list_col common_input list_edit' contentEditable='true'>${user.email_unverified ?? ''}&lt;/div>
                                    &lt;div data-column='password' class='menu_users_list_col common_input list_edit common_input_password' contentEditable='true' placeholder='******'>&lt;/div>
                                    &lt;div data-column='password_reminder' class='menu_users_list_col common_input list_edit' contentEditable='true'>${user.password_reminder ?? ''}&lt;/div>
                                    &lt;div data-column='verification_code' class='menu_users_list_col common_input list_edit' contentEditable='true'>${user.verification_code ?? ''}&lt;/div>
                                    &lt;div data-column='identity_provider' class='menu_users_list_col common_input list_readonly' >${user.identity_provider ?? ''}&lt;/div>
                                    &lt;div data-column='provider_name' class='menu_users_list_col common_input list_readonly' >${user.provider_name ?? ''}&lt;/div>
                                    &lt;div data-column='provider_id' class='menu_users_list_col common_input list_readonly' >${user.provider_id ?? ''}&lt;/div>
                                    &lt;div data-column='provider_first_name' class='menu_users_list_col common_input list_readonly' >${user.provider_first_name ?? ''}&lt;/div>
                                    &lt;div data-column='provider_last_name' class='menu_users_list_col common_input list_readonly' >${user.provider_last_name ?? ''}&lt;/div>
                                    &lt;div data-column='provider_image' class='menu_users_list_col common_image common_image_avatar_list list_readonly' style='${user.provider_image==null?'':`background-image:url(${user.provider_image});`}'>&lt;/div>
                                    &lt;div data-column='provider_image_url' class='menu_users_list_col list_readonly'>${user.provider_image_url ?? ''}&lt;/div>
                                    &lt;div data-column='provider_email' class='menu_users_list_col list_readonly'>${user.provider_email ?? ''}&lt;/div>
                                    &lt;div data-column='date_created' class='menu_users_list_col list_readonly'>${user.date_created ?? ''}&lt;/div>
                                    &lt;div data-column='date_modified' class='menu_users_list_col list_readonly'>${user.date_modified ?? ''}&lt;/div>
                                &lt;/div>`
                            ).join('')
                            }`;
/**
 * @name component
 * @description Component
 * @function
 * @param {{ data:{      commonMountdiv:string,
 *                       user_account_id:number,
 *                       sort:string,
 *                       order_by:string},
 *           methods:{   COMMON_DOCUMENT:COMMON_DOCUMENT,
 *                       commonFFB:CommonModuleCommon['commonFFB']},
 *           lifecycle:  null}} props
 * @returns {Promise.&lt;{ lifecycle:CommonComponentLifecycle, 
 *                      data:null, 
 *                      methods:null,
 *                      template:string}>}
 */
const component = async props => {
  
    /**
     * Get order by if column matches
     * @param {string} column
     */
    const get_order_by = column =>column==props.data.sort?props.data.order_by:'';

    let search_user='*';
    //show all records if no search criteria
    if (props.methods.COMMON_DOCUMENT.querySelector('#menu_users_list_search_input').textContent!='')
        search_user = encodeURI(props.methods.COMMON_DOCUMENT.querySelector('#menu_users_list_search_input').textContent);
    const users = await props.methods.commonFFB({path:'/server-db_admin/user_account', query:`search=${search_user}&amp;sort=${props.data.sort}&amp;order_by=${props.data.order_by}`, method:'GET', authorization_type:'ADMIN'})
                            .then((/**@type{string}*/result)=>JSON.parse(result).rows);

    const onMounted = async () =>{
        if (props.methods.COMMON_DOCUMENT.querySelectorAll('#menu_users_list .list_edit')[0])
            //set focus first column in first row
            //this will trigger to show detail records
            props.methods.COMMON_DOCUMENT.querySelectorAll('#menu_users_list .list_edit')[0].dispatchEvent(new Event('focus'));

  };
  return {
      lifecycle:    {onMounted:onMounted},
      data:         null,
      methods:      null,
      template:     template({  user_account_id:props.data.user_account_id,
                                users:users,
                                function_get_order_by:get_order_by
      })
  };
};
export default component;</code></pre>
        </div>
    </div>



