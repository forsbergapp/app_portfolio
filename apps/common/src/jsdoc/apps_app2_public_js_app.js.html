<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: apps/app2/public/js/app.js</title>
    <base href='/info/jsdoc/'/>
    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>

    <link media="all" href="/common/css/common.css" rel="stylesheet">
    <link media="all" href="/common/css/font/font1.css" rel="stylesheet">
    <link media="all" href="/common/css/font/font2.css" rel="stylesheet">
    <link media="all" href="/common/css/font/font3.css" rel="stylesheet">
    <link media="all" href="/common/css/font/font4.css" rel="stylesheet">
    <link media="all" href="/common/css/font/font5.css" rel="stylesheet">
    <link media="all" href="/common/css/font/font6.css" rel="stylesheet">
    <link media="all" href="/common/css/font/font7.css" rel="stylesheet">

    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">

</head>

<body>

<div id="main">

    <h1 class="page-title">Source: apps/app2/public/js/app.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Timetable app
 * @module apps/app2/app
 */

/**@type{import('../../../common_types.js').COMMON_DOCUMENT} */
const COMMON_DOCUMENT = document;

const path_common ='common';
/**@type {import('../../../common_types.js').CommonModuleCommon} */
const common = await import(path_common);

const path_regional ='regional';
/**@type {import('../../../common_types.js').CommonModuleRegional} */
const {getTimezone} = await import(path_regional);

const path_lib_timetable = '/app-module/MODULE_LIB_TIMETABLE';
/**@type {import('./types.js').CommonModuleLibTimetable} */
const {REPORT_GLOBAL, component} = await import(path_lib_timetable);


/**@type{import('./types.js').APP_user_setting} */
const user_settings_empty = {current_id:0,
                             data:[{id:0,
                                    json_data: {description: '',
                                                regional_language_locale: '',
                                                regional_timezone: '',
                                                regional_number_system: '',
                                                regional_layout_direction: '',
                                                regional_second_language_locale: '',
                                                regional_arabic_script: '',
                                                regional_calendar_type: '',
                                                regional_calendar_hijri_type: '',
                                                gps_popular_place_id: null,
                                                gps_lat_text: null,
                                                gps_long_text: null,
                
                                                design_theme_day_id: '',
                                                design_theme_month_id: '',
                                                design_theme_year_id: '',
                                                design_paper_size: '',
                                                design_row_highlight: '0',
                                                design_column_weekday_checked: 0,
                                                design_column_calendartype_checked: 0,
                                                design_column_notes_checked: 0,
                                                design_column_gps_checked: 0,
                                                design_column_timezone_checked: 0,
                
                                                image_header_image_img: '',
                                                image_footer_image_img: '',
                
                                                text_header_1_text: '',
                                                text_header_2_text: '',
                                                text_header_3_text: '',
                                                text_header_align: null,
                                                text_footer_1_text: '',
                                                text_footer_2_text: '',
                                                text_footer_3_text: '',
                                                text_footer_align: null,
                
                                                prayer_method: '',
                                                prayer_asr_method: '',
                                                prayer_high_latitude_adjustment: '',
                                                prayer_time_format: '',
                                                prayer_hijri_date_adjustment: 0,
                                                prayer_fajr_iqamat: '',
                                                prayer_dhuhr_iqamat: '',
                                                prayer_asr_iqamat: '',
                                                prayer_maghrib_iqamat: '',
                                                prayer_isha_iqamat: '',
                                                prayer_column_imsak_checked: 0,
                                                prayer_column_sunset_checked: 0,
                                                prayer_column_midnight_checked: 0,
                                                prayer_column_fast_start_end: 0}}
                                ]
                            };

/**@type{import('./types.js').APP_GLOBAL} */
const APP_GLOBAL = {
    app_default_startup_page:0,
    app_report_timetable:'',

    regional_default_direction:'',
    regional_default_locale_second:'',
    regional_default_arabic_script:'',
    regional_default_calendartype:'',
    regional_default_calendar_hijri_type:'',

    gps_default_place_id:0,
    gps_module_leaflet_qibbla_title:'',
    gps_module_leaflet_qibbla_text_size:0,
    gps_module_leaflet_qibbla_lat:0,
    gps_module_leaflet_qibbla_long:0,
    gps_module_leaflet_qibbla_color:'',
    gps_module_leaflet_qibbla_width:0,
    gps_module_leaflet_qibbla_opacity:0,
    gps_module_leaflet_qibbla_old_title:'',
    gps_module_leaflet_qibbla_old_text_size:0,
    gps_module_leaflet_qibbla_old_lat:0,
    gps_module_leaflet_qibbla_old_long:0,
    gps_module_leaflet_qibbla_old_color:'',
    gps_module_leaflet_qibbla_old_width:0,
    gps_module_leaflet_qibbla_old_opacity:0,

    design_default_theme_day:'',
    design_default_theme_month:'',
    design_default_theme_year:'',
    design_default_papersize:'',
    design_default_highlight_row:'0',
    design_default_show_weekday:false,
    design_default_show_calendartype:false,
    design_default_show_notes:false,
    design_default_show_gps:false,
    design_default_show_timezone:false,

    image_default_report_header_src:'',
    image_default_report_footer_src:'',
    image_header_footer_width:0,
    image_header_footer_height:0,

    text_default_reporttitle1:'',
    text_default_reporttitle2:'',
    text_default_reporttitle3:'',
    text_default_reportfooter1:'',
    text_default_reportfooter2:'',
    text_default_reportfooter3:'',

    prayer_default_method:'',
    prayer_default_asr:'',
    prayer_default_highlatitude:'',
    prayer_default_timeformat:'',
    prayer_default_hijri_adjustment:0,
    prayer_default_iqamat_title_fajr:'',
    prayer_default_iqamat_title_dhuhr:'',
    prayer_default_iqamat_title_asr:'',
    prayer_default_iqamat_title_maghrib:'',
    prayer_default_iqamat_title_isha:'',
    prayer_default_show_imsak:false,
    prayer_default_show_sunset:false,
    prayer_default_show_midnight:false,
    prayer_default_show_fast_start_end:0,

    //session variables
    timetable_type:0,
    places:null,
    user_settings:user_settings_empty,
    themes: {data:[{type:'', value:'', text:''}]},
    //profile_info functions
    function_profile_user_setting_update: ()=>null,
    function_profile_show_user_setting_detail: ()=>null,
    function_profile_user_setting_stat: ()=>null
    };
Object.seal(APP_GLOBAL);
/**
 * Print timetable
 * @returns {Promise.&lt;void>}
 */
const printTimetable = async () => {
    //use app component to get HTML
    const component_print = '/component/print.js';
    const {default:component} = await import(component_print);
    /**@type{import('../../../common_types.js').CommonComponentResult}*/
    const {template} = await component({ data:  {   
                                                commonMountdiv:null, 
                                                html:COMMON_DOCUMENT.querySelector('#paper').outerHTML
                                                },
                                        methods:{COMMON_DOCUMENT:COMMON_DOCUMENT}});
    await common.commonComponentRender({  mountDiv:   'common_window_info',
                                    data:       {
                                                info:3,
                                                url:null, 
                                                content_type:null, 
                                                frame:common.commonWindowDocumentFrame, 
                                                iframe_content:template
                                                },
                                    methods:    {commonWindowSetTimeout:common.commonWindowSetTimeout},
                                    path:       '/common/component/common_window_info.js'});
    
};
/**
 * Get report settings
 * @returns {import('./types.js').APP_REPORT_settings}
 */
const getReportSettings = () => {
    const setting_global = APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data;
    const place = APP_GLOBAL.places?APP_GLOBAL.places.filter(place=>place.id==setting_global.gps_popular_place_id)[0]:null;
    return {    locale              	: setting_global.regional_language_locale,
                timezone            	: setting_global.regional_timezone,
                number_system       	: setting_global.regional_number_system,
                direction           	: setting_global.regional_layout_direction,
                second_locale       	: setting_global.regional_second_language_locale,
                arabic_script       	: setting_global.regional_arabic_script,
                calendartype        	: setting_global.regional_calendar_type,
                calendar_hijri_type 	: setting_global.regional_calendar_hijri_type,

                place               	: place?place.text:setting_global.description,
                gps_lat             	: setting_global.gps_lat_text,
                gps_long            	: setting_global.gps_long_text,

                theme_day           	: 'theme_day_' + setting_global.design_theme_day_id,
                theme_month         	: 'theme_month_' + setting_global.design_theme_month_id,
                theme_year          	: 'theme_year_' + setting_global.design_theme_year_id,    
                //papersize missing
                highlight           	: setting_global.design_row_highlight,
                show_weekday        	: setting_global.design_column_weekday_checked,
                show_calendartype   	: setting_global.design_column_calendartype_checked,
                show_notes          	: setting_global.design_column_notes_checked,
                show_gps   	       		: setting_global.design_column_gps_checked,
                show_timezone       	: setting_global.design_column_timezone_checked,
                
                header_img_src      	: setting_global.image_header_image_img,
				footer_img_src      	: setting_global.image_footer_image_img,

                header_txt1         	: setting_global.text_header_1_text,
                header_txt2         	: setting_global.text_header_2_text,
                header_txt3         	: setting_global.text_header_3_text,
                header_align            : setting_global.text_header_align,
                footer_txt1         	: setting_global.text_footer_1_text,
                footer_txt2         	: setting_global.text_footer_2_text,
                footer_txt3    	   		: setting_global.text_footer_3_text,
                footer_align            : setting_global.text_footer_align,
                
                method              	: setting_global.prayer_method,
                asr                 	: setting_global.prayer_asr_method,
                highlat             	: setting_global.prayer_high_latitude_adjustment,
                format              	: setting_global.prayer_time_format,
                hijri_adj           	: setting_global.prayer_hijri_date_adjustment,
                iqamat_fajr         	: setting_global.prayer_fajr_iqamat,
                iqamat_dhuhr        	: setting_global.prayer_dhuhr_iqamat,
                iqamat_asr          	: setting_global.prayer_asr_iqamat,
                iqamat_maghrib      	: setting_global.prayer_maghrib_iqamat,
                iqamat_isha         	: setting_global.prayer_isha_iqamat,
                show_imsak          	: setting_global.prayer_column_imsak_checked,
                show_sunset         	: setting_global.prayer_column_sunset_checked,
                show_midnight       	: setting_global.prayer_column_midnight_checked,
                show_fast_start_end 	: setting_global.prayer_column_fast_start_end,
                
                timetable_class			: 'timetable_class',
                timetable_month         : 'timetable_month_class', //class to add for month
                timetable_year_month    : 'timetable_year_month', //class to add for year
                reporttype_year_month 	: 'MONTH',  //default MONTH: normal month with more info, 
                                                    //YEAR: month with less info
                
                ui_navigation_left      : 'toolbar_btn_left',
                ui_navigation_right     : 'toolbar_btn_right'};
};
/**
 * Timetable update
 * @param {number} timetable_type 
 * @param {'toolbar_btn_left' | 'toolbar_btn_right' | null} item_id 
 * @param {import('./types.js').APP_REPORT_settings} settings 
 * @returns {Promise.&lt;void>}
 */
const update_timetable_report = async (timetable_type = 0, item_id = null, settings) => {
    APP_GLOBAL.timetable_type = timetable_type;
    switch (timetable_type){
        //create timetable month or day or year if they are visible instead
        case 0:{
            /**@type{import('./types.js').APP_REPORT_day_user_account_app_data_posts[]} */
            const current_user_settings =[];
            for (const setting of APP_GLOBAL.user_settings.data){
                current_user_settings.push(
                {
                description : setting.json_data.description,
                regional_language_locale : setting.json_data.regional_language_locale,
                regional_timezone : setting.json_data.regional_timezone,
                regional_number_system : setting.json_data.regional_number_system,
                regional_calendar_hijri_type : setting.json_data.regional_calendar_hijri_type,
                gps_lat_text : setting.json_data.gps_lat_text,
                gps_long_text : setting.json_data.gps_long_text,
                prayer_method : setting.json_data.prayer_method,
                prayer_asr_method : setting.json_data.prayer_asr_method,
                prayer_high_latitude_adjustment : setting.json_data.prayer_high_latitude_adjustment,
                prayer_time_format : setting.json_data.prayer_time_format,
                prayer_hijri_date_adjustment : setting.json_data.prayer_hijri_date_adjustment
                });
            }
            COMMON_DOCUMENT.querySelector('#paper').innerHTML = component({	data:		{
                                                                                        commonMountdiv:null,
                                                                                        button_id:item_id,
                                                                                        timetable:'DAY',
                                                                                        user_account_app_data_post:settings,
                                                                                        user_account_app_data_posts_parameters:current_user_settings
                                                                                        },
                                                                            methods:	{
                                                                                        COMMON_DOCUMENT:null
                                                                                        }
                                                                            }).template;
            break;
        }
        //1=create timetable month
        case 1:{
            COMMON_DOCUMENT.querySelector('#paper').innerHTML = component({	data:		{
                                                                                        commonMountdiv:null,
                                                                                        button_id:item_id,
                                                                                        timetable:'MONTH',
                                                                                        user_account_app_data_post:settings,
                                                                                        user_account_app_data_posts_parameters:null
                                                                                        },
                                                                            methods:	{
                                                                                        COMMON_DOCUMENT:null
                                                                                        }
                                                                            }).template;
            break;
        }
        //2=create timetable year
        case 2:{
            COMMON_DOCUMENT.querySelector('#paper').innerHTML = component({	data:		{
                                                                                        commonMountdiv:null,
                                                                                        button_id:item_id,
                                                                                        timetable:'YEAR',
                                                                                        user_account_app_data_post:settings,
                                                                                        user_account_app_data_posts_parameters:null
                                                                                        },
                                                                            methods:	{
                                                                                        COMMON_DOCUMENT:null
                                                                                        }
                                                                            }).template;
            break;
        }
        default:{
            break;
        }
    }
};
/**
 * Get report url
 * @param {number|null} id 
 * @param {number} sid 
 * @param {string} papersize 
 * @param {string} item 
 * @param {string} format 
 * @param {boolean} profile_display 
 * @returns {string}
 */
const get_report_url = (id, sid, papersize, item, format, profile_display=true) => {
    const report_module = `module=${APP_GLOBAL.app_report_timetable}`;
    let module_parameters = `&amp;id=${id}&amp;sid=${sid}`;
    if (item =='profile_user_settings_day' || item.substr(0,8)=='user_day')
        module_parameters += '&amp;type=0';
    if (item =='profile_user_settings_month' || item.substr(0,10)=='user_month')
        module_parameters += '&amp;type=1';
    if (item == 'profile_user_settings_year' || item.substr(0,9)=='user_year')
        module_parameters += '&amp;type=2';
    if (profile_display){
        //send viewing user account id if logged in or set empty
        const uid_view = common.COMMON_GLOBAL.user_account_id==null?'':common.COMMON_GLOBAL.user_account_id;
        module_parameters += `&amp;uid_view=${uid_view}`;
    }
    const language_parameter = `&amp;lang_code=${common.COMMON_GLOBAL.user_locale}`;
    const service_parameter = `&amp;format=${format}&amp;ps=${papersize}&amp;hf=0`; //html, papersize, header/footer
    const encodedurl = common.commonWindowToBase64( report_module +
                                        module_parameters + 
                                        language_parameter +
                                        service_parameter);
    //url query parameters are decoded in report module and in report service
    return common.commonWindowHostname() + `/app-reports?reportid=${encodedurl}`;
};

/**
 * Update thumbnails with timetables
 * @param {{type:'day'|'month'|'year'|null,
 *          theme_id:string}|null} theme
 * @returns {Promise.&lt;void>}
 */
const update_all_theme_thumbnails = async (theme=null) => {
    if (theme?.type =='day' || theme==null){
        const current_user_settings = APP_GLOBAL.user_settings.data.map(setting=>{
            return {
                description : setting.json_data.description,
                regional_language_locale : setting.json_data.regional_language_locale,
                regional_timezone : setting.json_data.regional_timezone,
                regional_number_system : setting.json_data.regional_number_system,
                regional_calendar_hijri_type : setting.json_data.regional_calendar_hijri_type,
                gps_lat_text : setting.json_data.gps_lat_text,
                gps_long_text : setting.json_data.gps_long_text,
                prayer_method : setting.json_data.prayer_method,
                prayer_asr_method : setting.json_data.prayer_asr_method,
                prayer_high_latitude_adjustment : setting.json_data.prayer_high_latitude_adjustment,
                prayer_time_format : setting.json_data.prayer_time_format,
                prayer_hijri_date_adjustment : setting.json_data.prayer_hijri_date_adjustment
            };
        });
        
        const result = component({	data:		{
                                                commonMountdiv:null,
                                                button_id:null,
                                                timetable:'DAY',
                                                user_account_app_data_post:getReportSettings(),
                                                user_account_app_data_posts_parameters:current_user_settings
                                                },
                                    methods:	{
                                                COMMON_DOCUMENT:null
                                                }
                                    });

        await common.commonComponentRender({
            mountDiv:   'setting_design_theme_day',
            data:       { 
                        class:APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.design_paper_size,
                        theme_id:COMMON_DOCUMENT.querySelector('#setting_design_theme_day').getAttribute('data-theme_id'),
                        type:'day',
                        html:result.template
                        },
            methods:    null,
            path:       '/component/settings_tab3_theme_thumbnail.js'});
    }
    if (theme?.type =='month' || theme?.type=='year' || theme==null){
        const result_month = component({	data:		{
                                                        commonMountdiv:null,
                                                        button_id:null,
                                                        timetable:'MONTH',
                                                        user_account_app_data_post:getReportSettings(),
                                                        user_account_app_data_posts_parameters:null
                                                        },
                                            methods:	{
                                                        COMMON_DOCUMENT:null
                                                        }
                                            });
        const result_year = component({	data:		{
                                                    commonMountdiv:null,
                                                    button_id:null,
                                                    timetable:'YEAR',
                                                    user_account_app_data_post:getReportSettings(),
                                                    user_account_app_data_posts_parameters:null
                                                    },
                                        methods:	{
                                                    COMMON_DOCUMENT:null
                                                    }
                                        });
        await common.commonComponentRender({  mountDiv:   'setting_design_theme_month',
                                        data:       { 
                                                    class:APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.design_paper_size,
                                                    theme_id:COMMON_DOCUMENT.querySelector('#setting_design_theme_month').getAttribute('data-theme_id'),
                                                    type:'month',
                                                    html:result_month.template
                                                    },
                                        methods:    null,
                                        path:       '/component/settings_tab3_theme_thumbnail.js'});
        await common.commonComponentRender({  mountDiv:   'setting_design_theme_year',
                                        data:       { 
                                                    class:APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.design_paper_size,
                                                    theme_id:COMMON_DOCUMENT.querySelector('#setting_design_theme_year').getAttribute('data-theme_id'),
                                                    type:'year',
                                                    html:result_year.template
                                                    },
                                        methods:    null,
                                        path:       '/component/settings_tab3_theme_thumbnail.js'});
    }
};

/**
 * Get theme id
 * @param {string} type 
 * @returns {string}
 */
const get_theme_id = type => {
    if (COMMON_DOCUMENT.querySelector(`#setting_design_theme_${type}`))
        return COMMON_DOCUMENT.querySelector(`#setting_design_theme_${type}`).getAttribute('data-theme_id');
    else{
        /**@ts-ignore */
        return APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id]['design_theme_' + type + '_id'];
    }
        
};

/**
 * 
 * @param {number} nav 
 * @param {'day'|'month'|'year'} type 
 * @returns {Promise.&lt;void>}
 */
const theme_nav = async (nav, type) => {
    

    let theme_index_APP_GLOBAL = 0;

    //get current index
    const current_user_theme_id = APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data[`design_theme_${type}_id`];

    theme_index_APP_GLOBAL = APP_GLOBAL.themes.data.filter(theme=>theme.type.toLowerCase().endsWith(type)).findIndex( theme => theme.value == current_user_theme_id);

    //set next index
    if (nav == 1){
        if ((theme_index_APP_GLOBAL + 1) == APP_GLOBAL.themes.data.filter(theme=>theme.type.toLowerCase().endsWith(type)).length)
            theme_index_APP_GLOBAL = 0;
        else
            theme_index_APP_GLOBAL++;

    }
    else 
        if (nav == -1){
            if (theme_index_APP_GLOBAL == 0)
                theme_index_APP_GLOBAL = APP_GLOBAL.themes.data.filter(theme=>theme.type.toLowerCase().endsWith(type)).length-1;
            else
                theme_index_APP_GLOBAL--;

        }
    //set user setting theme id since getReportSetting will fetch user settings
    APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data[`design_theme_${type}_id`] = 
        APP_GLOBAL.themes.data.filter(theme=>theme.type.toLowerCase().endsWith(type))[theme_index_APP_GLOBAL].value;
    COMMON_DOCUMENT.querySelector(`#setting_design_theme_${type}`).setAttribute('data-theme_id', APP_GLOBAL.themes.data.filter(theme=>theme.type.toLowerCase().endsWith(type))[theme_index_APP_GLOBAL].value);
    COMMON_DOCUMENT.querySelector(`#setting_design_theme_${type}_id`).textContent = APP_GLOBAL.themes.data.filter(theme=>theme.type.toLowerCase().endsWith(type))[theme_index_APP_GLOBAL].value;
    await update_all_theme_thumbnails({   type: type,
                                    theme_id :APP_GLOBAL.themes.data.filter(theme=>theme.type.toLowerCase().endsWith(type))[theme_index_APP_GLOBAL].value});
};

/**
 * Get horizontal alignment
 * @param {boolean} al 
 * @param {boolean} ac 
 * @param {boolean} ar 
 * @returns {string|null }
 */
const get_align = (al,ac,ar) => {
	if (al==true)
		return 'left';
	if (ac==true)
		return 'center';
	if (ar==true)
		return 'right';
	return null;
};
/**
 * Show settings times for users timezone and timetable timezone
 * @returns {Promise.&lt;void>}
 */
const settingsTimesShow = async () => {
    const setting_select_locale                 = COMMON_DOCUMENT.querySelector('#setting_select_locale .common_select_dropdown_value')?.getAttribute('data-value');
    const element_setting_current_date          = COMMON_DOCUMENT.querySelector('#setting_current_date_time_display');
    const setting_select_report_timezone        = COMMON_DOCUMENT.querySelector('#setting_select_report_timezone .common_select_dropdown_value')?.getAttribute('data-value');
    const element_setting_report_data_time      = COMMON_DOCUMENT.querySelector('#setting_report_date_time_display');
    
    /**@type{Intl.DateTimeFormatOptions} */
    const options = {
        timeZone: common.COMMON_GLOBAL.user_timezone,
        weekday: 'long',
        year: 'numeric',
        month: 'long',
        day: 'numeric',
        hour: '2-digit',
        minute: '2-digit',
        second: '2-digit',
        timeZoneName: 'long'
    };
    if (element_setting_current_date){     
        element_setting_current_date.textContent = new Date().toLocaleTimeString(common.COMMON_GLOBAL.user_locale, options);    
        if (setting_select_report_timezone){
            options.timeZone = setting_select_report_timezone;
            element_setting_report_data_time.textContent = new Date().toLocaleTimeString(setting_select_locale, options);
        }
        //wait 1 second
        await common.commonWindowWait(1000);
        settingsTimesShow();
    }
    
};
/**
 * Toolbar button
 * @param {number} choice 
 * @returns {Promise.&lt;void>}
 */
const toolbar_button = async (choice) => {
    const paper = COMMON_DOCUMENT.querySelector('#paper');
    const settings = COMMON_DOCUMENT.querySelector('#settings');

    switch (choice) {
        //print
        case 1:
            {
                if (common.commonMobile())
                    paper.style.display = 'block';
                settings.style.visibility = 'hidden';
                printTimetable();
                break;
            }
        case 2:
        case 3:
        case 4:
            {
                if (common.commonMobile())
                    paper.style.display = 'block';
                settings.style.visibility = 'hidden';
                COMMON_DOCUMENT.querySelector('#toolbar_btn_day').classList.remove('toolbar_bottom_selected');
                COMMON_DOCUMENT.querySelector('#toolbar_btn_month').classList.remove('toolbar_bottom_selected');
                COMMON_DOCUMENT.querySelector('#toolbar_btn_year').classList.remove('toolbar_bottom_selected');
                COMMON_DOCUMENT.querySelector(`#toolbar_btn_${choice==2?'day':choice==3?'month':'year'}`).classList.add('toolbar_bottom_selected');

                //choice day=0, month=1, year=2
                await update_timetable_report(choice==2?0:choice==3?1:2, null, getReportSettings());
                break;
            }
        //settings
        case 5:
            {
                //Hide paper on mobile device when showing settings, scrollbug in background
                if (common.commonMobile())
                    paper.style.display = 'none';
                settings.style.visibility = 'visible';
                SettingShow(1);
                break;
            }
        //profile
        case 6:
            {
                settings.style.visibility = 'hidden';
                break;
            }
        //profile stat
        case 7:
            {
                settings.style.visibility = 'hidden';
                common.commonComponentRender({
                    mountDiv:   'common_profile_stat_row2',
                    data:       null,
                    methods:    null,
                    path:       '/component/profile_stat.js'});
                break;
            }
    }
};

/**
 * Show setting
 * @param {number} tab_selected 
 */
const SettingShow = async (tab_selected) => {
    //remove mark for all tabs
    COMMON_DOCUMENT.querySelectorAll('.settings_tab_nav').forEach((/**@type{HTMLElement}*/tab)=>tab.classList.remove('settings_tab_nav_selected'));
    //mark active tab
    COMMON_DOCUMENT.querySelector('#settings_tab_nav_' + tab_selected).classList.add('settings_tab_nav_selected');
    //empty old content
    COMMON_DOCUMENT.querySelector('#settings_content').textContent = '';
    //update with class to style each settings component
    COMMON_DOCUMENT.querySelector('#settings_content').className = `settings_tab_content settings_tab${tab_selected}`;
    //mount the selected component
    switch (tab_selected){
        case 1:{
            common.commonComponentRender({  
                mountDiv:   'settings_content',
                data:       {
                            user_settings:APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data,
                            common_app_id:common.COMMON_GLOBAL.common_app_id,
                            app_id:common.COMMON_GLOBAL.app_id,
                            user_locale:common.COMMON_GLOBAL.user_locale,
                            user_timezone:common.COMMON_GLOBAL.user_timezone},
                methods:    {
                            component_setting_update:component_setting_update,
                            commonDbAppSettingsGet:common.commonDbAppSettingsGet,
                            commonSelectCurrentValueSet:common.commonSelectCurrentValueSet,
                            commonComponentRender:common.commonComponentRender,
                            commonFFB:common.commonFFB
                            },
                path:       `/component/settings_tab${tab_selected}.js`});
            break;
        }
        case 2:{
            common.commonComponentRender({  
                mountDiv:   'settings_content',
                data:       {
                            app_id:common.COMMON_GLOBAL.app_id,
                            user_settings:APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data
                            },
                methods:    {
                            lib_timetable_REPORT_GLOBAL:REPORT_GLOBAL,
                            component_setting_update:component_setting_update,
                            getTimezone:getTimezone,
                            commonTimezoneDate:common.commonTimezoneDate,
                            commonModuleLeafletInit:common.commonModuleLeafletInit,
                            commonSelectCurrentValueSet:common.commonSelectCurrentValueSet,
                            commonComponentRender:common.commonComponentRender,
                            commonDbAppSettingsGet:common.commonDbAppSettingsGet
                            },
                path:       `/component/settings_tab${tab_selected}.js`});
            break;
        }
        case 3:{
            common.commonComponentRender({  
                mountDiv:   'settings_content',
                data:       {
                            app_id:common.COMMON_GLOBAL.app_id,
                            user_settings:APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data,
                            themes:APP_GLOBAL.themes},
                methods:    {
                            update_all_theme_thumbnails:update_all_theme_thumbnails,
                            commonSelectCurrentValueSet:common.commonSelectCurrentValueSet,
                            commonComponentRender:common.commonComponentRender,
                            commonDbAppSettingsGet:common.commonDbAppSettingsGet
                            },
                path:       `/component/settings_tab${tab_selected}.js`});
            break;
        }
        case 4:{
            common.commonComponentRender({  
                mountDiv:   'settings_content',
                data:       {
                            app_id:common.COMMON_GLOBAL.app_id,
                            user_settings:APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data
                            },
                methods:    null,
                path:       `/component/settings_tab${tab_selected}.js`});
            break;
        }
        case 5:{
            common.commonComponentRender({  
                mountDiv:   'settings_content',
                data:       {
                            app_id:common.COMMON_GLOBAL.app_id,
                            user_settings:APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data
                            },
                methods:    {component_setting_update:component_setting_update},
                path:`/component/settings_tab${tab_selected}.js`});
            break;
        }
        case 6:{
            common.commonComponentRender({  
                mountDiv:   'settings_content',
                data:       {
                            app_id:common.COMMON_GLOBAL.app_id,
                            user_settings:APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data,
                            methods:REPORT_GLOBAL.CommonModulePrayTimes_methods
                            },
                methods:    {
                            component_setting_update:component_setting_update,
                            commonSelectCurrentValueSet:common.commonSelectCurrentValueSet,
                            commonComponentRender:common.commonComponentRender,
                            commonDbAppSettingsGet:common.commonDbAppSettingsGet
                            },
                path:`/component/settings_tab${tab_selected}.js`});
            break;
        }
        case 7:{
            common.commonComponentRender({
                mountDiv:   'settings_content',
                data:       {user_settings:APP_GLOBAL.user_settings},
                methods:    {commonComponentRender:common.commonComponentRender},
                path:       `/component/settings_tab${tab_selected}.js`});
            break;
        }
    }
    
};
/**
 * Get alignment for button
 * @param {string} report_align_where 
 * @returns {string}
 */
const align_button_value = (report_align_where) => {

    if (COMMON_DOCUMENT.querySelector('#setting_icon_text_' + report_align_where + '_aleft').classList.contains('setting_button_active'))
        return 'left';
    if (COMMON_DOCUMENT.querySelector('#setting_icon_text_' + report_align_where + '_acenter').classList.contains('setting_button_active'))
        return 'center';
    if (COMMON_DOCUMENT.querySelector('#setting_icon_text_' + report_align_where + '_aright').classList.contains('setting_button_active'))
        return 'right';
    return '';
};
/**
 * Zoom paper
 * @param {number|null} zoomvalue 
 * @returns {void}
 */
const zoom_paper = (zoomvalue = null) => {
    let old;
    let old_scale;
    const div = COMMON_DOCUMENT.querySelector('#paper');
    //called with null as argument at init() then used for zooming
    //even if css set, this property is not set at startup
    if (zoomvalue == null) {
        if (common.commonMobile())
            div.style.transform = 'scale(0.5)';
        else
            div.style.transform = 'scale(0.7)';
    } else {
        old = COMMON_DOCUMENT.querySelector('#paper').style.transform;
        old_scale = parseFloat(old.substr(old.indexOf('(') + 1, old.indexOf(')') - 1));
        div.style.transform = 'scale(' + (old_scale + (zoomvalue / 10)) + ')';
    }
};

/**
 * Show dialogue
 * @param {*} dialogue 
 * @returns {void}
 */
const show_dialogue = (dialogue) => {
    if (dialogue == 'SCAN' &amp;&amp; common.commonMobile()==false){
        common.commonComponentRender({mountDiv:   'dialogue_scan_open_mobile',
                                data:       null,
                                methods:    {
                                            commonModuleEasyQRCODECreate:common.commonModuleEasyQRCODECreate,
                                            commonWindowHostname:common.commonWindowHostname
                                            },
                                path:       '/component/dialogue_scan_open_mobile.js'});
    }
};
/**
 * Update ui
 * @param {'REGIONAL'|'GPS'|'DESIGN'|'IMAGE'|'TEXT'|'PRAYER'|'USER'} setting_tab
 * @param {string} setting_type
 * @param {string|null} item_id 
 * @returns {Promise.&lt;void>}
 */
const component_setting_update = async (setting_tab, setting_type, item_id=null) => {
    switch (setting_tab + '_' + setting_type) {
        case 'REGIONAL_TIMEZONE':
            {
                settingsTimesShow();
                break;
            }
        case 'GPS_MAP':
            {
                const gps_lat_input = COMMON_DOCUMENT.querySelector('#setting_input_lat');
                const gps_long_input = COMMON_DOCUMENT.querySelector('#setting_input_long');
                map_update_app({longitude:gps_long_input.textContent,
                                latitude:gps_lat_input.textContent,
                                text_place:COMMON_DOCUMENT.querySelector('#setting_input_place').textContent,
                                country:'',
                                city:'',
                                timezone_text :null
                            });
                break;
            }
        case 'GPS_CITY':
            {                    
                //read from Leaflet module and custom code
                //read from latest popup
                const popup = COMMON_DOCUMENT.querySelectorAll('.common_module_leaflet_popup_sub_title_gps')[COMMON_DOCUMENT.querySelectorAll('.common_module_leaflet_popup_sub_title_gps').length - 1 ];
                const country = popup.getAttribute('data-country');
                const city = popup.getAttribute('data-city');
                const timezone = popup.getAttribute('data-timezone');
                const latitude = popup.getAttribute('data-latitude');
                const longitude = popup.getAttribute('data-longitude');
                
                //update value in app
                
                
                const gps_lat_input = COMMON_DOCUMENT.querySelector('#setting_input_lat');
                const gps_long_input = COMMON_DOCUMENT.querySelector('#setting_input_long');
                gps_long_input.textContent = longitude;
                gps_lat_input.textContent = latitude;

                if (city=='' &amp;&amp; country==''){
                    //Set place from city + country from popup title
                    COMMON_DOCUMENT.querySelector('#setting_input_place').textContent = 
                        COMMON_DOCUMENT.querySelectorAll('.common_module_leaflet_popup_title')[COMMON_DOCUMENT.querySelectorAll('.common_module_leaflet_popup_title').length - 1 ].textContent;
                }
                else{
                    //Set place from city + country from data attributes
                    COMMON_DOCUMENT.querySelector('#setting_input_place').textContent = city + ', ' + country;
                }
                //display empty popular place select
                common.commonSelectCurrentValueSet('setting_select_popular_place', null, 'id', null);
                map_show_qibbla();
                APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.regional_timezone = timezone;
                REPORT_GLOBAL.session_currentDate = common.commonTimezoneDate(timezone);
                settings_update('GPS');    
                break;
            }
        case 'GPS_POPULAR_PLACES':
            {
                
                const select_place = JSON.parse(COMMON_DOCUMENT.querySelector('#setting_select_popular_place .common_select_dropdown_value').getAttribute('data-value'));
                const gps_lat_input = COMMON_DOCUMENT.querySelector('#setting_input_lat');
                const gps_long_input = COMMON_DOCUMENT.querySelector('#setting_input_long');
                
                //set GPS and timezone
                const longitude_selected = select_place.longitude;
                const latitude_selected = select_place.latitude;
                const timezone_selected = select_place.timezone;

                gps_long_input.textContent = longitude_selected;
                gps_lat_input.textContent = latitude_selected;

                    //Update map
                    map_update_app({longitude:      longitude_selected,
                                    latitude:       latitude_selected,
                                    text_place:     COMMON_DOCUMENT.querySelector('#setting_select_popular_place .common_select_dropdown_value').textContent,
                                    country:        '',
                                    city:           '',
                                    timezone_text : timezone_selected
                                });
                    
                    common.COMMON_GLOBAL.moduleLeaflet.methods.map_toolbar_reset();
                APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.regional_timezone = timezone_selected;
                const title = COMMON_DOCUMENT.querySelector('#setting_select_popular_place .common_select_dropdown_value').textContent;
                COMMON_DOCUMENT.querySelector('#setting_input_place').textContent = title;
                settings_update('GPS');
                break;
            }
        case 'GPS_POSITION':
            {
                
                const gps_lat_input = COMMON_DOCUMENT.querySelector('#setting_input_lat');
                const gps_long_input = COMMON_DOCUMENT.querySelector('#setting_input_long');
                
                common.commonSelectCurrentValueSet('setting_select_popular_place', null, 'id', null);

                common.commonMicroserviceGeolocationPlace(gps_long_input.textContent, gps_lat_input.textContent).then((/**@type{string}*/gps_place) => {
                    //Update map
                    COMMON_DOCUMENT.querySelector('#setting_input_place').textContent = gps_place;
                    map_update_app({longitude:gps_long_input.textContent,
                                    latitude:gps_lat_input.textContent,
                                    text_place:gps_place,
                                    country:'',
                                    city:'',
                                    timezone_text :null})
                    .then((timezone_text) => {
                        APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.regional_timezone = timezone_text ?? '';
                    });
                    common.COMMON_GLOBAL.moduleLeaflet.methods.map_toolbar_reset();
                    settings_update('GPS');
                });
                break;
            }
        case 'DESIGN_PAPER':
            {
                const paper = COMMON_DOCUMENT.querySelector('#paper');
                const paper_size = COMMON_DOCUMENT.querySelector('#setting_select_report_papersize .common_select_dropdown_value').getAttribute('data-value');
                 
                switch (paper_size) {
                    case 'A4':
                        {
                            paper.className='A4';
                            break;
                        }
                    case 'Letter':
                        {
                            paper.className='Letter';
                            break;
                        }
                    default:
                        break;
                }
                break;
            }
        case 'IMAGE_HEADER_LOAD':
        case 'IMAGE_FOOTER_LOAD':
            {
                await common.commonImageShow( COMMON_DOCUMENT.querySelector(`#setting_report${setting_type=='HEADER_LOAD'?'header':'footer'}_img`), 
                                        item_id, 
                                        APP_GLOBAL.image_header_footer_width, 
                                        APP_GLOBAL.image_header_footer_height);
                break;
            }
        case 'IMAGE_HEADER_CLEAR':
        case 'IMAGE_FOOTER_CLEAR':
            {
                const preview_item  = COMMON_DOCUMENT.querySelector(`#setting_report${setting_type=='HEADER_CLEAR'?'header':'footer'}_img`);
                const preview_input = COMMON_DOCUMENT.querySelector(`#setting_input_report${setting_type=='HEADER_CLEAR'?'header':'footer'}_img`);
                preview_item.style.backgroundImage='url()';
                preview_input.value = '';
                break;
            }
        case 'TEXT_HEADER_ALIGN':
        case 'TEXT_FOOTER_ALIGN':
            {
                const button_active_class  = 'setting_button_active';
                const header_footer = setting_type=='HEADER_ALIGN'?'header':'footer';
                //check if clicking on button that is already active then deactivate so no alignment
                if (COMMON_DOCUMENT.querySelector('#' + item_id).classList.contains(button_active_class)){
                    COMMON_DOCUMENT.querySelector('#' + item_id).classList.remove(button_active_class);
                }
                else{
                    COMMON_DOCUMENT.querySelector(`#setting_icon_text_${header_footer}_aleft`).classList.remove(button_active_class);
                    COMMON_DOCUMENT.querySelector(`#setting_icon_text_${header_footer}_acenter`).classList.remove(button_active_class);
                    COMMON_DOCUMENT.querySelector(`#setting_icon_text_${header_footer}_aright`).classList.remove(button_active_class);
                    
                    COMMON_DOCUMENT.querySelector('#' + item_id).classList.add(button_active_class);
                }
                const align = get_align(COMMON_DOCUMENT.querySelector(`#setting_icon_text_${header_footer}_aleft`).classList.contains('setting_button_active'),
                                        COMMON_DOCUMENT.querySelector(`#setting_icon_text_${header_footer}_acenter`).classList.contains('setting_button_active'),
                                        COMMON_DOCUMENT.querySelector(`#setting_icon_text_${header_footer}_aright`).classList.contains('setting_button_active'));
                COMMON_DOCUMENT.querySelector(`#setting_input_report${header_footer}1`).style.textAlign= align;
                COMMON_DOCUMENT.querySelector(`#setting_input_report${header_footer}2`).style.textAlign= align;
                COMMON_DOCUMENT.querySelector(`#setting_input_report${header_footer}3`).style.textAlign= align;
                break;
            }
        case 'PRAYER_METHOD':
            {
                const method = COMMON_DOCUMENT.querySelector('#setting_select_method .common_select_dropdown_value').getAttribute('data-value');
                let suffix;

                COMMON_DOCUMENT.querySelector('#setting_method_param_fajr').textContent = '';
                COMMON_DOCUMENT.querySelector('#setting_method_param_isha').textContent = '';
                if (typeof REPORT_GLOBAL.CommonModulePrayTimes_methods[method].params.fajr == 'string')
                    suffix = '';
                else
                    suffix = '°';
                COMMON_DOCUMENT.querySelector('#setting_method_param_fajr').textContent = 'Fajr:' + REPORT_GLOBAL.CommonModulePrayTimes_methods[method].params.fajr + suffix;
                if (typeof REPORT_GLOBAL.CommonModulePrayTimes_methods[method].params.isha == 'string')
                    suffix = '';
                else
                    suffix = '°';
                COMMON_DOCUMENT.querySelector('#setting_method_param_isha').textContent = 'Isha:' + REPORT_GLOBAL.CommonModulePrayTimes_methods[method].params.isha + suffix;
                break;
            }
        case 'USER_SETTING':{
            APP_GLOBAL.user_settings.current_id = COMMON_DOCUMENT.querySelector('#setting_select_user_setting .common_select_dropdown_value').getAttribute('data-value');
        }
    }
};

/**
 * User login
 * @param {boolean} system_admin
 * @param {string|null} username_verify
 * @param {string|null} password_verify
 * @returns {Promise.&lt;void>}
 */
const user_login_app = async (system_admin=false, username_verify=null, password_verify=null) => {
    await common.commonUserLogin(system_admin, username_verify, password_verify)
    .then(result=>{
        //create intitial user setting if not exist, send initial=true
        login_common(result.avatar);
    })
    .catch(()=>null);
};

/**
 * User function
 * @param {'FOLLOW'|'LIKE'} function_name 
 * @returns {Promise.&lt;void>}
 */
const user_function_app = async (function_name) => {
    await common.commonUserFunction(function_name)
    .then(()=>commonProfileUpdateStat_app())
    .catch(()=>null);
};

/**
 * User logout
 * @returns {void}
 */
const user_logout_app = () => {
    
    common.commonUserLogout().then(() => {
        common.commonComponentRemove('settings_tab_nav_7');
        common.commonComponentRemove('common_dialogue_profile', true);
        //set default settings
        set_default_settings().then(() => {
            //show default startup
            toolbar_button(APP_GLOBAL.app_default_startup_page);
        });
    });    
};
/**
 * Login common
 * @param {string|null} avatar 
 */
const login_common = (avatar) => {
    //create intitial user setting if not exist, send initial=true
    user_settings_function('ADD_LOGIN', true)
    .then(()=>{
        common.commonComponentRender({
            mountDiv:   'settings_tab_nav_7',
            data:       {avatar:avatar},
            methods:    null,
            path:       '/component/settings_tab_nav_7.js'});

        //Hide settings
        COMMON_DOCUMENT.querySelector('#settings').style.visibility = 'hidden';
        common.commonComponentRemove('common_dialogue_profile');
        
        COMMON_DOCUMENT.querySelector('#paper').textContent='';
        user_settings_get().then(() => {
            //show default startup
            toolbar_button(APP_GLOBAL.app_default_startup_page);
        });
    });
};
/**
 * Provider signin
 * @param {*} provider_id 
 * @returns {Promise.&lt;void>}
 */
const ProviderSignIn_app = async (provider_id) => {
    common.commonUserLogin(null, null, null, provider_id)
    .then(result=>{
        login_common(result.avatar);
    })
    .catch(()=>null);
};
/**
 * Profile update stat
 * @returns {Promise.&lt;void>}
 */
const commonProfileUpdateStat_app = async () => {
    const result = await common.commonProfileUpdateStat();
    APP_GLOBAL.function_profile_user_setting_stat(result.id);
};
/**
 * Profile top
 * @param {number} statchoice 
 * @param {string|null} app_rest_url
 * @returns {Promise.&lt;void>}
 */
 const profile_stat_app = async (statchoice, app_rest_url) => {
    await common.commonProfileStat(statchoice, app_rest_url)
    .then(()=>{
        common.commonComponentRender({
            mountDiv:   'common_profile_stat_row2',
            data:      null,
            methods:    null,
            path:       '/component/profile_stat.js'});
    });
 };
/**
 * 
 * @param {number} detailchoice 
 * @returns {void}
 */
const profile_detail_app = (detailchoice) => {
    if (common.COMMON_GLOBAL.user_account_id || 0 !== 0) {
        if (detailchoice == 0){
            //user settings
            COMMON_DOCUMENT.querySelector('#profile_user_settings_row').style.display = 'block';
        }
        else{
            //common 1 -4
            //app
            //7 Like user setting
            //8 Liked user setting
            COMMON_DOCUMENT.querySelector('#profile_user_settings_row').style.display = 'none';
        }
        common.commonProfileDetail(detailchoice);
    } 
    else
        common.commonDialogueShow('LOGIN');
};
/**
 * User settings get
 * @returns {Promise.&lt;null>}
 */
const user_settings_get = async () => {
    return new Promise(resolve=>{
        common.commonFFB({path:`/server-db/user_account_app_data_post/${common.COMMON_GLOBAL.user_account_id??''}`, method:'GET', authorization_type:'APP_DATA'})
        .then((/**@type{string}*/result)=>{
            const settings = JSON.parse(result).map((/** @type{import('./types.js').APP_user_setting_record}*/setting)=>{
                const json_data = {description:setting.description,
                    regional_language_locale:setting.regional_language_locale,
                    regional_timezone:setting.regional_timezone,
                    regional_number_system:setting.regional_number_system,
                    regional_layout_direction:setting.regional_layout_direction,
                    regional_second_language_locale:setting.regional_second_language_locale,
                    regional_arabic_script:setting.regional_arabic_script,
                    regional_calendar_type:setting.regional_calendar_type,
                    regional_calendar_hijri_type:setting.regional_calendar_hijri_type,
                    gps_popular_place_id: setting.gps_popular_place_id,
                    gps_lat_text:typeof setting.gps_lat_text== 'string'?fixFloat(setting.gps_lat_text):setting.gps_lat_text,
                    gps_long_text:typeof setting.gps_long_text=='string'?fixFloat(setting.gps_long_text):setting.gps_long_text,
                    design_theme_day_id:setting.design_theme_day_id,
                    design_theme_month_id:setting.design_theme_month_id,
                    design_theme_year_id:setting.design_theme_year_id,
                    design_paper_size:setting.design_paper_size,
                    design_row_highlight:setting.design_row_highlight,
                    design_column_weekday_checked:Number(setting.design_column_weekday_checked),
                    design_column_calendartype_checked:Number(setting.design_column_calendartype_checked),
                    design_column_notes_checked:Number(setting.design_column_notes_checked),
                    design_column_gps_checked:Number(setting.design_column_gps_checked),
                    design_column_timezone_checked:Number(setting.design_column_timezone_checked),
                    image_header_image_img:setting.image_header_image_img,
                    image_footer_image_img:setting.image_footer_image_img,
                    text_header_1_text:setting.text_header_1_text,
                    text_header_2_text:setting.text_header_2_text,
                    text_header_3_text:setting.text_header_3_text,
                    text_header_align:setting.text_header_align==''?null:setting.text_header_align,
                    text_footer_1_text:setting.text_footer_1_text,
                    text_footer_2_text:setting.text_footer_2_text,
                    text_footer_3_text:setting.text_footer_3_text,
                    text_footer_align:setting.text_footer_align==''?null:setting.text_footer_align,
                    prayer_method:setting.prayer_method,
                    prayer_asr_method:setting.prayer_asr_method,
                    prayer_high_latitude_adjustment:setting.prayer_high_latitude_adjustment,
                    prayer_time_format:setting.prayer_time_format,
                    prayer_hijri_date_adjustment:Number(setting.prayer_hijri_date_adjustment),
                    prayer_fajr_iqamat:setting.prayer_fajr_iqamat,
                    prayer_dhuhr_iqamat:setting.prayer_dhuhr_iqamat,
                    prayer_asr_iqamat:setting.prayer_asr_iqamat,
                    prayer_maghrib_iqamat:setting.prayer_maghrib_iqamat,
                    prayer_isha_iqamat:setting.prayer_isha_iqamat,
                    prayer_column_imsak_checked:Number(setting.prayer_column_imsak_checked),
                    prayer_column_sunset_checked:Number(setting.prayer_column_sunset_checked),
                    prayer_column_midnight_checked:Number(setting.prayer_column_midnight_checked),
                    prayer_column_fast_start_end:Number(setting.prayer_column_fast_start_end) 
                };
                return {
                        id:setting.id,
                        json_data:json_data
                        };
            });
            APP_GLOBAL.user_settings = {current_id:0,   data:settings};
            resolve(null);
        });
    });
};
/**
 * User setting show link
 * @param {HTMLElement} item 
 * @returns {void}
 */
const user_setting_link = (item) => {
    const user_account_id = common.COMMON_GLOBAL.user_account_id;    
    const sid = APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].id;
    switch (item.id){
        case 'user_day_html':
        case 'user_month_html':
        case 'user_year_html':{
            const url = get_report_url( user_account_id, 
                                        sid ?? 0, 
                                        APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.design_paper_size,
                                        item.id,
                                        'HTML');
            common.commonComponentRender({
                    mountDiv:   'common_window_info',
                    data:       {
                                info:2,
                                url:null,
                                content_type:'HTML', 
                                iframe_content:url,
                                iframe_class:APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.design_paper_size
                                },
                    methods:    {commonWindowSetTimeout:common.commonWindowSetTimeout},
                    path:       '/common/component/common_window_info.js'});
            break;
        }
    }
};
/**
 * User settings function
 * @param {'ADD'|'ADD_LOGIN'|'SAVE'} function_name 
 * @param {boolean} initial_user_setting 
 * @param {boolean} add_settings
 * @returns {Promise.&lt;void>}
 */
const user_settings_function = async (function_name, initial_user_setting, add_settings=true) => {
   
    if (common.commonInputControl(null,{
                                    check_valid_list_values:[
                                                [APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.description,null],
                                                [APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.gps_lat_text?.toString()??'',null],
                                                [APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.gps_long_text?.toString()??'',null],
                                                [APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.text_header_1_text,null],
                                                [APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.text_header_2_text,null],
                                                [APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.text_header_3_text,null],
                                                [APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.text_footer_1_text,null],
                                                [APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.text_footer_2_text,null],
                                                [APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.text_footer_3_text,null]
                                                ]})==true){
        
        const json_data = { description:        APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.description,
                            json_data:          APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data,
                            user_account_id:    common.COMMON_GLOBAL.user_account_id
                        };
        /**@type {import('../../../common_types.js').CommonRESTAPIMethod}*/
        let method;
        let path = '';
        let query = null;
        let spinner_id;
        switch (function_name){
            case 'ADD_LOGIN':
            case 'ADD':{
                if (function_name=='ADD')
                    spinner_id = 'setting_btn_user_add';
                method = 'POST';
                path = '/server-db/user_account_app_data_post';
                query = `initial=${initial_user_setting==true?1:0}`;
                break;
            }
            case 'SAVE':{
                spinner_id = 'setting_btn_user_save';
                method = 'PUT';
                const user_setting_id = APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].id;
                path = `/server-db/user_account_app_data_post/${user_setting_id}`;
                break;
            }
        }
        await common.commonFFB({path:path, query:query, method:method, authorization_type:'APP_ACCESS', body:json_data, spinner_id:spinner_id?spinner_id:null})
        .then((/**@type{string}*/result)=>{
            switch (function_name){
                case 'ADD':{
                    if (add_settings==true){
                        //update user settings
                        /** @type{import('./types.js').APP_user_setting_data}*/
                        const data = {  id:         JSON.parse(result).id, 
                                        json_data:  JSON.parse(JSON.stringify(APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data))};
                        APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.data.length+0] = data;
                        APP_GLOBAL.user_settings.current_id = APP_GLOBAL.user_settings.data.length -1;
                    }
                    APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].id = JSON.parse(result).insertId;

                    //Update select
                    common.commonComponentRender({
                        mountDiv:   'setting_select_user_setting',
                        data:       {
                                    default_data_value:APP_GLOBAL.user_settings.current_id,
                                    default_value:APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.description,
                                    options: APP_GLOBAL.user_settings.data.map((setting, index)=>{return {value:index, text:setting.json_data.description};}),
                                    path:null,
                                    query:null,
                                    method:null,
                                    authorization_type:null,
                                    column_value:'value',
                                    column_text:'text'
                                    },
                        methods:    {commonFFB:null},
                        path:       '/common/component/common_select.js'});
                    break;
                }
                case 'ADD_LOGIN':{
                    APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].id = JSON.parse(result).id ?? JSON.parse(result).insertId;
                    break;
                }
                default:{
                    break;
                }
            }
        });
    }
};
/**
 * User settings delete
 * @param {number|null} choice 
 * @returns {void}
 */
const user_settings_delete = (choice=null) => {
    const user_setting_id = APP_GLOBAL.user_settings.data[COMMON_DOCUMENT.querySelector('#setting_select_user_setting .common_select_dropdown_value').getAttribute('data-value')].id;
    const function_delete_user_setting = () => { user_settings_delete(1); };
    
    switch (choice){
        case null:{
            common.commonMessageShow('CONFIRM',null,function_delete_user_setting, null, null, common.COMMON_GLOBAL.app_id);
            break;
        }
        case 1:{
            common.commonFFB({path:`/server-db/user_account_app_data_post/${user_setting_id}`, method:'DELETE', authorization_type:'APP_ACCESS', body:{user_account_id:common.COMMON_GLOBAL.user_account_id}, spinner_id:'setting_btn_user_delete'})
            .then(()=>{
                common.commonComponentRemove('common_dialogue_message', true);
                //check if last setting
                if (APP_GLOBAL.user_settings.data.length == 1)
                    user_settings_function('ADD', false, false);
                else{
                    //remove current element from array
                    APP_GLOBAL.user_settings.data.splice(COMMON_DOCUMENT.querySelector('#setting_select_user_setting .common_select_dropdown_value').getAttribute('data-value'),1);
                    //show next or last setting
                    APP_GLOBAL.user_settings.current_id = Math.min(COMMON_DOCUMENT.querySelector('#setting_select_user_setting .common_select_dropdown_value').getAttribute('data-value') +1, APP_GLOBAL.user_settings.data.length - 1);

                    //Update select
                    common.commonComponentRender({
                        mountDiv:   'setting_select_user_setting',
                        data:       {
                                    default_data_value:APP_GLOBAL.user_settings.current_id,
                                    /**@ts-ignore */
                                    default_value:APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.description,
                                    /**@ts-ignore */
                                    options: APP_GLOBAL.user_settings.data.map((setting, index)=>{return {value:index, text:setting.json_data.description};}),
                                    path:null,
                                    query:null,
                                    method:null,
                                    authorization_type:null,
                                    column_value:'value',
                                    column_text:'text'
                                    },
                        methods:    {commonFFB:null},
                        path:       '/common/component/common_select.js'});
                }
                
            })
            .catch(()=>common.commonComponentRemove('common_dialogue_message', true));
        }
    }
};
/**
 * Set default settings
 * @returns {Promise.&lt;void>}
 */
const set_default_settings = async () => {
    //update APP_GLOBAL
    const json_data = {
        description:                        common.COMMON_GLOBAL.client_place,
        regional_language_locale:           common.COMMON_GLOBAL.user_locale,
        regional_timezone:                  (common.COMMON_GLOBAL.client_latitude &amp;&amp; common.COMMON_GLOBAL.client_longitude)?
                                                getTimezone(common.COMMON_GLOBAL.client_latitude, common.COMMON_GLOBAL.client_longitude):
                                                    (APP_GLOBAL.places?APP_GLOBAL.places.filter((/**@type{*}*/place)=>place.value==APP_GLOBAL.gps_default_place_id)[0].data4:
                                                        Intl.DateTimeFormat().resolvedOptions().timeZone),
        regional_number_system:             Intl.NumberFormat().resolvedOptions().numberingSystem,
        regional_layout_direction:          APP_GLOBAL.regional_default_direction,
        regional_second_language_locale:    APP_GLOBAL.regional_default_locale_second,
        regional_arabic_script:             APP_GLOBAL.regional_default_arabic_script,
        regional_calendar_type:             APP_GLOBAL.regional_default_calendartype,
        regional_calendar_hijri_type:       APP_GLOBAL.regional_default_calendar_hijri_type,
        gps_popular_place_id:               (common.COMMON_GLOBAL.client_latitude &amp;&amp; common.COMMON_GLOBAL.client_longitude)?null:
                                                APP_GLOBAL.gps_default_place_id,
        gps_lat_text:                       (common.COMMON_GLOBAL.client_latitude &amp;&amp; common.COMMON_GLOBAL.client_longitude)?fixFloat(common.COMMON_GLOBAL.client_latitude):
                                                (APP_GLOBAL.places?fixFloat(APP_GLOBAL.places.filter((/**@type{*}*/place)=>place.value==APP_GLOBAL.gps_default_place_id)[0].data2):0),
        gps_long_text:                      (common.COMMON_GLOBAL.client_latitude &amp;&amp; common.COMMON_GLOBAL.client_longitude)?fixFloat(common.COMMON_GLOBAL.client_longitude):
                                                (APP_GLOBAL.places?fixFloat(APP_GLOBAL.places.filter((/**@type{*}*/place)=>place.value==APP_GLOBAL.gps_default_place_id)[0].data3):0),
        design_theme_day_id:                APP_GLOBAL.design_default_theme_day,
        design_theme_month_id:              APP_GLOBAL.design_default_theme_month,
        design_theme_year_id:               APP_GLOBAL.design_default_theme_year,
        design_paper_size:                  APP_GLOBAL.design_default_papersize,
        design_row_highlight:               APP_GLOBAL.design_default_highlight_row,
        design_column_weekday_checked:      Number(APP_GLOBAL.design_default_show_weekday),
        design_column_calendartype_checked: Number(APP_GLOBAL.design_default_show_calendartype),
        design_column_notes_checked:        Number(APP_GLOBAL.design_default_show_notes),
        design_column_gps_checked:          Number(APP_GLOBAL.design_default_show_gps),
        design_column_timezone_checked:     Number(APP_GLOBAL.design_default_show_timezone),
        image_header_image_img:             APP_GLOBAL.image_default_report_header_src,
        image_footer_image_img:             APP_GLOBAL.image_default_report_footer_src,
        text_header_1_text:                 APP_GLOBAL.text_default_reporttitle1,
        text_header_2_text:                 APP_GLOBAL.text_default_reporttitle2,
        text_header_3_text:                 APP_GLOBAL.text_default_reporttitle3,
        text_header_align:                  null,
        text_footer_1_text:                 APP_GLOBAL.text_default_reportfooter1,
        text_footer_2_text:                 APP_GLOBAL.text_default_reportfooter2,
        text_footer_3_text:                 APP_GLOBAL.text_default_reportfooter3,
        text_footer_align:                  null,
        prayer_method:                      APP_GLOBAL.prayer_default_method,
        prayer_asr_method:                  APP_GLOBAL.prayer_default_asr,
        prayer_high_latitude_adjustment:    APP_GLOBAL.prayer_default_highlatitude,
        prayer_time_format:                 APP_GLOBAL.prayer_default_timeformat,
        prayer_hijri_date_adjustment:       Number(APP_GLOBAL.prayer_default_hijri_adjustment),
        prayer_fajr_iqamat:                 APP_GLOBAL.prayer_default_iqamat_title_fajr,
        prayer_dhuhr_iqamat:                APP_GLOBAL.prayer_default_iqamat_title_dhuhr,
        prayer_asr_iqamat:                  APP_GLOBAL.prayer_default_iqamat_title_asr,
        prayer_maghrib_iqamat:              APP_GLOBAL.prayer_default_iqamat_title_maghrib,
        prayer_isha_iqamat:                 APP_GLOBAL.prayer_default_iqamat_title_isha,
        prayer_column_imsak_checked:        Number(APP_GLOBAL.prayer_default_show_imsak),
        prayer_column_sunset_checked:       Number(APP_GLOBAL.prayer_default_show_sunset),
        prayer_column_midnight_checked:     Number(APP_GLOBAL.prayer_default_show_midnight),
        prayer_column_fast_start_end:       Number(APP_GLOBAL.prayer_default_show_fast_start_end)
    };
    APP_GLOBAL.user_settings = {current_id:0,
                                data:[{  id:null,
                                        json_data:json_data}]
                                };
    //Design
    COMMON_DOCUMENT.querySelector('#paper').className=APP_GLOBAL.design_default_papersize;
};
 /**
  * 
  * @param {string} value 
  * @returns {number|null}
  */
const fixFloat = value =>  (value==''||value==null)?null:parseFloat(value);
/**
 * Settings update
 * @param {'REGIONAL'|'GPS'|'DESIGN'|'IMAGE'|'TEXT'|'PRAYER'|'USER'} setting_tab
 * @returns {void}
 */
const settings_update = setting_tab => {

    const json_data = { description:                        setting_tab=='GPS'?COMMON_DOCUMENT.querySelector('#setting_input_place').textContent:
                                                                APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.description,
                        regional_language_locale:           setting_tab=='REGIONAL'?COMMON_DOCUMENT.querySelector('#setting_select_locale .common_select_dropdown_value').getAttribute('data-value'):
                                                                APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.regional_language_locale,
                        regional_timezone:                  setting_tab=='REGIONAL'?COMMON_DOCUMENT.querySelector('#setting_select_report_timezone .common_select_dropdown_value').getAttribute('data-value'):
                                                                APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.regional_timezone,
                        regional_number_system:             setting_tab=='REGIONAL'?COMMON_DOCUMENT.querySelector('#setting_select_report_numbersystem .common_select_dropdown_value').getAttribute('data-value'):
                                                                APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.regional_number_system,
                        regional_layout_direction:          setting_tab=='REGIONAL'?COMMON_DOCUMENT.querySelector('#setting_select_report_direction .common_select_dropdown_value').getAttribute('data-value'):
                                                                APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.regional_layout_direction,
                        regional_second_language_locale:    setting_tab=='REGIONAL'?COMMON_DOCUMENT.querySelector('#setting_select_report_locale_second .common_select_dropdown_value').getAttribute('data-value'):
                                                                APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.regional_second_language_locale,
                        regional_arabic_script:             setting_tab=='REGIONAL'?COMMON_DOCUMENT.querySelector('#setting_select_report_arabic_script .common_select_dropdown_value').getAttribute('data-value'):
                                                                APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.regional_arabic_script,
                        regional_calendar_type:             setting_tab=='REGIONAL'?COMMON_DOCUMENT.querySelector('#setting_select_calendartype .common_select_dropdown_value').getAttribute('data-value'):
                                                                APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.regional_calendar_type,
                        regional_calendar_hijri_type:       setting_tab=='REGIONAL'?COMMON_DOCUMENT.querySelector('#setting_select_calendar_hijri_type .common_select_dropdown_value').getAttribute('data-value'):
                                                                APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.regional_calendar_hijri_type,
                        gps_popular_place_id:               setting_tab=='GPS'?JSON.parse(COMMON_DOCUMENT.querySelector('#setting_select_popular_place .common_select_dropdown_value').getAttribute('data-value')).id:
                                                                    APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.gps_popular_place_id,
                        gps_lat_text:                       setting_tab=='GPS'?fixFloat(COMMON_DOCUMENT.querySelector('#setting_input_lat').textContent):
                                                                APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.gps_lat_text,
                        gps_long_text:                      setting_tab=='GPS'?fixFloat(COMMON_DOCUMENT.querySelector('#setting_input_long').textContent):
                                                                APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.gps_long_text,
                        design_theme_day_id:                setting_tab=='DESIGN'?get_theme_id('day'):APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.design_theme_day_id,
                        design_theme_month_id:              setting_tab=='DESIGN'?get_theme_id('month'):APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.design_theme_month_id,
                        design_theme_year_id:               setting_tab=='DESIGN'?get_theme_id('year'):APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.design_theme_year_id,
                        design_paper_size:                  setting_tab=='DESIGN'?COMMON_DOCUMENT.querySelector('#setting_select_report_papersize .common_select_dropdown_value').getAttribute('data-value'):
                                                                APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.design_paper_size,
                        design_row_highlight:               setting_tab=='DESIGN'?COMMON_DOCUMENT.querySelector('#setting_select_report_highlight_row .common_select_dropdown_value').getAttribute('data-value'):
                                                                APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.design_row_highlight,
                        design_column_weekday_checked:      setting_tab=='DESIGN'?Number(COMMON_DOCUMENT.querySelector('#setting_checkbox_report_show_weekday').classList.contains('checked')):
                                                                APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.design_column_weekday_checked,
                        design_column_calendartype_checked: setting_tab=='DESIGN'?Number(COMMON_DOCUMENT.querySelector('#setting_checkbox_report_show_calendartype').classList.contains('checked')):
                                                                APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.design_column_calendartype_checked,
                        design_column_notes_checked:        setting_tab=='DESIGN'?Number(COMMON_DOCUMENT.querySelector('#setting_checkbox_report_show_notes').classList.contains('checked')):
                                                                APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.design_column_notes_checked,
                        design_column_gps_checked:          setting_tab=='DESIGN'?Number(COMMON_DOCUMENT.querySelector('#setting_checkbox_report_show_gps').classList.contains('checked')):
                                                                APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.design_column_gps_checked,
                        design_column_timezone_checked:     setting_tab=='DESIGN'?Number(COMMON_DOCUMENT.querySelector('#setting_checkbox_report_show_timezone').classList.contains('checked')):
                                                                APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.design_column_timezone_checked,
                        image_header_image_img:             setting_tab=='IMAGE'?COMMON_DOCUMENT.querySelector('#setting_reportheader_img').getAttribute('data-image'):
                                                                APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.image_header_image_img,
                        image_footer_image_img:             setting_tab=='IMAGE'?COMMON_DOCUMENT.querySelector('#setting_reportfooter_img').getAttribute('data-image'):
                                                                APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.image_footer_image_img,
                        text_header_1_text:                 setting_tab=='TEXT'?COMMON_DOCUMENT.querySelector('#setting_input_reportheader1').textContent:  
                                                                APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.text_header_1_text,
                        text_header_2_text:                 setting_tab=='TEXT'?COMMON_DOCUMENT.querySelector('#setting_input_reportheader2').textContent:
                                                                APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.text_header_2_text,
                        text_header_3_text:                 setting_tab=='TEXT'?COMMON_DOCUMENT.querySelector('#setting_input_reportheader3').textContent:
                                                                APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.text_header_3_text,
                        text_header_align:                  setting_tab=='TEXT'? (align_button_value('header')==''?null:align_button_value('header')):
                                                                APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.text_header_align,
                        text_footer_1_text:                 setting_tab=='TEXT'?COMMON_DOCUMENT.querySelector('#setting_input_reportfooter1').textContent:
                                                                APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.text_footer_1_text,
                        text_footer_2_text:                 setting_tab=='TEXT'?COMMON_DOCUMENT.querySelector('#setting_input_reportfooter2').textContent:
                                                                APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.text_footer_2_text,
                        text_footer_3_text:                 setting_tab=='TEXT'?COMMON_DOCUMENT.querySelector('#setting_input_reportfooter3').textContent:
                                                                APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.text_footer_3_text,
                        text_footer_align:                  setting_tab=='TEXT'? (align_button_value('footer')==''?null:align_button_value('footer')):
                                                                APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.text_footer_align,
                        prayer_method:                      setting_tab=='PRAYER'?COMMON_DOCUMENT.querySelector('#setting_select_method .common_select_dropdown_value').getAttribute('data-value'):
                                                                APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.prayer_method,
                        prayer_asr_method:                  setting_tab=='PRAYER'?COMMON_DOCUMENT.querySelector('#setting_select_asr .common_select_dropdown_value').getAttribute('data-value'):
                                                                APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.prayer_asr_method,
                        prayer_high_latitude_adjustment:    setting_tab=='PRAYER'?COMMON_DOCUMENT.querySelector('#setting_select_highlatitude .common_select_dropdown_value').getAttribute('data-value'):
                                                                APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.prayer_high_latitude_adjustment,
                        prayer_time_format:                 setting_tab=='PRAYER'?COMMON_DOCUMENT.querySelector('#setting_select_timeformat .common_select_dropdown_value').getAttribute('data-value'):
                                                                APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.prayer_time_format,
                        prayer_hijri_date_adjustment:       setting_tab=='PRAYER'?Number(COMMON_DOCUMENT.querySelector('#setting_select_hijri_adjustment .common_select_dropdown_value').getAttribute('data-value')):
                                                                APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.prayer_hijri_date_adjustment,
                        prayer_fajr_iqamat:                 setting_tab=='PRAYER'?COMMON_DOCUMENT.querySelector('#setting_select_report_iqamat_title_fajr .common_select_dropdown_value').getAttribute('data-value'):
                                                                APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.prayer_fajr_iqamat,
                        prayer_dhuhr_iqamat:                setting_tab=='PRAYER'?COMMON_DOCUMENT.querySelector('#setting_select_report_iqamat_title_dhuhr .common_select_dropdown_value').getAttribute('data-value'):
                                                                APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.prayer_dhuhr_iqamat,
                        prayer_asr_iqamat:                  setting_tab=='PRAYER'?COMMON_DOCUMENT.querySelector('#setting_select_report_iqamat_title_asr .common_select_dropdown_value').getAttribute('data-value'):
                                                                APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.prayer_asr_iqamat,
                        prayer_maghrib_iqamat:              setting_tab=='PRAYER'?COMMON_DOCUMENT.querySelector('#setting_select_report_iqamat_title_maghrib .common_select_dropdown_value').getAttribute('data-value'):
                                                                APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.prayer_maghrib_iqamat,
                        prayer_isha_iqamat:                 setting_tab=='PRAYER'?COMMON_DOCUMENT.querySelector('#setting_select_report_iqamat_title_isha .common_select_dropdown_value').getAttribute('data-value'):
                                                                APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.prayer_isha_iqamat,
                        prayer_column_imsak_checked:        setting_tab=='PRAYER'?Number(COMMON_DOCUMENT.querySelector('#setting_checkbox_report_show_imsak').classList.contains('checked')):
                                                                APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.prayer_column_imsak_checked,
                        prayer_column_sunset_checked:       setting_tab=='PRAYER'?Number(COMMON_DOCUMENT.querySelector('#setting_checkbox_report_show_sunset').classList.contains('checked')):
                                                                APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.prayer_column_sunset_checked,
                        prayer_column_midnight_checked:     setting_tab=='PRAYER'?Number(COMMON_DOCUMENT.querySelector('#setting_checkbox_report_show_midnight').classList.contains('checked')):
                                                                APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.prayer_column_midnight_checked,
                        prayer_column_fast_start_end:       setting_tab=='PRAYER'?Number(COMMON_DOCUMENT.querySelector('#setting_select_report_show_fast_start_end .common_select_dropdown_value').getAttribute('data-value')):
                                                                APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.prayer_column_fast_start_end
                    };
    APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data = json_data;
};

/**
 * Profile user setting show link
 * @param {HTMLElement} item 
 * @returns {void}
 */
const profile_user_setting_link = item => {
    const select_user_setting = COMMON_DOCUMENT.querySelector('#profile_select_user_settings .common_select_dropdown_value').getAttribute('data-value');
    const user_account_id = JSON.parse(select_user_setting).user_account_id;
    const sid = JSON.parse(select_user_setting).sid;
    const paper_size = JSON.parse(select_user_setting).paper_size;
    switch (item.id){
        case 'profile_user_settings_day':
        case 'profile_user_settings_month':
        case 'profile_user_settings_year':{
            const url = get_report_url(user_account_id, 
                                     sid, 
                                     paper_size,
                                     item.id,
                                     'HTML',
                                     false);
            common.commonComponentRender({
                    mountDiv:   'common_window_info',
                    data:       {
                                info:2,
                                url:null,
                                content_type:'HTML', 
                                iframe_content:url,
                                iframe_class:paper_size
                                },
                    methods:    {commonWindowSetTimeout:common.commonWindowSetTimeout},
                    path:       '/common/component/common_window_info.js'});
            break;
        }
        case 'profile_user_settings_like':{
            user_settings_like(sid);
            break;
        }
    }
};

/**
 * User settings like
 * @param {number} user_account_app_data_post_id 
 * @returns {void}
 */
const user_settings_like = user_account_app_data_post_id => {
    /**@type{import('../../../common_types.js').CommonRESTAPIMethod} */
    let method;
    const json_data = {user_account_app_data_post_id: user_account_app_data_post_id};
    if (common.COMMON_GLOBAL.user_account_id == null)
        common.commonDialogueShow('LOGIN');
    else {
        if (COMMON_DOCUMENT.querySelector('#profile_user_settings_like').children[0].style.display == 'block')
            method = 'POST';
        else
            method = 'DELETE';
        common.commonFFB({path:`/server-db/user_account_app_data_post_like/${common.COMMON_GLOBAL.user_account_id??''}`, method:method, authorization_type:'APP_ACCESS', body:json_data})
        .then(()=>APP_GLOBAL.function_profile_user_setting_update(  COMMON_DOCUMENT.querySelector('#common_profile_id').textContent,
                                                                    JSON.parse(COMMON_DOCUMENT.querySelector('#profile_select_user_settings .common_select_dropdown_value')
                                                                                .getAttribute('data-value')).sid))
        .catch(()=>null);
    }
};
/**
 * App event click
 * @param {import('../../../common_types.js').CommonAppEvent} event 
 */
const app_event_click = event => {
    if (event==null){
        COMMON_DOCUMENT.querySelector(`#${common.COMMON_GLOBAL.app_root}`).addEventListener('click',(/**@type{import('../../../common_types.js').CommonAppEvent}*/event) => {
            app_event_click(event);
        }, true);
    }
    else{
        const event_target_id = common.commonElementId(event.target);
        common.commonEvent('click',event)
        .then(()=>{
            switch (event_target_id){
                case event.target?.classList.contains('common_select_option')?event_target_id:'':
                case event.target.parentNode?.classList.contains('common_select_option')?event_target_id:'':{
                    //settings regional
                    if(event_target_id == 'setting_select_locale'){
                        settings_update('REGIONAL');
                    }
                    if(event_target_id == 'setting_select_report_timezone'){
                        settings_update('REGIONAL');
                    }
                    if(event_target_id == 'setting_select_report_numbersystem' ||
                       event_target_id == 'setting_select_report_direction'){
                        settings_update('REGIONAL');
                    }
                    if(event_target_id == 'setting_select_report_locale_second'){
                        settings_update('REGIONAL');
                    }
                    if( event_target_id == 'setting_select_report_arabic_script' ||
                        event_target_id == 'setting_select_calendartype' ||
                        event_target_id == 'setting_select_calendar_hijri_type'){
                        settings_update('REGIONAL');
                    }
                    //settings gps
                    if(event_target_id=='setting_select_popular_place'){
                        settings_update('GPS');
                        component_setting_update('GPS', 'POPULAR_PLACES');
                    }
                    //settings design
                    if(event_target_id == 'setting_select_report_papersize'){
                        settings_update('DESIGN');
                        component_setting_update('DESIGN', 'PAPER');
                    }
                    if(event_target_id== 'setting_select_report_highlight_row')
                        settings_update('DESIGN');
                    //module leaflet
                    if (event_target_id == 'common_module_leaflet_select_country')
                        settings_update('GPS');
                    if(event_target_id == 'common_module_leaflet_select_city'){
                        //popular place not on map is read when saving
                        component_setting_update('GPS', 'CITY');
                    }
                    if (event_target_id == 'common_module_leaflet_select_mapstyle')
                        component_setting_update('GPS', 'MAP');

                    //settings prayer
                    if (event_target_id == 'setting_select_method'){
                        component_setting_update('PRAYER', 'METHOD');
                        settings_update('PRAYER');
                    }
                    if (event_target_id == 'setting_select_asr' ||
                        event_target_id == 'setting_select_highlatitude' ||
                        event_target_id == 'setting_select_timeformat' ||
                        event_target_id == 'setting_select_hijri_adjustment' ||
                        event_target_id == 'setting_select_report_iqamat_title_fajr' ||
                        event_target_id == 'setting_select_report_iqamat_title_dhuhr' ||
                        event_target_id == 'setting_select_report_iqamat_title_asr' ||
                        event_target_id == 'setting_select_report_iqamat_title_maghrib' ||
                        event_target_id == 'setting_select_report_iqamat_title_isha' ||
                        event_target_id == 'setting_select_report_show_fast_start_end'){
                        settings_update('PRAYER');
                    }
                    //settings user
                    if (event_target_id == 'setting_select_user_setting'){
                        component_setting_update('USER', 'SETTING');
                    }
                    //profile
                    if (event_target_id== 'profile_select_user_settings'){
                        APP_GLOBAL.function_profile_show_user_setting_detail(   Number(JSON.parse(event.target.getAttribute('data-value')).liked), 
                                                                                Number(JSON.parse(event.target.getAttribute('data-value')).count_likes), 
                                                                                Number(JSON.parse(event.target.getAttribute('data-value')).count_views));
                    }
                    break;
                }
                //info dialogue
                case 'app_link':{
                    if (common.COMMON_GLOBAL.app_link_url)
                        common.commonWindowOpen(common.COMMON_GLOBAL.app_link_url);
                    break;
                }
                case 'info_link1':{
                    common.commonComponentRender({
                        mountDiv:   'common_window_info',
                        data:       {
                                    info:1,
                                    url:common.COMMON_GLOBAL.info_link_policy_url,
                                    content_type:null, 
                                    iframe_content:null
                                    },
                        methods:    {commonWindowSetTimeout:common.commonWindowSetTimeout},
                        path:       '/common/component/common_window_info.js'});
                    break;
                }
                case 'info_link2':{
                    common.commonComponentRender({
                        mountDiv:   'common_window_info',
                        data:       {
                                    info:1,
                                    url:common.COMMON_GLOBAL.info_link_disclaimer_url,
                                    content_type:null, 
                                    iframe_content:null},
                        methods:    {commonWindowSetTimeout:common.commonWindowSetTimeout},
                        path:       '/common/component/common_window_info.js'});
                    break;
                }
                case 'info_link3':{
                    common.commonComponentRender({
                        mountDiv:   'common_window_info',
                        data:       {
                                    info:1,
                                    url:common.COMMON_GLOBAL.info_link_terms_url,
                                    content_type:null, 
                                    iframe_content:null},
                        methods:    {commonWindowSetTimeout:common.commonWindowSetTimeout},
                        path:       '/common/component/common_window_info.js'});
                    break;
                }
                case 'info_link4':{
                    common.commonComponentRender({
                        mountDiv:   'common_window_info',
                        data:       {
                                    info:1,
                                    url:common.COMMON_GLOBAL.info_link_about_url,
                                    content_type:null, 
                                    iframe_content:null
                                    },
                        methods:    {commonWindowSetTimeout:common.commonWindowSetTimeout},
                        path:       '/common/component/common_window_info.js'});
                    break;
                }
                case 'info_close':{
                    common.commonComponentRemove('dialogue_info', true);
                    break;
                }
                //toolbar top
                case 'toolbar_btn_zoomout':{
                    zoom_paper(-1);
                    break;
                }
                case 'toolbar_btn_zoomin':{
                    zoom_paper(1);
                    break;
                }
                case 'toolbar_btn_left':{
                    update_timetable_report(APP_GLOBAL.timetable_type, event_target_id, getReportSettings());
                    break;
                }
                case 'toolbar_btn_right':{
                    update_timetable_report(APP_GLOBAL.timetable_type, event_target_id, getReportSettings());
                    break;
                }
                case 'toolbar_btn_search':{
                    const input_row = COMMON_DOCUMENT.querySelector('#common_profile_search_input');
                    const searchlist = COMMON_DOCUMENT.querySelector('#common_profile_search_list_wrap');
                    if (input_row.style.visibility == 'visible'){
                        input_row.style.visibility='hidden';
                        input_row.textContent = '';
                        searchlist.style.visibility = 'hidden';
                        searchlist.style.display  = 'flex';
                        searchlist.textContent = '';
                    }
                    else{
                        input_row.style.visibility='visible';
                        searchlist.style.visibility = 'visible';
                        searchlist.style.display  = 'none';
                    }                   
                    COMMON_DOCUMENT.querySelector('#common_profile_search_input').focus();
                    break;
                }
                //toolbar bottom
                case 'toolbar_btn_about':{
                    common.commonComponentRender({
                        mountDiv:   'dialogue_info',
                        data:       {   
                                    about_logo:common.COMMON_GLOBAL.app_logo,
                                    app_copyright:common.COMMON_GLOBAL.app_copyright,
                                    app_link_url:common.COMMON_GLOBAL.app_link_url,
                                    app_link_title: common.COMMON_GLOBAL.app_link_title,
                                    info_link_policy_name:common.COMMON_GLOBAL.info_link_policy_name,
                                    info_link_disclaimer_name:common.COMMON_GLOBAL.info_link_disclaimer_name,
                                    info_link_terms_name:common.COMMON_GLOBAL.info_link_terms_name,
                                    info_link_about_name:common.COMMON_GLOBAL.info_link_about_name
                                    },
                        methods:    null,
                        path:       '/component/dialogue_info.js'});
                    break;
                }
                case 'toolbar_btn_print':{
                    toolbar_button(1);
                    break;
                }
                case 'toolbar_btn_day':{
                    toolbar_button(2);
                    break;
                }
                case 'toolbar_btn_month':{
                    toolbar_button(3);
                    break;
                }
                case 'toolbar_btn_year':{
                    toolbar_button(4);
                    break;
                }
                case 'toolbar_btn_settings':{
                    toolbar_button(5);
                    break;
                }
                //tab navigation
                case 'settings_tab_nav_1':
                case 'settings_tab_nav_2':
                case 'settings_tab_nav_3':
                case 'settings_tab_nav_4':
                case 'settings_tab_nav_5':
                case 'settings_tab_nav_6':{
                    SettingShow(Number(event_target_id.substring(event_target_id.length-1)));
                    break;
                }
                case 'settings_tab_nav_7':
                case 'user_setting_avatar_img':{
                    SettingShow(7);
                    break;
                }
                case 'scan_open_mobile_close':{
                    common.commonComponentRemove('dialogue_scan_open_mobile', true);
                    break;
                }
                //settings
                case 'settings_close':{
                    common.commonComponentRemove('settings_content');
                    if (common.commonMobile())
                        COMMON_DOCUMENT.querySelector('#paper').style.display = 'block';
                    COMMON_DOCUMENT.querySelector('#settings').style.visibility = 'hidden';
                    const timetable_type = COMMON_DOCUMENT.querySelector('#toolbar_bottom .toolbar_bottom_selected').id
                                                .toLowerCase()
                                                .substring('toolbar_btn_'.length);
                    update_timetable_report(timetable_type=='day'?0:timetable_type=='month'?1:2, null, getReportSettings());
                    break;
                }
                
                //setting design
                case 'setting_design_prev_day':
                case 'setting_design_next_day':
                case 'setting_design_prev_month':
                case 'setting_design_next_month':
                case 'setting_design_prev_year':
                case 'setting_design_next_year':{
                    /**@ts-ignore */
                    theme_nav(event_target_id.split('_')[2]=='prev'?-1:1, event_target_id.split('_')[3])
                    .then(()=>settings_update('DESIGN'));
                    
                    break;
                }
                case 'setting_checkbox_report_show_weekday':
                case 'setting_checkbox_report_show_calendartype':
                case 'setting_checkbox_report_show_notes':
                case 'setting_checkbox_report_show_gps':
                case 'setting_checkbox_report_show_timezone':{
                    settings_update('DESIGN');
                    break;
                }    
                //settings image
                case 'setting_icon_image_header_img':{
                    COMMON_DOCUMENT.querySelector('#setting_input_reportheader_img').click();
                    break;
                }
                case 'setting_icon_image_header_clear':{
                    component_setting_update('IMAGE', 'HEADER_CLEAR');
                    settings_update('IMAGE');
                    break;
                }
                case 'setting_icon_image_footer_img':{
                    COMMON_DOCUMENT.querySelector('#setting_input_reportfooter_img').click();
                    break;
                }
                case 'setting_icon_image_footer_clear':{
                    component_setting_update('IMAGE', 'FOOTER_CLEAR');
                    settings_update('IMAGE');
                    break;
                }
                //settings text
                case 'setting_icon_text_theme_day':
                case 'setting_icon_text_theme_month':
                case 'setting_icon_text_theme_year':{
                    COMMON_DOCUMENT.querySelector('#setting_icon_text_theme_day').classList.remove('common_dialogue_button');
                    COMMON_DOCUMENT.querySelector('#setting_icon_text_theme_month').classList.remove('common_dialogue_button');
                    COMMON_DOCUMENT.querySelector('#setting_icon_text_theme_year').classList.remove('common_dialogue_button');
                    const  theme_type = event_target_id.substring(24);
                    //mark active icon
                    COMMON_DOCUMENT.querySelector('#' + event_target_id).classList.add('common_dialogue_button');
                    COMMON_DOCUMENT.querySelector('#setting_paper_preview_text').className =  'setting_paper_preview' + ' ' +
                                                                                        `theme_${theme_type}_${get_theme_id(theme_type)} ` + 
                                                                                        APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.regional_arabic_script;
                    break;
                }
                case 'setting_icon_text_header_aleft':
                case 'setting_icon_text_header_acenter':
                case 'setting_icon_text_header_aright':{
                    component_setting_update('TEXT', 'HEADER_ALIGN', event_target_id);
                    settings_update('TEXT');
                    break;
                }
                case 'setting_icon_text_footer_aleft':
                case 'setting_icon_text_footer_acenter':
                case 'setting_icon_text_footer_aright':{
                    component_setting_update('TEXT', 'FOOTER_ALIGN', event_target_id);
                    settings_update('TEXT');
                    break;
                }
                //settings prayer
                case 'setting_checkbox_report_show_imsak':
                case 'setting_checkbox_report_show_sunset':
                case 'setting_checkbox_report_show_midnight':{
                    settings_update('PRAYER');
                    break;
                }
                //settings user
                case 'setting_btn_user_save':{
                    user_settings_function('SAVE', false);
                    break;
                }
                case 'setting_btn_user_add':{
                    user_settings_function('ADD', false);
                    break;
                }
                case 'setting_btn_user_delete':{
                    user_settings_delete();
                    break;
                }
                case 'user_day_html':        
                case 'user_month_html':
                case 'user_year_html':{
                    user_setting_link(COMMON_DOCUMENT.querySelector('#' + event_target_id));
                    break;
                }
                //app profile
                case 'profile_main_btn_user_settings':{
                    COMMON_DOCUMENT.querySelectorAll('.common_profile_btn_selected').forEach((/**@type{HTMLElement}*/btn)=>btn.classList.remove('common_profile_btn_selected'));
                    COMMON_DOCUMENT.querySelector(`#${event_target_id}`).classList.add('common_profile_btn_selected');
                    profile_detail_app(0);
                    break;
                }
                case 'profile_main_btn_user_setting_likes':
                case 'profile_main_btn_user_setting_likes_user_setting':{
                    COMMON_DOCUMENT.querySelectorAll('.common_profile_btn_selected').forEach((/**@type{HTMLElement}*/btn)=>btn.classList.remove('common_profile_btn_selected'));
                    COMMON_DOCUMENT.querySelector(`#${event_target_id}`).classList.add('common_profile_btn_selected');
                    profile_detail_app(6);
                    break;
                }
                case 'profile_main_btn_user_setting_liked':
                case 'profile_main_btn_user_setting_liked_user_setting':{
                    COMMON_DOCUMENT.querySelectorAll('.common_profile_btn_selected').forEach((/**@type{HTMLElement}*/btn)=>btn.classList.remove('common_profile_btn_selected'));
                    COMMON_DOCUMENT.querySelector(`#${event_target_id}`).classList.add('common_profile_btn_selected');
                    profile_detail_app(7);
                    break;
                }
                case 'profile_stat_row2_1':{
                    profile_stat_app(4, '/server-db/user_account_app_data_post-profile-stat');
                    break;
                }
                case 'profile_stat_row2_2':{
                    profile_stat_app(5, '/server-db/user_account_app_data_post-profile-stat');
                    break;
                }
                case 'profile_user_settings_day':
                case 'profile_user_settings_month':
                case 'profile_user_settings_year':
                case 'profile_user_settings_like':{
                    profile_user_setting_link(COMMON_DOCUMENT.querySelector(`#${event_target_id}`));
                    break;
                }
                //common
                case 'common_toolbar_framework_js':{
                   framework_set(1);
                    break;
                }
                case 'common_toolbar_framework_vue':{
                   framework_set(2);
                    break;
                }
                case 'common_toolbar_framework_react':{
                   framework_set(3);
                    break;
                }
                //dialogue user menu
                case 'common_user_menu':
                    case 'common_user_menu_logged_in':
                    case 'common_user_menu_avatar':
                    case 'common_user_menu_avatar_img':
                    case 'common_user_menu_logged_out':
                    case 'common_user_menu_default_avatar':{
                        common.commonComponentRender({
                            mountDiv:   'common_dialogue_user_menu',
                            data:       {
                                        app_id:common.COMMON_GLOBAL.app_id,
                                        user_account_id:common.COMMON_GLOBAL.user_account_id,
                                        common_app_id:common.COMMON_GLOBAL.common_app_id,
                                        data_app_id:common.COMMON_GLOBAL.common_app_id,
                                        username:common.COMMON_GLOBAL.user_account_username,
                                        token_exp:common.COMMON_GLOBAL.token_exp,
                                        token_iat:common.COMMON_GLOBAL.token_iat,
                                        token_timestamp: common.COMMON_GLOBAL.token_timestamp,
                                        system_admin:common.COMMON_GLOBAL.system_admin,
                                        user_locale:common.COMMON_GLOBAL.user_locale,
                                        user_timezone:common.COMMON_GLOBAL.user_timezone,
                                        user_direction:common.COMMON_GLOBAL.user_direction,
                                        user_arabic_script:common.COMMON_GLOBAL.user_arabic_script
                                        },
                            methods:    {
                                        commonSelectCurrentValueSet:common.commonSelectCurrentValueSet,
                                       commonFFB:common.commonFFB,
                                        commonComponentRender:common.commonComponentRender,
                                        commonUserSessionCountdown:common.commonUserSessionCountdown,
                                        commonMessageShow:common.commonMessageShow
                                        },
                            path:       '/common/component/common_dialogue_user_menu.js'})
                        .then(()=>
                            common.commonComponentRender({
                                mountDiv:   'common_dialogue_user_menu_app_theme',
                                data:       null,
                                methods:    {
                                            commonThemeDefaultList:common.commonThemeDefaultList,
                                            commonComponentRender:common.commonComponentRender, 
                                            app_theme_update:common.commonPreferencesPostMount
                                            },
                                path:       '/common/component/common_dialogue_user_menu_app_theme.js'}));
                        break;
                    }
                case 'common_dialogue_user_menu_log_out':{
                    user_logout_app();
                    break;
                }
                case 'common_dialogue_user_menu_username':{
                    toolbar_button(6);
                    break;
                }
                //profile button
                case 'common_profile_btn_top':{
                    toolbar_button(7);
                    break;
                }
                //dialogue user start
                case 'common_user_start_login_button':{
                    user_login_app();
                    break;
                }
                case 'common_user_start_identity_provider_login':{
                    const target_row = common.commonElementRow(event.target);
                    const provider_element = target_row.querySelector('.common_login_provider_id');
                    if (provider_element &amp;&amp; provider_element.textContent)
                        ProviderSignIn_app(parseInt(provider_element.textContent));
                    break;
                }
                //dialogue profile 
                case 'common_dialogue_profile_home':{
                    toolbar_button(7);
                    break;
                }
                case 'common_profile_follow':{
                    user_function_app('FOLLOW');
                    break;
                }
                case 'common_profile_like':{
                    user_function_app('LIKE');
                    break;
                }
                //dialogue profile stat and info list
                case 'common_profile_search_list':
                case 'common_profile_detail_list':
                case 'common_profile_stat_list':{
                    if (COMMON_DOCUMENT.querySelector('#common_profile_main_stat_row2'))
                        common.commonComponentRender({
                            mountDiv:   'common_profile_main_stat_row2',
                            data:       {   
                                        user_account_id:common.COMMON_GLOBAL.user_account_id,
                                        profile_id:common.commonElementRow(event.target).getAttribute('data-user_account_id')},
                            methods:    {
                                        commonComponentRender:common.commonComponentRender,
                                       commonFFB:common.commonFFB
                                        },
                            path:       '/component/profile_info.js'})
                        .then((/**@type{{data:       null, 
                                        methods:    {
                                                    profile_user_setting_update:function,
                                                    commonProfileShow_user_setting_detail:function, 
                                                    profile_user_setting_stat:function}}}*/component)=>{
                            APP_GLOBAL.function_profile_user_setting_update = component.methods.profile_user_setting_update;
                            APP_GLOBAL.function_profile_show_user_setting_detail= component.methods.commonProfileShow_user_setting_detail;
                            APP_GLOBAL.function_profile_user_setting_stat = component.methods.profile_user_setting_stat;
                        });
                    break;
                }

                //module leaflet
                case 'common_module_leaflet_search_list':{
                    component_setting_update('GPS', 'CITY');
                    break;
                }
                case 'common_module_leaflet_control_my_location_id':{
                    common.commonSelectCurrentValueSet('setting_select_popular_place', null, 'id', null);
                    COMMON_DOCUMENT.querySelector('#setting_input_place').textContent = common.COMMON_GLOBAL.client_place;
                    COMMON_DOCUMENT.querySelector('#setting_input_long').textContent = common.COMMON_GLOBAL.client_longitude;
                    COMMON_DOCUMENT.querySelector('#setting_input_lat').textContent = common.COMMON_GLOBAL.client_latitude;
                    //update timezone
                    APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.regional_timezone = getTimezone(common.COMMON_GLOBAL.client_latitude, common.COMMON_GLOBAL.client_longitude);
                    //set qibbla
                    map_show_qibbla();
                    REPORT_GLOBAL.session_currentDate = common.commonTimezoneDate(APP_GLOBAL.user_settings.data[APP_GLOBAL.user_settings.current_id].json_data.regional_timezone);
                    settings_update('GPS');
                    break;
                }       
            }
        });
    }
};
/**
 * App event change
 * @param {import('../../../common_types.js').CommonAppEvent} event 
 * @returns {void}
 */
const app_event_change = event => {
    if (event==null){
        COMMON_DOCUMENT.querySelector(`#${common.COMMON_GLOBAL.app_root}`).addEventListener('change',(/**@type{import('../../../common_types.js').CommonAppEvent}*/event) => {
            app_event_change(event);
        }, true);
    }
    else{
        const event_target_id = common.commonElementId(event.target);
        common.commonEvent('change',event)
        .then(()=>{
            switch (event_target_id){
                //settings image
                case 'setting_input_reportheader_img':{
                    component_setting_update('IMAGE', 'HEADER_LOAD',  event_target_id)
                    .then(()=> settings_update('IMAGE'));
                    break;
                }
                case 'setting_input_reportfooter_img':{
                    component_setting_update('IMAGE', 'FOOTER_LOAD', event_target_id)
                    .then(()=> settings_update('IMAGE'));
                    break;
                }
            }
        });
    }
};
/**
 * App event keyup
 * @param {import('../../../common_types.js').CommonAppEvent} event 
 * @returns {void}
 */
const app_event_keyup = event => {
    if (event==null){
        COMMON_DOCUMENT.querySelector(`#${common.COMMON_GLOBAL.app_root}`).addEventListener('keyup',(/**@type{import('../../../common_types.js').CommonAppEvent}*/event) => {
            app_event_keyup(event);
        }, true);
    }
    else{
        const event_target_id = common.commonElementId(event.target);
        common.commonEvent('keyup',event)
        .then(()=>{
            switch(event_target_id){
                //settings gps
                case 'setting_input_place':{
                    common.commonSelectCurrentValueSet('setting_select_popular_place', null, 'id', null);
                    settings_update('GPS');
                    break;
                }
                case 'setting_input_long':
                case 'setting_input_lat':{
                    settings_update('GPS');
                    common.commonTypewatch(component_setting_update, 'GPS', 'POSITION');
                    break;
                }
                //settings text
                case 'setting_input_reportheader1':
                case 'setting_input_reportheader2':
                case 'setting_input_reportheader3':
                case 'setting_input_reportfooter1':
                case 'setting_input_reportfooter2':
                case 'setting_input_reportfooter3':{
                    settings_update('TEXT');
                    break;
                }
                //common
                case 'common_user_start_login_username':
                case 'common_user_start_login_password':{
                    if (event.code === 'Enter') {
                        event.preventDefault();
                        user_login_app().catch(()=>null);
                    }
                    break;
                }
                //dialogue verify
                case 'common_user_verify_verification_char1':
                case 'common_user_verify_verification_char2':
                case 'common_user_verify_verification_char3':
                case 'common_user_verify_verification_char4':
                case 'common_user_verify_verification_char5':{
                    common.commonUserVerifyCheckInput( COMMON_DOCUMENT.querySelector(`#${event_target_id}`), 
                                                    'common_user_verify_verification_char' + (Number(event_target_id.substring(event_target_id.length-1))+1), user_login_app);
                    break;
                }
                case 'common_user_verify_verification_char6':{
                    common.commonUserVerifyCheckInput(COMMON_DOCUMENT.querySelector(`#${event_target_id}`), '', user_login_app);
                    break;
                }
            }
        });
    }
};

/**
 * Map show qibbla
 * @returns {void}
 */
const map_show_qibbla = () => {
    common.COMMON_GLOBAL.moduleLeaflet.methods.map_line_removeall();
    common.COMMON_GLOBAL.moduleLeaflet.methods.map_line_create('qibbla', 
                    APP_GLOBAL.gps_module_leaflet_qibbla_title,
                    APP_GLOBAL.gps_module_leaflet_qibbla_text_size,
                    APP_GLOBAL.gps_module_leaflet_qibbla_long,
                    APP_GLOBAL.gps_module_leaflet_qibbla_lat,
                    COMMON_DOCUMENT.querySelector('#setting_input_long').textContent,
                    COMMON_DOCUMENT.querySelector('#setting_input_lat').textContent,
                    APP_GLOBAL.gps_module_leaflet_qibbla_color,
                    APP_GLOBAL.gps_module_leaflet_qibbla_width,
                    APP_GLOBAL.gps_module_leaflet_qibbla_opacity);
    common.COMMON_GLOBAL.moduleLeaflet.methods.map_line_create('qibbla_old', 
                    APP_GLOBAL.gps_module_leaflet_qibbla_old_title,
                    APP_GLOBAL.gps_module_leaflet_qibbla_old_text_size,
                    APP_GLOBAL.gps_module_leaflet_qibbla_old_long,
                    APP_GLOBAL.gps_module_leaflet_qibbla_old_lat,
                    COMMON_DOCUMENT.querySelector('#setting_input_long').textContent,
                    COMMON_DOCUMENT.querySelector('#setting_input_lat').textContent,
                    APP_GLOBAL.gps_module_leaflet_qibbla_old_color,
                    APP_GLOBAL.gps_module_leaflet_qibbla_old_width,
                    APP_GLOBAL.gps_module_leaflet_qibbla_old_opacity);
};
/**
 * Map update
 * @param {{longitude:string,
 *          latitude:string,
 *          text_place:string,
 *          country:string,
 *          city:string,
 *          timezone_text :string|null
 *          }} parameters
 * @returns {Promise.&lt;string|null>}
 */
const map_update_app = async (parameters) => {
    return new Promise((resolve) => {
        map_show_qibbla();
        common.COMMON_GLOBAL.moduleLeaflet.methods.map_update({ longitude:parameters.longitude,
                                                                latitude:parameters.latitude,
                                                                text_place:parameters.text_place,
                                                                country:'',
                                                                city:'',
                                                                timezone_text :parameters.timezone_text,
                                                                to_method:1
                                                            }).then((/**@type{string}*/timezonetext)=> {
            resolve(timezonetext);
        });
    });
};

/**
 * App exception function
 * @param {Error} error
 * @returns {void}
 */
const app_exception = (error) => {
    common.commonMessageShow('EXCEPTION', null, null, null, error);
};
/**
 * Sets framework
 * @param {number|null} framework 
 * @returns {Promise.&lt;void>}
 */
const framework_set = async (framework=null) => {
    await common.commonFrameworkSet(framework,
        {   Click: app_event_click,
            Change: app_event_change,
            KeyDown: null,
            KeyUp: app_event_keyup,
            Focus: null,
            Input:null});
};

/**
 * 
 * @param {{app:*[],
 *          app_service:{system_admin_only:number, first_time:number}}} parameters 
 * @returns {Promise.&lt;void>}
 */
const init_app = async parameters => {
    await common.commonComponentRender({
        mountDiv:   common.COMMON_GLOBAL.app_div,
        data:       null,
        methods:    null,
        path:       '/component/app.js'})
    .then(()=>
        common.commonComponentRender({
            mountDiv:   'app_profile_search',
            data:       null,
            methods:    null,
            path:       '/common/component/common_profile_search.js'}))
    .then(()=>
        common.commonComponentRender({
            mountDiv:   'app_profile_toolbar',
            data:       null,
            methods:    null,
            path:       '/common/component/common_profile_toolbar.js'}))
    .then(()=>
        common.commonComponentRender({
            mountDiv:   'app_user_account',
            data:       null,
            methods:    null,
            path:       '/common/component/common_user_account.js'}));
    //set papersize
    zoom_paper();
    //set app and report globals
    REPORT_GLOBAL.app_copyright = common.COMMON_GLOBAL.app_copyright ?? '';
    for (const parameter of parameters.app) {
        if (parameter['APP_DEFAULT_STARTUP_PAGE'])
            APP_GLOBAL.app_default_startup_page = parseInt(parameter['APP_DEFAULT_STARTUP_PAGE']);
        if (parameter['APP_REPORT_TIMETABLE'])
            APP_GLOBAL.app_report_timetable = parameter['APP_REPORT_TIMETABLE']; 
        if (parameter['REGIONAL_DEFAULT_CALENDAR_LANG'])
            REPORT_GLOBAL.regional_def_calendar_lang = parameter['REGIONAL_DEFAULT_CALENDAR_LANG'];
        if (parameter['REGIONAL_DEFAULT_LOCALE_EXT_PREFIX'])
            REPORT_GLOBAL.regional_def_locale_ext_prefix = parameter['REGIONAL_DEFAULT_LOCALE_EXT_PREFIX'];
        if (parameter['REGIONAL_DEFAULT_LOCALE_EXT_NUMBER_SYSTEM'])
            REPORT_GLOBAL.regional_def_locale_ext_number_system = parameter['REGIONAL_DEFAULT_LOCALE_EXT_NUMBER_SYSTEM'];
        if (parameter['REGIONAL_DEFAULT_LOCALE_EXT_CALENDAR'])
            REPORT_GLOBAL.regional_def_locale_ext_calendar = parameter['REGIONAL_DEFAULT_LOCALE_EXT_CALENDAR'];
        if (parameter['REGIONAL_DEFAULT_CALENDAR_TYPE_GREG'])
            REPORT_GLOBAL.regional_def_calendar_type_greg = parameter['REGIONAL_DEFAULT_CALENDAR_TYPE_GREG'];
        if (parameter['REGIONAL_DEFAULT_CALENDAR_NUMBER_SYSTEM'])
            REPORT_GLOBAL.regional_def_calendar_number_system = parameter['REGIONAL_DEFAULT_CALENDAR_NUMBER_SYSTEM'];
        if (parameter['REGIONAL_DEFAULT_DIRECTION'])
            APP_GLOBAL.regional_default_direction = parameter['REGIONAL_DEFAULT_DIRECTION'];
        if (parameter['REGIONAL_DEFAULT_LOCALE_SECOND'])
            APP_GLOBAL.regional_default_locale_second = parameter['REGIONAL_DEFAULT_LOCALE_SECOND'];
        if (parameter['REGIONAL_DEFAULT_ARABIC_SCRIPT'])
            APP_GLOBAL.regional_default_arabic_script = parameter['REGIONAL_DEFAULT_ARABIC_SCRIPT'];
        if (parameter['REGIONAL_DEFAULT_CALENDARTYPE'])
            APP_GLOBAL.regional_default_calendartype = parameter['REGIONAL_DEFAULT_CALENDARTYPE'];
        if (parameter['REGIONAL_DEFAULT_CALENDAR_HIJRI_TYPE'])
            APP_GLOBAL.regional_default_calendar_hijri_type = parameter['REGIONAL_DEFAULT_CALENDAR_HIJRI_TYPE'];
        if (parameter['GPS_DEFAULT_PLACE_ID'])
            APP_GLOBAL.gps_default_place_id = parseInt(parameter['GPS_DEFAULT_PLACE_ID']);
        if (parameter['GPS_MODULE_LEAFLET_QIBBLA_TITLE'])
            APP_GLOBAL.gps_module_leaflet_qibbla_title = parameter['GPS_MODULE_LEAFLET_QIBBLA_TITLE'];
        if (parameter['GPS_MODULE_LEAFLET_QIBBLA_TEXT_SIZE'])
            APP_GLOBAL.gps_module_leaflet_qibbla_text_size = parseFloat(parameter['GPS_MODULE_LEAFLET_QIBBLA_TEXT_SIZE']);
        if (parameter['GPS_MODULE_LEAFLET_QIBBLA_LAT'])
            APP_GLOBAL.gps_module_leaflet_qibbla_lat = parseFloat(parameter['GPS_MODULE_LEAFLET_QIBBLA_LAT']);
        if (parameter['GPS_MODULE_LEAFLET_QIBBLA_LONG'])
            APP_GLOBAL.gps_module_leaflet_qibbla_long = parseFloat(parameter['GPS_MODULE_LEAFLET_QIBBLA_LONG']);
        if (parameter['GPS_MODULE_LEAFLET_QIBBLA_COLOR'])
            APP_GLOBAL.gps_module_leaflet_qibbla_color = parameter['GPS_MODULE_LEAFLET_QIBBLA_COLOR'];
        if (parameter['GPS_MODULE_LEAFLET_QIBBLA_WIDTH'])
            APP_GLOBAL.gps_module_leaflet_qibbla_width = parseFloat(parameter['GPS_MODULE_LEAFLET_QIBBLA_WIDTH']);
        if (parameter['GPS_MODULE_LEAFLET_QIBBLA_OPACITY'])
            APP_GLOBAL.gps_module_leaflet_qibbla_opacity = parseFloat(parameter['GPS_MODULE_LEAFLET_QIBBLA_OPACITY']);
        if (parameter['GPS_MODULE_LEAFLET_QIBBLA_OLD_TITLE'])
            APP_GLOBAL.gps_module_leaflet_qibbla_old_title = parameter['GPS_MODULE_LEAFLET_QIBBLA_OLD_TITLE'];
        if (parameter['GPS_MODULE_LEAFLET_QIBBLA_OLD_TEXT_SIZE'])
            APP_GLOBAL.gps_module_leaflet_qibbla_old_text_size = parseFloat(parameter['GPS_MODULE_LEAFLET_QIBBLA_OLD_TEXT_SIZE']);
        if (parameter['GPS_MODULE_LEAFLET_QIBBLA_OLD_LAT'])
            APP_GLOBAL.gps_module_leaflet_qibbla_old_lat = parseFloat(parameter['GPS_MODULE_LEAFLET_QIBBLA_OLD_LAT']);
        if (parameter['GPS_MODULE_LEAFLET_QIBBLA_OLD_LONG'])
            APP_GLOBAL.gps_module_leaflet_qibbla_old_long = parseFloat(parameter['GPS_MODULE_LEAFLET_QIBBLA_OLD_LONG']);
        if (parameter['GPS_MODULE_LEAFLET_QIBBLA_OLD_COLOR'])
            APP_GLOBAL.gps_module_leaflet_qibbla_old_color = parameter['GPS_MODULE_LEAFLET_QIBBLA_OLD_COLOR'];
        if (parameter['GPS_MODULE_LEAFLET_QIBBLA_OLD_WIDTH'])
            APP_GLOBAL.gps_module_leaflet_qibbla_old_width = parseFloat(parameter['GPS_MODULE_LEAFLET_QIBBLA_OLD_WIDTH']);
        if (parameter['GPS_MODULE_LEAFLET_QIBBLA_OLD_OPACITY'])
            APP_GLOBAL.gps_module_leaflet_qibbla_old_opacity = parseFloat(parameter['GPS_MODULE_LEAFLET_QIBBLA_OLD_OPACITY']);
        if (parameter['DESIGN_DEFAULT_THEME_DAY'])
            APP_GLOBAL.design_default_theme_day = parameter['DESIGN_DEFAULT_THEME_DAY'];
        if (parameter['DESIGN_DEFAULT_THEME_MONTH'])
            APP_GLOBAL.design_default_theme_month = parameter['DESIGN_DEFAULT_THEME_MONTH'];
        if (parameter['DESIGN_DEFAULT_THEME_YEAR'])
            APP_GLOBAL.design_default_theme_year = parameter['DESIGN_DEFAULT_THEME_YEAR'];
        if (parameter['DESIGN_DEFAULT_PAPERSIZE'])
            APP_GLOBAL.design_default_papersize = parameter['DESIGN_DEFAULT_PAPERSIZE'];
        if (parameter['DESIGN_DEFAULT_HIGHLIGHT_ROW'])
            APP_GLOBAL.design_default_highlight_row = parameter['DESIGN_DEFAULT_HIGHLIGHT_ROW'];
        if (parameter['DESIGN_DEFAULT_SHOW_WEEKDAY'])
            APP_GLOBAL.design_default_show_weekday = (parameter['DESIGN_DEFAULT_SHOW_WEEKDAY']=== 'true');
        if (parameter['DESIGN_DEFAULT_SHOW_CALENDARTYPE'])
            APP_GLOBAL.design_default_show_calendartype = (parameter['DESIGN_DEFAULT_SHOW_CALENDARTYPE']=== 'true');
        if (parameter['DESIGN_DEFAULT_SHOW_NOTES'])
            APP_GLOBAL.design_default_show_notes = (parameter['DESIGN_DEFAULT_SHOW_NOTES']=== 'true');
        if (parameter['DESIGN_DEFAULT_SHOW_GPS'])
            APP_GLOBAL.design_default_show_gps = (parameter['DESIGN_DEFAULT_SHOW_GPS']=== 'true');
        if (parameter['DESIGN_DEFAULT_SHOW_TIMEZONE'])
            APP_GLOBAL.design_default_show_timezone = (parameter['DESIGN_DEFAULT_SHOW_TIMEZONE']=== 'true');
        if (parameter['TEXT_DEFAULT_REPORTTITLE1'])
            APP_GLOBAL.text_default_reporttitle1 = parameter['TEXT_DEFAULT_REPORTTITLE1'];
        if (parameter['TEXT_DEFAULT_REPORTTITLE2'])
            APP_GLOBAL.text_default_reporttitle2 = parameter['TEXT_DEFAULT_REPORTTITLE2'];
        if (parameter['TEXT_DEFAULT_REPORTTITLE3'])
            APP_GLOBAL.text_default_reporttitle3 = parameter['TEXT_DEFAULT_REPORTTITLE3'];
        if (parameter['TEXT_DEFAULT_REPORTFOOTER1'])
            APP_GLOBAL.text_default_reportfooter1 = parameter['TEXT_DEFAULT_REPORTFOOTER1'];
        if (parameter['TEXT_DEFAULT_REPORTFOOTER2'])
            APP_GLOBAL.text_default_reportfooter2 = parameter['TEXT_DEFAULT_REPORTFOOTER2'];
        if (parameter['TEXT_DEFAULT_REPORTFOOTER3'])
            APP_GLOBAL.text_default_reportfooter3 = parameter['TEXT_DEFAULT_REPORTFOOTER3'];
        if (parameter['IMAGE_HEADER_FOOTER_WIDTH'])
            APP_GLOBAL.image_header_footer_width = parameter['IMAGE_HEADER_FOOTER_WIDTH'];
        if (parameter['IMAGE_HEADER_FOOTER_HEIGHT'])
            APP_GLOBAL.image_header_footer_height = parameter['IMAGE_HEADER_FOOTER_HEIGHT'];
        if (parameter['IMAGE_DEFAULT_REPORT_HEADER_SRC']){
            if (parameter['IMAGE_DEFAULT_REPORT_HEADER_SRC']!='')
                APP_GLOBAL.image_default_report_header_src = parameter['IMAGE_DEFAULT_REPORT_HEADER_SRC'];
        }                    
        if (parameter['IMAGE_DEFAULT_REPORT_FOOTER_SRC']){
            if (parameter['IMAGE_DEFAULT_REPORT_FOOTER_SRC']!='')
                APP_GLOBAL.image_default_report_footer_src = parameter['IMAGE_DEFAULT_REPORT_FOOTER_SRC'];
        }                             
        if (parameter['PRAYER_DEFAULT_METHOD'])
            APP_GLOBAL.prayer_default_method = parameter['PRAYER_DEFAULT_METHOD'];
        if (parameter['PRAYER_DEFAULT_ASR'])
            APP_GLOBAL.prayer_default_asr = parameter['PRAYER_DEFAULT_ASR'];
        if (parameter['PRAYER_DEFAULT_HIGHLATITUDE'])
            APP_GLOBAL.prayer_default_highlatitude = parameter['PRAYER_DEFAULT_HIGHLATITUDE'];
        if (parameter['PRAYER_DEFAULT_TIMEFORMAT'])
            APP_GLOBAL.prayer_default_timeformat = parameter['PRAYER_DEFAULT_TIMEFORMAT'];
        if (parameter['PRAYER_DEFAULT_HIJRI_ADJUSTMENT'])
            APP_GLOBAL.prayer_default_hijri_adjustment = parameter['PRAYER_DEFAULT_HIJRI_ADJUSTMENT'];
        if (parameter['PRAYER_DEFAULT_IQAMAT_TITLE_FAJR'])
            APP_GLOBAL.prayer_default_iqamat_title_fajr = parameter['PRAYER_DEFAULT_IQAMAT_TITLE_FAJR'];
        if (parameter['PRAYER_DEFAULT_IQAMAT_TITLE_DHUHR'])
            APP_GLOBAL.prayer_default_iqamat_title_dhuhr = parameter['PRAYER_DEFAULT_IQAMAT_TITLE_DHUHR'];
        if (parameter['PRAYER_DEFAULT_IQAMAT_TITLE_ASR'])
            APP_GLOBAL.prayer_default_iqamat_title_asr = parameter['PRAYER_DEFAULT_IQAMAT_TITLE_ASR'];
        if (parameter['PRAYER_DEFAULT_IQAMAT_TITLE_MAGHRIB'])
            APP_GLOBAL.prayer_default_iqamat_title_maghrib = parameter['PRAYER_DEFAULT_IQAMAT_TITLE_MAGHRIB'];
        if (parameter['PRAYER_DEFAULT_IQAMAT_TITLE_ISHA'])
            APP_GLOBAL.prayer_default_iqamat_title_isha = parameter['PRAYER_DEFAULT_IQAMAT_TITLE_ISHA'];
        if (parameter['PRAYER_DEFAULT_SHOW_IMSAK'])
            APP_GLOBAL.prayer_default_show_imsak = (parameter['PRAYER_DEFAULT_SHOW_IMSAK']=== 'true');
        if (parameter['PRAYER_DEFAULT_SHOW_SUNSET'])
            APP_GLOBAL.prayer_default_show_sunset = (parameter['PRAYER_DEFAULT_SHOW_SUNSET']=== 'true');
        if (parameter['PRAYER_DEFAULT_SHOW_MIDNIGHT'])
            APP_GLOBAL.prayer_default_show_midnight = (parameter['PRAYER_DEFAULT_SHOW_MIDNIGHT']=== 'true');
        if (parameter['PRAYER_DEFAULT_SHOW_FAST_START_END'])
            APP_GLOBAL.prayer_default_show_fast_start_end = parseInt(parameter['PRAYER_DEFAULT_SHOW_FAST_START_END']);
        if (parameter['MODULE_EASY.QRCODE_WIDTH'])
            common.COMMON_GLOBAL['module_easy.qrcode_width'] = parseInt(parameter['MODULE_EASY.QRCODE_WIDTH']);
        if (parameter['MODULE_EASY.QRCODE_HEIGHT'])
            common.COMMON_GLOBAL['module_easy.qrcode_height'] = parseInt(parameter['MODULE_EASY.QRCODE_HEIGHT']);
        if (parameter['MODULE_EASY.QRCODE_COLOR_DARK'])
            common.COMMON_GLOBAL['module_easy.qrcode_color_dark'] = parameter['MODULE_EASY.QRCODE_COLOR_DARK'];
        if (parameter['MODULE_EASY.QRCODE_COLOR_LIGHT'])
            common.COMMON_GLOBAL['module_easy.qrcode_color_light'] = parameter['MODULE_EASY.QRCODE_COLOR_LIGHT'];
    }

    //set current date for report month
    //if client_timezone is set, set Date with client_timezone
    if (common.COMMON_GLOBAL.client_timezone)
        REPORT_GLOBAL.session_currentDate = common.commonTimezoneDate(common.COMMON_GLOBAL.client_timezone);
    else
        REPORT_GLOBAL.session_currentDate = new Date();
    REPORT_GLOBAL.session_currentHijriDate = [0,0];
    //get Hijri date from initial Gregorian date
    REPORT_GLOBAL.session_currentHijriDate[0] = parseInt(new Date(REPORT_GLOBAL.session_currentDate.getFullYear(),
        REPORT_GLOBAL.session_currentDate.getMonth(),
        REPORT_GLOBAL.session_currentDate.getDate()).toLocaleDateString('en-us-u-ca-islamic', { month: 'numeric' }));
    REPORT_GLOBAL.session_currentHijriDate[1] = parseInt(new Date(REPORT_GLOBAL.session_currentDate.getFullYear(),
        REPORT_GLOBAL.session_currentDate.getMonth(),
        REPORT_GLOBAL.session_currentDate.getDate()).toLocaleDateString('en-us-u-ca-islamic', { year: 'numeric' }));

    //show dialogue about using mobile and scan QR code after 5 seconds
    common.commonWindowSetTimeout(() => {show_dialogue('SCAN');}, 5000);
    set_default_settings().then(() => {
        const show_start = async () => {
            //show default startup
            await toolbar_button(APP_GLOBAL.app_default_startup_page);
            const user = common.commonWndowLocationPathname(1);
            if (user !='') {
                //show profile for user entered in url
                common.commonProfileShow(null, user);
            }
        };
        show_start().then(() => {
            common.commonWindowServiceWorker();
            framework_set();
        });
    });
};
/**
 * 
 * @param {string} parameters 
 * @returns {void}
 */
const init = parameters => {
    COMMON_DOCUMENT.body.className = 'app_theme1';
    common.COMMON_GLOBAL.app_function_exception = app_exception;
    common.COMMON_GLOBAL.app_function_session_expired = user_logout_app;
    common.commonInit(parameters).then((/**@type{{ app:{}[], app_service:{system_admin_only:number, first_time:number}}}*/decodedparameters)=>{
        init_app(decodedparameters);
    });
};
export{ init, component_setting_update};</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">App Portolio</a></h2><h3>Modules</h3><ul><li><a href="module-apps_admin_admin.html">apps/admin/admin</a></li><li><a href="module-apps_admin_component_admin_secure.html">apps/admin/component/admin_secure</a></li><li><a href="module-apps_admin_component_app.html">apps/admin/component/app</a></li><li><a href="module-apps_admin_component_dialogue_send_broadcast.html">apps/admin/component/dialogue_send_broadcast</a></li><li><a href="module-apps_admin_component_menu_apps.html">apps/admin/component/menu_apps</a></li><li><a href="module-apps_admin_component_menu_apps_parameters.html">apps/admin/component/menu_apps_parameters</a></li><li><a href="module-apps_admin_component_menu_config.html">apps/admin/component/menu_config</a></li><li><a href="module-apps_admin_component_menu_config_detail.html">apps/admin/component/menu_config_detail</a></li><li><a href="module-apps_admin_component_menu_db_info.html">apps/admin/component/menu_db_info</a></li><li><a href="module-apps_admin_component_menu_installation.html">apps/admin/component/menu_installation</a></li><li><a href="module-apps_admin_component_menu_monitor.html">apps/admin/component/menu_monitor</a></li><li><a href="module-apps_admin_component_menu_monitor_detail.html">apps/admin/component/menu_monitor_detail</a></li><li><a href="module-apps_admin_component_menu_monitor_detail_server_log.html">apps/admin/component/menu_monitor_detail_server_log</a></li><li><a href="module-apps_admin_component_menu_server.html">apps/admin/component/menu_server</a></li><li><a href="module-apps_admin_component_menu_start.html">apps/admin/component/menu_start</a></li><li><a href="module-apps_admin_component_menu_start_chart.html">apps/admin/component/menu_start_chart</a></li><li><a href="module-apps_admin_component_menu_user_stat.html">apps/admin/component/menu_user_stat</a></li><li><a href="module-apps_admin_component_menu_users.html">apps/admin/component/menu_users</a></li><li><a href="module-apps_admin_component_menu_users_list.html">apps/admin/component/menu_users_list</a></li><li><a href="module-apps_admin_component_menu_users_logon.html">apps/admin/component/menu_users_logon</a></li><li><a href="module-apps_admin_secure.html">apps/admin/secure</a></li><li><a href="module-apps_app1_app.html">apps/app1/app</a></li><li><a href="module-apps_app1_component_app.html">apps/app1/component/app</a></li><li><a href="module-apps_app1_component_app_theme.html">apps/app1/component/app_theme</a></li><li><a href="module-apps_app2_app.html">apps/app2/app</a></li><li><a href="module-apps_app2_app_types.html">apps/app2/app/types</a></li><li><a href="module-apps_app2_component_app.html">apps/app2/component/app</a></li><li><a href="module-apps_app2_component_dialogue_info.html">apps/app2/component/dialogue_info</a></li><li><a href="module-apps_app2_component_dialogue_scan_open_mobile.html">apps/app2/component/dialogue_scan_open_mobile</a></li><li><a href="module-apps_app2_component_print.html">apps/app2/component/print</a></li><li><a href="module-apps_app2_component_profile_info.html">apps/app2/component/profile_info</a></li><li><a href="module-apps_app2_component_profile_stat.html">apps/app2/component/profile_stat</a></li><li><a href="module-apps_app2_component_settings_tab1.html">apps/app2/component/settings_tab1</a></li><li><a href="module-apps_app2_component_settings_tab2.html">apps/app2/component/settings_tab2</a></li><li><a href="module-apps_app2_component_settings_tab3.html">apps/app2/component/settings_tab3</a></li><li><a href="module-apps_app2_component_settings_tab4.html">apps/app2/component/settings_tab4</a></li><li><a href="module-apps_app2_component_settings_tab5.html">apps/app2/component/settings_tab5</a></li><li><a href="module-apps_app2_component_settings_tab6.html">apps/app2/component/settings_tab6</a></li><li><a href="module-apps_app2_component_settings_tab7.html">apps/app2/component/settings_tab7</a></li><li><a href="module-apps_app2_component_settings_tab_nav_7.html">apps/app2/component/settings_tab_nav_7</a></li><li><a href="module-apps_app2_report_lib_timetable.html">apps/app2/report/lib_timetable</a></li><li><a href="module-apps_app2_src_modules_module_timetable_lib.html">apps/app2/src/modules/module_timetable_lib</a></li><li><a href="module-apps_app2_src_report_timetable.html">apps/app2/src/report/timetable</a></li><li><a href="module-apps_app2_src_types.html">apps/app2/src/types</a></li><li><a href="module-apps_app2_sw.html">apps/app2/sw</a></li><li><a href="module-apps_app3_app.html">apps/app3/app</a></li><li><a href="module-apps_app3_component_app.html">apps/app3/component/app</a></li><li><a href="module-apps_app3_component_docs.html">apps/app3/component/docs</a></li><li><a href="module-apps_app4_app.html">apps/app4/app</a></li><li><a href="module-apps_app4_component_app.html">apps/app4/component/app</a></li><li><a href="module-apps_app5_app.html">apps/app5/app</a></li><li><a href="module-apps_app5_component_app.html">apps/app5/component/app</a></li><li><a href="module-apps_app5_component_page_secure.html">apps/app5/component/page_secure</a></li><li><a href="module-apps_app5_component_page_start.html">apps/app5/component/page_start</a></li><li><a href="module-apps_app5_src_functions_account_create.html">apps/app5/src/functions/account_create</a></li><li><a href="module-apps_app5_src_functions_account_get.html">apps/app5/src/functions/account_get</a></li><li><a href="module-apps_app5_src_functions_account_metadata.html">apps/app5/src/functions/account_metadata</a></li><li><a href="module-apps_app5_src_functions_account_statement.html">apps/app5/src/functions/account_statement</a></li><li><a href="module-apps_app5_src_functions_account_transactions.html">apps/app5/src/functions/account_transactions</a></li><li><a href="module-apps_app5_src_functions_customer_create.html">apps/app5/src/functions/customer_create</a></li><li><a href="module-apps_app5_src_functions_customer_get.html">apps/app5/src/functions/customer_get</a></li><li><a href="module-apps_app5_src_functions_customer_metadata.html">apps/app5/src/functions/customer_metadata</a></li><li><a href="module-apps_app5_src_functions_payment_request_create.html">apps/app5/src/functions/payment_request_create</a></li><li><a href="module-apps_app5_src_functions_payment_request_get.html">apps/app5/src/functions/payment_request_get</a></li><li><a href="module-apps_app5_src_functions_payment_request_get_status.html">apps/app5/src/functions/payment_request_get_status</a></li><li><a href="module-apps_app5_src_functions_payment_request_metadata.html">apps/app5/src/functions/payment_request_metadata</a></li><li><a href="module-apps_app5_src_functions_payment_request_update.html">apps/app5/src/functions/payment_request_update</a></li><li><a href="module-apps_app5_src_functions_transaction_metadata.html">apps/app5/src/functions/transaction_metadata</a></li><li><a href="module-apps_app6_app.html">apps/app6/app</a></li><li><a href="module-apps_app6_component_app.html">apps/app6/component/app</a></li><li><a href="module-apps_app6_component_page_start.html">apps/app6/component/page_start</a></li><li><a href="module-apps_app6_src_functions_payment_metadata.html">apps/app6/src/functions/payment_metadata</a></li><li><a href="module-apps_app6_src_functions_payment_request_create.html">apps/app6/src/functions/payment_request_create</a></li><li><a href="module-apps_app6_src_functions_payment_request_get_status.html">apps/app6/src/functions/payment_request_get_status</a></li><li><a href="module-apps_app6_src_functions_payment_request_metadata.html">apps/app6/src/functions/payment_request_metadata</a></li><li><a href="module-apps_app6_src_functions_product_get.html">apps/app6/src/functions/product_get</a></li><li><a href="module-apps_app6_src_functions_product_location_get.html">apps/app6/src/functions/product_location_get</a></li><li><a href="module-apps_app6_src_functions_product_metadata.html">apps/app6/src/functions/product_metadata</a></li><li><a href="module-apps_app6_src_functions_product_variant_location_metadata.html">apps/app6/src/functions/product_variant_location_metadata</a></li><li><a href="module-apps_app7_app.html">apps/app7/app</a></li><li><a href="module-apps_app7_app_types.html">apps/app7/app/types</a></li><li><a href="module-apps_app7_component_app.html">apps/app7/component/app</a></li><li><a href="module-apps_app7_component_cube.html">apps/app7/component/cube</a></li><li><a href="module-apps_app7_component_cube_lib.html">apps/app7/component/cube_lib</a></li><li><a href="module-apps_app7_src_functions_solve.html">apps/app7/src/functions/solve</a></li><li><a href="module-apps_app7_src_functions_solver1.html">apps/app7/src/functions/solver1</a></li><li><a href="module-apps_app7_src_functions_solver1_algorithms.html">apps/app7/src/functions/solver1/algorithms</a></li><li><a href="module-apps_app7_src_functions_solver1_coordinates.html">apps/app7/src/functions/solver1/coordinates</a></li><li><a href="module-apps_app7_src_functions_solver1_cube.html">apps/app7/src/functions/solver1/cube</a></li><li><a href="module-apps_app7_src_functions_solver1_movetable.html">apps/app7/src/functions/solver1/movetable</a></li><li><a href="module-apps_app7_src_functions_solver1_pruningtable.html">apps/app7/src/functions/solver1/pruningtable</a></li><li><a href="module-apps_app7_src_functions_solver1_scramblers_2gll.html">apps/app7/src/functions/solver1/scramblers/2gll</a></li><li><a href="module-apps_app7_src_functions_solver1_scramblers_3x3.html">apps/app7/src/functions/solver1/scramblers/3x3</a></li><li><a href="module-apps_app7_src_functions_solver1_scramblers_cmll.html">apps/app7/src/functions/solver1/scramblers/cmll</a></li><li><a href="module-apps_app7_src_functions_solver1_scramblers_corners.html">apps/app7/src/functions/solver1/scramblers/corners</a></li><li><a href="module-apps_app7_src_functions_solver1_scramblers_edges.html">apps/app7/src/functions/solver1/scramblers/edges</a></li><li><a href="module-apps_app7_src_functions_solver1_scramblers_lse.html">apps/app7/src/functions/solver1/scramblers/lse</a></li><li><a href="module-apps_app7_src_functions_solver1_scramblers_lsll.html">apps/app7/src/functions/solver1/scramblers/lsll</a></li><li><a href="module-apps_app7_src_functions_solver1_scramblers_pll.html">apps/app7/src/functions/solver1/scramblers/pll</a></li><li><a href="module-apps_app7_src_functions_solver1_scramblers_scramblepieces.html">apps/app7/src/functions/solver1/scramblers/scramblepieces</a></li><li><a href="module-apps_app7_src_functions_solver1_scramblers_zbll.html">apps/app7/src/functions/solver1/scramblers/zbll</a></li><li><a href="module-apps_app7_src_functions_solver1_scramblers_zzls.html">apps/app7/src/functions/solver1/scramblers/zzls</a></li><li><a href="module-apps_app7_src_functions_solver1_search.html">apps/app7/src/functions/solver1/search</a></li><li><a href="module-apps_app7_src_functions_solver1_solvers_crosssolver.html">apps/app7/src/functions/solver1/solvers/crosssolver</a></li><li><a href="module-apps_app7_src_functions_solver1_solvers_eolinesolver.html">apps/app7/src/functions/solver1/solvers/eolinesolver</a></li><li><a href="module-apps_app7_src_functions_solver1_solvers_firstblocksolver.html">apps/app7/src/functions/solver1/solvers/firstblocksolver</a></li><li><a href="module-apps_app7_src_functions_solver1_solvers_kociemba.html">apps/app7/src/functions/solver1/solvers/kociemba</a></li><li><a href="module-apps_app7_src_functions_solver1_solvers_xcrosssolver.html">apps/app7/src/functions/solver1/solvers/xcrosssolver</a></li><li><a href="module-apps_app7_src_functions_solver1_tools.html">apps/app7/src/functions/solver1/tools</a></li><li><a href="module-apps_app7_src_functions_solver1_worker.html">apps/app7/src/functions/solver1/worker</a></li><li><a href="module-apps_app7_src_functions_solver2.html">apps/app7/src/functions/solver2</a></li><li><a href="module-apps_app7_src_functions_solver3.html">apps/app7/src/functions/solver3</a></li><li><a href="module-apps_app7_src_functions_solver3_algorithm-shortener.html">apps/app7/src/functions/solver3/algorithm-shortener</a></li><li><a href="module-apps_app7_src_functions_solver3_models_cube.html">apps/app7/src/functions/solver3/models/cube</a></li><li><a href="module-apps_app7_src_functions_solver3_models_face.html">apps/app7/src/functions/solver3/models/face</a></li><li><a href="module-apps_app7_src_functions_solver3_models_rubikscube.html">apps/app7/src/functions/solver3/models/rubikscube</a></li><li><a href="module-apps_app7_src_functions_solver3_models_vector.html">apps/app7/src/functions/solver3/models/vector</a></li><li><a href="module-apps_app7_src_functions_solver3_module_combiner.html">apps/app7/src/functions/solver3/module/combiner</a></li><li><a href="module-apps_app7_src_functions_solver3_module_gl-vec3.html">apps/app7/src/functions/solver3/module/gl-vec3</a></li><li><a href="module-apps_app7_src_functions_solver3_solvers_basesolver.html">apps/app7/src/functions/solver3/solvers/basesolver</a></li><li><a href="module-apps_app7_src_functions_solver3_solvers_cross.html">apps/app7/src/functions/solver3/solvers/cross</a></li><li><a href="module-apps_app7_src_functions_solver3_solvers_f2l.html">apps/app7/src/functions/solver3/solvers/f2l</a></li><li><a href="module-apps_app7_src_functions_solver3_solvers_oll.html">apps/app7/src/functions/solver3/solvers/oll</a></li><li><a href="module-apps_app7_src_functions_solver3_solvers_pll.html">apps/app7/src/functions/solver3/solvers/pll</a></li><li><a href="module-apps_app7_src_functions_solver3_utils.html">apps/app7/src/functions/solver3/utils</a></li><li><a href="module-apps_app7_src_types.html">apps/app7/src/types</a></li><li><a href="module-apps_common_common.html">apps/common/common</a></li><li><a href="module-apps_common_component_common_app.html">apps/common/component/common_app</a></li><li><a href="module-apps_common_component_common_app_data_display.html">apps/common/component/common_app_data_display</a></li><li><a href="module-apps_common_component_common_broadcast.html">apps/common/component/common_broadcast</a></li><li><a href="module-apps_common_component_common_construction.html">apps/common/component/common_construction</a></li><li><a href="module-apps_common_component_common_dialogue_apps.html">apps/common/component/common_dialogue_apps</a></li><li><a href="module-apps_common_component_common_dialogue_lov.html">apps/common/component/common_dialogue_lov</a></li><li><a href="module-apps_common_component_common_dialogue_maintenance.html">apps/common/component/common_dialogue_maintenance</a></li><li><a href="module-apps_common_component_common_dialogue_message.html">apps/common/component/common_dialogue_message</a></li><li><a href="module-apps_common_component_common_dialogue_profile.html">apps/common/component/common_dialogue_profile</a></li><li><a href="module-apps_common_component_common_dialogue_profile_info.html">apps/common/component/common_dialogue_profile_info</a></li><li><a href="module-apps_common_component_common_dialogue_profile_info_detail.html">apps/common/component/common_dialogue_profile_info_detail</a></li><li><a href="module-apps_common_component_common_dialogue_profile_stat.html">apps/common/component/common_dialogue_profile_stat</a></li><li><a href="module-apps_common_component_common_dialogue_profile_stat_list.html">apps/common/component/common_dialogue_profile_stat_list</a></li><li><a href="module-apps_common_component_common_dialogue_user_edit.html">apps/common/component/common_dialogue_user_edit</a></li><li><a href="module-apps_common_component_common_dialogue_user_menu.html">apps/common/component/common_dialogue_user_menu</a></li><li><a href="module-apps_common_component_common_dialogue_user_menu_app_theme.html">apps/common/component/common_dialogue_user_menu_app_theme</a></li><li><a href="module-apps_common_component_common_dialogue_user_password_new.html">apps/common/component/common_dialogue_user_password_new</a></li><li><a href="module-apps_common_component_common_dialogue_user_start.html">apps/common/component/common_dialogue_user_start</a></li><li><a href="module-apps_common_component_common_dialogue_user_verify.html">apps/common/component/common_dialogue_user_verify</a></li><li><a href="module-apps_common_component_common_module_leaflet.html">apps/common/component/common_module_leaflet</a></li><li><a href="module-apps_common_component_common_module_leaflet_control.html">apps/common/component/common_module_leaflet_control</a></li><li><a href="module-apps_common_component_common_module_leaflet_popup.html">apps/common/component/common_module_leaflet_popup</a></li><li><a href="module-apps_common_component_common_module_leaflet_search_city.html">apps/common/component/common_module_leaflet_search_city</a></li><li><a href="module-apps_common_component_common_profile_search.html">apps/common/component/common_profile_search</a></li><li><a href="module-apps_common_component_common_profile_search_list.html">apps/common/component/common_profile_search_list</a></li><li><a href="module-apps_common_component_common_profile_toolbar.html">apps/common/component/common_profile_toolbar</a></li><li><a href="module-apps_common_component_common_select.html">apps/common/component/common_select</a></li><li><a href="module-apps_common_component_common_user_account.html">apps/common/component/common_user_account</a></li><li><a href="module-apps_common_component_common_window_info.html">apps/common/component/common_window_info</a></li><li><a href="module-apps_common_maintenance.html">apps/common/maintenance</a></li><li><a href="module-apps_common_src_common.html">apps/common/src/common</a></li><li><a href="module-apps_common_src_common_service.html">apps/common/src/common/service</a></li><li><a href="module-apps_common_src_component_common_info_disclaimer.html">apps/common/src/component/common_info_disclaimer</a></li><li><a href="module-apps_common_src_component_common_mail.html">apps/common/src/component/common_mail</a></li><li><a href="module-apps_common_src_component_common_maintenance.html">apps/common/src/component/common_maintenance</a></li><li><a href="module-apps_common_src_component_common_report.html">apps/common/src/component/common_report</a></li><li><a href="module-apps_common_src_component_common_server_error.html">apps/common/src/component/common_server_error</a></li><li><a href="module-apps_common_src_functions_common_country.html">apps/common/src/functions/common_country</a></li><li><a href="module-apps_common_src_functions_common_locale.html">apps/common/src/functions/common_locale</a></li><li><a href="module-apps_default_NONPWA_app.html">apps/default_NONPWA/app</a></li><li><a href="module-apps_default_NONPWA_component_app.html">apps/default_NONPWA/component/app</a></li><li><a href="module-apps_default_PWA_app.html">apps/default_PWA/app</a></li><li><a href="module-apps_default_PWA_component_app.html">apps/default_PWA/component/app</a></li><li><a href="module-apps_default_PWA_sw.html">apps/default_PWA/sw</a></li><li><a href="module-apps_types.html">apps/types</a></li><li><a href="module-microservice.html">microservice</a></li><li><a href="module-microservice_batch_server.html">microservice/batch/server</a></li><li><a href="module-microservice_batch_service.html">microservice/batch/service</a></li><li><a href="module-microservice_cirtcuitbreaker.html">microservice/cirtcuitbreaker</a></li><li><a href="module-microservice_geolocation_server.html">microservice/geolocation/server</a></li><li><a href="module-microservice_geolocation_service.html">microservice/geolocation/service</a></li><li><a href="module-microservice_mail_server.html">microservice/mail/server</a></li><li><a href="module-microservice_mail_service.html">microservice/mail/service</a></li><li><a href="module-microservice_messagequeue.html">microservice/messagequeue</a></li><li><a href="module-microservice_registry.html">microservice/registry</a></li><li><a href="module-microservice_worldcities_server.html">microservice/worldcities/server</a></li><li><a href="module-microservice_worldcities_service.html">microservice/worldcities/service</a></li><li><a href="module-server_apps.html">server/apps</a></li><li><a href="module-server_bff.html">server/bff</a></li><li><a href="module-server_bff_service.html">server/bff/service</a></li><li><a href="module-server_config.html">server/config</a></li><li><a href="module-server_config_service.html">server/config/service</a></li><li><a href="module-server_db_common.html">server/db/common</a></li><li><a href="module-server_db_components_app.html">server/db/components/app</a></li><li><a href="module-server_db_components_app_category.html">server/db/components/app_category</a></li><li><a href="module-server_db_components_app_data_entity.html">server/db/components/app_data_entity</a></li><li><a href="module-server_db_components_app_data_resource.html">server/db/components/app_data_resource</a></li><li><a href="module-server_db_components_app_data_stat.html">server/db/components/app_data_stat</a></li><li><a href="module-server_db_components_app_role.html">server/db/components/app_role</a></li><li><a href="module-server_db_components_app_setting.html">server/db/components/app_setting</a></li><li><a href="module-server_db_components_database.html">server/db/components/database</a></li><li><a href="module-server_db_components_identity_provider.html">server/db/components/identity_provider</a></li><li><a href="module-server_db_components_user_account.html">server/db/components/user_account</a></li><li><a href="module-server_db_components_user_account_app.html">server/db/components/user_account_app</a></li><li><a href="module-server_db_components_user_account_app_data_post.html">server/db/components/user_account_app_data_post</a></li><li><a href="module-server_db_db.html">server/db/db</a></li><li><a href="module-server_db_file.html">server/db/file</a></li><li><a href="module-server_db_sql_app.html">server/db/sql/app</a></li><li><a href="module-server_db_sql_app_category.html">server/db/sql/app_category</a></li><li><a href="module-server_db_sql_app_data_entity.html">server/db/sql/app_data_entity</a></li><li><a href="module-server_db_sql_app_data_entity_resource.html">server/db/sql/app_data_entity_resource</a></li><li><a href="module-server_db_sql_app_data_resource_detail.html">server/db/sql/app_data_resource_detail</a></li><li><a href="module-server_db_sql_app_data_resource_detail_data.html">server/db/sql/app_data_resource_detail_data</a></li><li><a href="module-server_db_sql_app_data_resource_master.html">server/db/sql/app_data_resource_master</a></li><li><a href="module-server_db_sql_app_data_stat.html">server/db/sql/app_data_stat</a></li><li><a href="module-server_db_sql_app_role.html">server/db/sql/app_role</a></li><li><a href="module-server_db_sql_app_setting.html">server/db/sql/app_setting</a></li><li><a href="module-server_db_sql_database.html">server/db/sql/database</a></li><li><a href="module-server_db_sql_identity_provider.html">server/db/sql/identity_provider</a></li><li><a href="module-server_db_sql_user_account.html">server/db/sql/user_account</a></li><li><a href="module-server_db_sql_user_account_app.html">server/db/sql/user_account_app</a></li><li><a href="module-server_db_sql_user_account_app_data_post.html">server/db/sql/user_account_app_data_post</a></li><li><a href="module-server_db_sql_user_account_app_data_post_like.html">server/db/sql/user_account_app_data_post_like</a></li><li><a href="module-server_db_sql_user_account_app_data_post_view.html">server/db/sql/user_account_app_data_post_view</a></li><li><a href="module-server_db_sql_user_account_event.html">server/db/sql/user_account_event</a></li><li><a href="module-server_db_sql_user_account_follow.html">server/db/sql/user_account_follow</a></li><li><a href="module-server_db_sql_user_account_like.html">server/db/sql/user_account_like</a></li><li><a href="module-server_db_sql_user_account_logon.html">server/db/sql/user_account_logon</a></li><li><a href="module-server_db_sql_user_account_view.html">server/db/sql/user_account_view</a></li><li><a href="module-server_iam.html">server/iam</a></li><li><a href="module-server_iam_service.html">server/iam/service</a></li><li><a href="module-server_info.html">server/info</a></li><li><a href="module-server_info_service.html">server/info/service</a></li><li><a href="module-server_log.html">server/log</a></li><li><a href="module-server_log_service.html">server/log/service</a></li><li><a href="module-server_security_service.html">server/security/service</a></li><li><a href="module-server_server.html">server/server</a></li><li><a href="module-server_server_service.html">server/server/service</a></li><li><a href="module-server_socket.html">server/socket</a></li><li><a href="module-server_socket_service.html">server/socket/service</a></li><li><a href="module-server_types.html">server/types</a></li><li><a href="module-test.html">test</a></li></ul><h3>Classes</h3><ul><li><a href="module-apps_app2_report_lib_timetable-PrayTimes.html">PrayTimes</a></li><li><a href="module-apps_app7_src_functions_solver1_pruningtable-PruningTable.html">PruningTable</a></li><li><a href="module-apps_app7_src_functions_solver1_search-Search.html">Search</a></li><li><a href="module-apps_app7_src_functions_solver1_solvers_kociemba-PhaseOneSearch.html">PhaseOneSearch</a></li><li><a href="module-apps_app7_src_functions_solver3_models_cube-Cubie.html">Cubie</a></li><li><a href="module-apps_app7_src_functions_solver3_models_face-Face.html">Face</a></li><li><a href="module-apps_app7_src_functions_solver3_models_rubikscube-RubiksCube.html">RubiksCube</a></li><li><a href="module-apps_app7_src_functions_solver3_models_vector-Vector.html">Vector</a></li><li><a href="module-apps_app7_src_functions_solver3_solvers_basesolver-BaseSolver.html">BaseSolver</a></li><li><a href="module-apps_app7_src_functions_solver3_solvers_f2l-Case1Solver.html">Case1Solver</a></li><li><a href="module-apps_app7_src_functions_solver3_solvers_f2l-Case2Solver.html">Case2Solver</a></li><li><a href="module-apps_app7_src_functions_solver3_solvers_f2l-Case3Solver.html">Case3Solver</a></li><li><a href="module-apps_app7_src_functions_solver3-Solver.html">Solver</a></li><li><a href="module-microservice_cirtcuitbreaker-CircuitBreaker.html">CircuitBreaker</a></li></ul><h3><a href="global.html">Global</a></h3>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.3</a>
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
