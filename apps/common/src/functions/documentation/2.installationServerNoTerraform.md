# Installation environments without Terrraform

> **Note:** SKIP if using Terrraform

## Azure
1. Create Linux Virtual Machine (VM)

2. Network settings

| Add inbound rules      |                                    |
| :--------------------- | :--------------------------------- |
| Choose service HTTP    | (port 80)                          |

| Add inbound rules      |                                    | 
| :--------------------- | :--------------------------------- |
| Choose service HTTPS   | (port 443)                         |

| Add inbound rules      |                                    |
| :--------------------- | :--------------------------------- |
| Choose service HTTP    | (port 3333)                        |

3. Connect to Linux VM from localhost from command prompt:

```
ssh -i $HOME/.ssh/[KEY_FILE] [azureuser]@[IP ADDRESS]
```

## Oracle Cloud
1. Create Linux Virtual Machine (VM)

2. Security list

| Add ingress rules      |                                    | 
| :--------------------- | :--------------------------------- |
| source                 | 0.0.0.0/0                          |
| destination port       | 80                                 |
| description            | HTTP                               |

| Add ingress rules      |                                    | 
| :--------------------- | :--------------------------------- |
| source                 | 0.0.0.0/0                          |
| destination port       | 443                                |
| description            | HTTPS not used but browser hangs if not enabled |

| Add ingress rules      |                                    | 
| :--------------------- | :--------------------------------- |
| source                 | 0.0.0.0/0                          |
| destination port       | 3333                               |
| description            | HTTP Admin                         |

3. Connect to Linux VM from localhost for example from command prompt:

```
ssh -i $HOME/.ssh/[KEY_FILE] [user]@[IP ADDRESS]
```

## Installation
```
sudo apt update -y
sudo apt upgrade -y
sudo apt install -y git vim inetutils-ping net-tools ufw
sudo ufw allow 22/tcp
sudo ufw allow 80/tcp
sudo ufw allow 443/tcp
sudo ufw allow 3333/tcp
sudo ufw --force enable
sudo apt remove --purge -y update-notifier-common
sudo apt remove --purge -y ubuntu-release-upgrader-core
sudo apt remove --purge -y popularity-contest
sudo apt remove --purge -y apport
sudo apt remove --purge -y whoopsie
sudo apt remove --purge -y friendly-recovery
sudo apt remove --purge -y command-not-found
sudo apt remove --purge -y man-db
sudo apt remove --purge -y vim-tiny
sudo apt remove --purge -y nano
sudo apt remove --purge -y rsyslog
sudo apt -y autoremove --purge
sudo -i -u ubuntu mkdir node
sudo -i -u ubuntu wget https://nodejs.org/dist/v20.20.0/node-v20.20.0-linux-x64.tar.xz
sudo -i -u ubuntu tar -xJf node-v20.20.0-linux-x64.tar.xz -C node --strip-components=1
sudo -i -u ubuntu echo 'export PATH="$PATH:$HOME/node/bin"' >> ~/.bashrc
sudo setcap CAP_NET_BIND_SERVICE=+eip /home/ubuntu/node/bin/node
sudo -i -u ubuntu git clone ${var.git_repository_url} app_portfolio
sudo systemctl enable /home/ubuntu/app_portfolio/server/scripts/app_portfolio.service
sudo systemctl enable /home/ubuntu/app_portfolio/server/scripts/app_portfolio_microservice_batch.service
sudo systemctl daemon-reload
//start first time manually so environment is set, parameters: [ENVIRONMENT] [HOST/IP] [APP_PORT] [ADMIN_PORT], example:
sudo -u ubuntu bash -c 'cd /home/ubuntu/app_portfolio && /usr/bin/node server/init.js TEST localhost 80 3333
//after a second or more depending hardware, configuration is created, reboot, services enabled before will automatically start
sudo reboot
```     
After reboot set admin name and password:

`http://[HOST/IP]:3333`

alternative Git installation that copies all branches:

```
cd $HOME
git clone --bare [repository .git url] .git
git config --bool core.bare false
git reset --hard
git branch
```     