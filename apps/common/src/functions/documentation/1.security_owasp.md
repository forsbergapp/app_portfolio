# Security OWASP

App Portfolio implements OWASP Application Security Verification Standard (ASVS) v 5.0.0.
Chapter separated tables show all v5.0.0 requirements with level and status
See more at https://owasp.org and https://github.com/OWASP/ASVS

**Statistics**
|{#2kv}Level|Requirements|Implemented including not applicable and refactored solutions|
|:----------|:----|:-----|
|1	    |75/75	|100%|
|2		|178/180|98.88%|
|3		|90/90	|100%|
|All    |343/345|99.42%|

**Explanation of status**
|Status		|Comment|
|:----------|:-----|
|Implemented		|OWASP satisfied|
|Not Implemented	|To be implemented to satisfy OWASP|
|Not applicable		|Not implemented so no requirement applicable|
|Implemented, refactored OWASP security|        Higher requirements than OWASP implemented|
|Not implemented, refactored OWASP security|    Unsecure OWASP requirements replaced by refactored solutions that includes to not use third party solutions and to follow V15.1 where it is explained that third party usage is a risk|


**V1 Encoding and Sanitization**
|{#2kv}Requirement|Level|Status|
|:----------|:----|:-----|
|***V1.1***|    |***Encoding and Sanitization Architecture***|
|1.1.1      |2 	  |**Implemented**, in this order: client controls input, encodes and encrypts in FFB, BFF decrypts, decodes and controls input and all once|
|1.1.2		|2 	  |**Implemented**, client application encodes and encrypts as final step|
|***V1.2***|    |***Injection Prevention***|
|1.2.1		|1    |**Implemented**, all HTTP responses return encrypted JSON REST API or HTML for intial app start response and all response supporting Unicode|
|1.2.2		|1 	  |**Implemented**, all requests are encrypted and use base64 encoding. Uses protocol HTTP with own developed custom Web Crypto API pattern and not HTTPS exposing info to third parties. Style tag in divs use url (data:..) syntax result from encrypted REST API. Specificaion does not explain why "data:" is not safe and provides no example of how it would be unsafe or why it would be less safe than other protocols.|
|1.2.3      |1    |**Implemented**, uses base64, TextDecoder, TextEncoder, encodeURIComponent and decodeURIComponent, tree shaking pattern and input validation both in apps and in server.|
|1.2.4      |1    |**Implemented**, uses ORM pattern with tree shaking pattern with OpenApi and IAM that controls requests|
|1.2.5      |1    |**Implemented**, OS commands excecuted from server batch job definitions not accessed by apps. OS info commands uses closure pattern so external functions can not access os commands directly.|
|1.2.6      |2    |**Not applicable**. LDAP not implemented.|
|1.2.7      |2    |**Implemented**, uses tree shaking pattern and OpenApi with parameter authentication. ORM database uses parameters in functions.|
|1.2.8      |2    |**Not applicable**. LaTeX processor not implemented.|
|1.2.9      |2    |**Implemented**. Uses backslashes or HTML entities when applicable.|
|1.2.10     |3    |**Not applicable**. No exports of CSV. CSV only used in server for server function databases.|
|***V1.3***|    |***Sanitization***|
|1.3.1      |1    |**Implemented**. Uses TextContent for input from divs to avoid HTML input, semantic HTML is replaced by pure divs to avoid obscure browser functionality, uses SFC pattern separating HTML, CSS and Javascript without using browser DOM functions and cleans up code switching frameworks between Vue, React and pure Javascript. Uses tree shaking pattern and OpenApi, input control in apps and in server that checks valid JSON and payload size. Vue and React framework have events disabled and are replaced by event delegation. Vue and React are controlled to only be able to mount pure HTML. Server and IAM request control blocks user if too many errors or suspicious activity in requests. Project directive follows to use own developed safe and refactored code of popular third party solutions without any third party dependencies with some progressive refactored usage of Vue and React.|
|1.3.2      |1    |**Implemented**. Eval() function not implemented.|
|1.3.3      |2    |**Implemented**. Server controls input of valid characters, payload size and valid JSON|
|1.3.4      |2    |**Implemented**. All SVG are without links, scripts or any other tag not needed.|
|1.3.5      |2    |**Implemented**. &ltscript&gt and &ltstyle&gt tags are replaced by secure REST API including fonts with the exception of maintenance of server error message when server is not available for apps. Apps must load all assets using encrypted REST API and custom Web Crypto API. Adoptedstylesheet implemented for common styles.|
|1.3.6      |2    |**Implemented**. Uses OpenApi that validates server configuration and paths accessed. IAM controls requests for any supicious behaviour including limited attempts to access invalid paths.|
|1.3.7      |2    |**Implemented**. Server does not render content from user input. Apps uses Vue SFC pattern in client|
|1.3.8      |2    |**Not applicable**. Java and JNDI are not implemented.|
|1.3.9      |2    |**Implemented**. Uses tree shaking pattern, OpenAPI and IAM request control.ORM pattern database authenticates data constraints.|
|1.3.10     |2    |**Implemented**. Input control in apps and in server. Server auhenticates valid JSON and payload size. Tree shaking pattern in both apps and in server.|
|1.3.11     |2    |**Implemented**. OpenApi, IAM request control, tree shaking pattern. SMTP or IMAP not implemented and replaced with own Email solution using Message queue pattern without any third party dependency.|
|1.3.12     |3    |**Implemented**. IAM request control including rate limiter|
|***V1.4***|    |***Memory, String, and Unmanaged Code***|
|1.4.1      |2    |**Implemented**. Payload size control in server. Server error management of any unknown error.|
|1.4.2      |2    |**Implemented**. IAM request control of valid JSON and payload size and server error management of any unknown error. Common server function to convert expected number input from string to number|
|1.4.3      |2    |**Implemented**. Strict Javascript ESM implemented and all modules loaded when needed only. Stateless directive implemented. Common library in apps cleans up frameworks after switching between Vue, React and pure javascript.|
|***V1.5***|    |***Safe Deserialization***|
|1.5.1      |1    |**Not applicable**. XML not used except server fetched SVG where all links and scripts are removed.|
|1.5.2      |2    |**Implemented**. Input control in apps and in server that allow only JSON from apps that is validated in server, tree shaking pattern and OpenApi parameter control. All server requests must use base64, encryption using Web Crypto API pattern and use Frontend For backend (FFB) and Backend for Frontend (BFF)|
|1.5.3      |3    |**Implemented**. All code supports Unicode, uses JSON.parse() and JSON.stringify() and use centralized BFF and IAM request control to control all inputs from apps.|

**V2 Validation and Business Logic**
|{#2kv}Requirement|Level|Status|
|:----------|:----|:-----|
|***V2.1***|    |***Validation and Business Logic Documentation***|
|2.1.1      |1    |**Implemented**. Uses OpenApi and integrated JSDoc comments in the Documentation app that explains input validation rules.|
|2.1.2      |2    |**Implemented**. Uses OpenApi and integrated JSDoc comments in the Documentation app that explains how to validate combined data.|
|2.1.3      |2    |**Implemented**. Uses OpenApi and integrated JSDoc comments in the Documentation app that explains business logic limits and validations at user level and global level.|
|***V2.2***|    |***Input Validation***|
|2.2.1      |1    |**Implemented**. Uses OpenApi and ORM database constraints  at object level and in data model level to enforce business and functional expectations.|
|2.2.2      |1    |**Implemented**. Uses OpenApi and ORM database constraints  at object level and in data model level in server as trusted service layer. Some basic input control is used in apps.|
|2.2.3      |2    |**Implemented**. Uses OpenApi, role based REST API, IAM request control, IAM resource access control and ORM database constraints to ensure combination of related data items are reasonable according to predefined rules.|
|***V2.3***|    |***Business Logic Security***|
|2.3.1      |1    |**Implemented**. Uses OpenApi, IAM, and ORM database constraints to process business logic flow for the same user in sequential order without skipping any step.|
|2.3.2      |2    |**Implemented**. Uses OpenApi and JSDoc comments to document business logic limits|
|2.3.3      |2    |**Not Implemented**. Entire transaction to be implemented. At the moment only last ORM statemented is rollbacked|
|2.3.4      |2    |**Implemented**. Database lock, transaction, rollback, commmit and race condition pattern implemented|
|2.3.5      |3    |**Implemented**. Multi user approval in shop and bank app. The buyer is waiting in the shop app for the bank user to approve the payment request|
|***V2.4***|    |***Anti-automation***|
|2.4.1      |2    |**Implemented**. Rate limiter and IAM request control implemented that blocks user causing too many requests, too many errors, trying to access invalid paths too much or because of other suspiscious activity. Admin, logged in users and anonymous users have different IAM parameters to set desired rate limiter rules |
|2.4.2      |3    |**Implemented**. Rater limiter implemented controlling too many requests with parameters to set custom rules|

**V3 Web Frontend Security**
|{#2kv}Requirement|Level|Status|
|:----------|:----|:-----|
|***V3.1***|    |***Web Frontend Security Documentation***|
|3.1.1      |3    |**Implemented**. Uses OpenApi and JSDoc documentation integrated with servers configured and used as rules including protocol, Content Security Policy, JSON Web token, IAM request control, Web Crypto API. The Documentation app specifies all security features implemented including comparison tables with common popular third party security solutions.|
|***V3.2***|    |***Unintended Content Interpretation***|
|3.2.1      |1    |**Implemented**. All browser content must be fetched using custom encrypted REST API using Web Crypto API pattern including all assets so app functions control how decrypted content should be rendered and thus avoid relying on different browsers different behaviour depending supported features for different versions, platform and user-agents. Authenticates sec-fetch-dest, sec-fetch-mode and sec-fetch-site request headers for APP requests, browser CSS font url requests and REST API requests using different parameters for each request type. Allows these keys to be missing in the request since browsers do not always send these keys to the server.|
|3.2.2      |1    |**Implemented**. Uses TextContent to update and read text directly when text is expected. createTextNode() is not used to avoid unnecessary obscure functionality.|
|3.2.3      |1    |**Implemented**. Uses Vue SFC pattern to separate HTML, CSS and Javascript that includes type declaration and uses data closure pattern and no global variables in window object. Uses data attribute on divs to identify columns or records on Vue SFC pattern mounted components. Uses ES modules and separates namespace using either app or common in apps without using window object or any global variable in the browser.|
|***V3.3***|    |***Cookie setup***|
|3.3.1      |1    |**Not applicable**. Project uses stateless directive and cookies are not allowed. Token variables, unique app instance encryption keys and browser fingerprint data are used in server authentication instead of any client authentication relying on different browsers different behaviour depending supported features for different versions, platform and user-agents.|
|3.3.2      |1    |**Not applicable**. Browser security features including HTTPS and SSL replaced with own customizable Web Crypto API pattern solution.|
|3.3.3      |1    |**Not applicable**. See 3.3.1.|
|3.3.4      |1    |**Not applicable**. See 3.3.1.|
|3.3.5      |1    |**Not applicable**. See 3.3.1.|
|***V3.4***|    |***Browser Security Mechanism Headers***|
|3.4.1      |1    |**Not applicable**. Browser security features including HTTPS and SSL are replaced with own customizable Web Crypto API pattern solution so HSTS feature is not used.|
|3.4.2      |1    |**Not applicable**. Access-Control-Allow-Origin feature is not used.|
|3.4.3      |2    |**Not implemented, refactored OWASP security**.  Customizable Content-Security-Policy is implemented with default values object-src 'self' data: and base-uri:'self'. A per-response policy with nonces or hashes is not defined. See explanation why not in 3.4.8.|
|3.4.4      |2    |**Not applicable**. x-content-type-options feature is not used. See 3.2.1 and 4.1.1|
|3.4.5      |2    |**Implemented**. referrer-policy = strict-origin-when-cross-origin is used for all responses.|
|3.4.6      |2    |**Implemented**. Content-Security-Policy with default frame-ancestors 'self' is used. x-frame-options is not used.|
|3.4.7      |3    |**Not implemented, refactored OWASP security**. Location not implemented in Content-Security-Policy and not allowed since this browser functionality does not allow to send custom encryption. See 2.4.1 and 12.2.1|
|3.4.8      |3    |**Not implemented, refactored OWASP security**. cross-origin-opener-policy and cross-origin-resource-policy only used by compatible user agents so there is no guarantee these will work since a user can change to use another browser or version or platform ignoring these parameters. No data is saved in window object. Customizable Content-Security-Policy is implemented and what is mentioned in 2.4.1, 10.2.1, 12.2.1 and 15.1.1.|
|***V3.5***|    |***Browser Origin Separation***|
|3.5.1      |1    |**Implemented, refactored OWASP security**. App Id token, any app access token, app instance unique encryption keys and browser fingerprint are all authenticated in server and cross-origin-opener-policy, cross-origin-resource-policy and referrer-policy are removed. Server can only accept requests from either one encrypted REST API endpoint or one encrypted CSS font url endpoint only. See also 3.4.8 why parameters are removed, 3.2.1 about sec-fetch* keys and 3.3.1 about stateless directive.|
|3.5.2      |1    |**Implemented**. Does not rely on CORS preflight mechanism. It is not possible to call any functionality without being authenticated in server and using the only two allowed public encrypted endpoints. See 3.5.1|
|3.5.3      |1    |**Implemented**. Uses OpenApi to control allowed paths and methods used and allows POST, PUT, PATCH, DELETE and GET methods in server decrypted REST API not available in public requests. Public REST API only use POST method to manipulate data and to fetch images, css and javascript for all encrypted requests and browser GET method for CSS font url where encrypted server side message (SSE) with secure font REST API fetch that uses POST method replaces unsecure browser font loading|
|3.5.4      |2    |**Not applicable**. Apps use same host and use same common library and implements single sign on pattern and single page application (SPA) multi app. Microservices are implemented on separate servers being on same or different host.However these can only be accessed by the server. |
|3.5.5      |2    |**Not applicable**. Postmessage in client is not implemented. Postmessage in server is used in worker_thread to solve cube state for complex Kocimeba algorithm calculations and not in client. |
|3.5.6      |3    |**Implemented**. JSONP is not enabled and not implemented.|
|3.5.7      |3    |**Implemented**. Script resource must use encrypted REST API so no data authorization in script resource responses|
|3.5.8      |3    |**Implemented**. All assets must use encrypted REST API when Vue SFC pattern component is used and is mounting the component when intended.See 3.5.1|
|***V3.6***|    |***External Resource Integrity***|
|3.6.1      |3    |**Implemented**. Client side assets must be fetched using encrypted REST API and in the same server and assets are modified in realtime with removed comments, ESM support for React and images returned as base64 strings. All assets are cached as variable using closure pattern in app replacing browser cache functionalty relying on different browsers different behaviour depending supported features for different versions, platform and user-agents. Project directive is not to use any third party dependencies due to security, consistent app behaviour in all browsers and to implement refactored solutions of popular third party solutions.|
|***V3.7***|    |***Other Browser Security Considerations***|
|3.7.1      |2    |**Implemented**. Does not use NSAPI plugins, Flash, Shockwave, ActiveX, Silverlight, NACL or client side java applets. Does not use semantic HTML with obscure functionality and different user-agent default styles. Does not use any user agent CSS. Replaces restricted Web Crypto Api with customizable Web Crypto Api opens source pattern without restrictions and algorithm optimized for performance. Replaces unsecure EventSource with encrypted WritableStream piped to client socket|
|3.7.2      |2    |**Not applicable**. Request is not redirected and not allowed. Instead HTTP errors 401 is returned for any invalid request. User must use main app or admin server host without any paths more than allowed encrypted endpoints. See 3.5.1|
|3.7.3      |3    |**Not applicable**. See 3.7.2 |
|3.7.4      |3    |**Not applicable**. HST and TLS are not used. Project does not allow the use of third party controlled HTTPS. See 1.2.2, 3.2.1 and 3.6.1 and about customizable Web Crypto API pattern implemented.|
|3.7.5      |3    |**Implemented**. Apps and server behave as documented and implemented using OpenApi, JSDoc comments and IAM pattern using ES6+ Javascript. Browsers not supporting ES6+ are not supported and explained in documentation comparing transpilers, build step and polyfill with implementation.|


**V4 API and Web Service**
|{#2kv}Requirement|Level|Status|
|:----------|:----|:-----|
|***V4.1***|    |***Generic Web Service Security***|
|4.1.1      |1    |**Implemented**. All responses contains either `application/json; charset=utf-8` or `text/html; charset=utf-8` in `Content-Type` .|
|4.1.2      |2    |**Not applicable**. No redirect allowed. Project does not allow the use of HTTPS to avoid leakage to OCSP third party servers and third party to control encryption. See 1.2.2 and 3.2.1 and about customizable Web Crypto API pattern implemented.|
|4.1.3      |2    |**Implemented**. Backend for frontend (BFF) and Backend for external (BFE) use x-forwarded-for and other browser fingerprint data in server|
|4.1.4      |3    |**Implemented**. GET, POST, PUT, PATCH, DELETE are the only methods allowed in server and controlled by IAM and blocked if too many failed requests. OpenApi makes sure only encrypted POST REST API and encrypted CSS font url GET requests are allowed from client. See also 3.5.3|
|4.1.5      |3    |**Implemented**. Shop app uses a unique signature for each payment request sent to the bank app and user must authorize the payment request manually in the bank app. Each app instances use unique encryption keys and are validate in server with fingerprint data from browser. Restarting app generates new unique encryption keys.|
|***V4.2***|    |***HTTP Message Structure Validation***|
|4.2.1      |2    |**Implemented**. Transfer encoding and Content-length are not used. The incoming messages are 100% encrypted and validated using app instance encryption keys only.|
|4.2.2      |3    |**Not applicable**. See 4.2.1.|
|4.2.3      |3    |**Not applicable**. HTTP/2 and HTTP/3 are not used.|
|4.2.4      |3    |**Not applicable**. See 4.2.3.|
|4.2.5      |3    |**Implemented**.  Server REST API is using ISO20022 including customizable record limit logic. IAM blocks user if too many invalid requests or too many requests.|
|***V4.3***|    |***GraphQL***|
|4.3.1      |2    |**Not applicable**.  GraphQL replaced by ORM pattern.|
|4.3.2      |2    |**Not applicable**.  GraphQL replaced by ORM pattern.|
|***V4.4***|    |***WebSocket***|
|4.4.1      |1    |**Not applicable**.  Websocket replaced by encrypted and secure server side messages (SSE) and encrypted REST API.|
|4.4.2      |2    |**Not applicable**.  Websocket replaced by encrypted and secure server side messages (SSE) and encrypted REST API.|
|4.4.3      |2    |**Not applicable**.  Websocket replaced by encrypted and secure server side messages (SSE) and encrypted REST API.|
|4.4.4      |2    |**Not applicable**.  Websocket replaced by encrypted and secure server side messages (SSE) and encrypted REST API.|

**V5 File Handling**
|{#2kv}Requirement|Level|Status|
|:----------|:----|:-----|
|***V5.1***|    |***File Handling Documentation***|
|5.1.1      |2    |**Implemented**.  Uses server parameter SERVER_JSON_LIMIT in OpenApi to control maximum allowed upload payload for each request. All failed response status codes are documented in OpenApi. All functions are using JSdoc comments with description, explanation of parameters and return values in each function including file handling functions that return files inside JSON.|
|***V5.2***|    |***File Upload and Content***|
|5.2.1      |1    |**Implemented**.  See 2.4.1, 2.4.2 and 5.1.1.|
|5.2.2      |1    |**Implemented, refactored OWASP security**.  Allows JSON from client only with image inside encrypted JSON and server controls content of the image for all users image updates and only accepts supported image formats. Image rewriting not allowed. See also 1.3.1 and 1.3.3|
|5.2.3      |2    |**Not applicable**. Compressed files not supported or implemented.|
|5.2.4      |3    |**Not applicable**.  Upload of files not supported or implemented.|
|5.2.5      |3    |**Not applicable**.  Upload of files not supported or implemented.|
|5.2.6      |3    |**Implemented, refactored OWASP security**. Upload of files not supported. Image can be included in JSON and server controls pixel size for WebP of type VP8X, PNG and JPG only and server parameter has parameter to control max allowed pixel size. Other image formats will be rejected. See also 5.2.2.|
|***V5.3***|    |***File Storage***|
|5.3.1      |1    |**Not applicable**.  Upload of files not supported or implemented.|
|5.3.2      |1    |**Implemented**.  Initial server installation function is the only function that creates server paths and uses internally generated data and trusted data to create paths on the server.|
|5.3.3      |3    |**Implemented**.  No request can request to create paths or to decompress files on the server. No server process for decompression implemented.|
|***V5.4***|    |***File Download***|
|5.4.1      |2    |**Not applicable**. File download not implemented. All requests return JSON or server side message if browser requests encrypted CSS font url that is replaced with server side message so encrypted JSON will be requested instead from the app.|
|5.4.2      |2    |**Not applicable**.  File download not implemented.|
|5.4.3      |2    |**Not implemented, refactored OWASP security**.  File download not implemented, however antivirus not implemented to control JSON post to server but third party not allowed see 15.1.1.|

**V6 Authentication**
|{#2kv}Requirement|Level|Status|
|:----------|:----|:-----|
|***V6.1***|    |***Authentication Documentation***|
|6.1.1      |1    |**Implemented**.  Uses OpenApi and integrated JsDoc comments with documentation of rate limiter and adaptive response.|
|6.1.2      |2    |**Not implemented, refactored OWASP security**.  Context-specific words are not documented and not allowed. Users are free to use any Unicode password within some basic constraints. Directive is stateless and to not control users passwords adding more security risks to implement stateful solutions with security info saved in variables.|
|6.1.3      |2    |**Implemented**.  Uses OpenApi integrated with JSDoc to document all paths with security controls and implements rules using this documentation.|
|***V6.2***|    |***Password Security***|
|6.2.1      |1    |**Implemented**.  Passwords must be between 10 and 100 characters.|
|6.2.2      |1    |**Implemented**.  Users can change their password by using TOTP.|
|6.2.3      |1    |**Implemented**.  Users must post current password to be able to change to a new password.|
|6.2.4      |1    |**Not implemented, refactored OWASP security**.  Password is not checked against available set of any password policy. See 6.1.2.|
|6.2.5      |1    |**Implemented**.  Users can enter any Unicode password. Se also 1.3.3 and 6.2.1.|
|6.2.6      |1    |**Implemented**.  Semantic HTML replaced with divs to avoid obscure browser functionality. Masked password can be viewed selecting individual character or entire password as refactored security solution compared to limited semantic HTML browser functionality.|
|6.2.7      |1    |**Not implemented, refactored OWASP security**.  No browser semantic HTML password functionality is supported. No external password manager is supported. Keyboard editing using copy cut and paste is allowed only if App.TextEdit=1 for the app and Bank and Shop app have disabled text editing by default as higher security requirement so no third party keylogger or clipboard tool can steal data including the browser.|
|6.2.8      |1    |**Implemented**.  Password is posted to server as entered within the encrypted data using Web Crypto API pattern.|
|6.2.9      |2    |**Implemented**.  See 6.2.1.|
|6.2.10     |2    |**Implemented**.  Passwords stay valid. No required periodic credential rotation implemented. Admin can set Active = 0 for a the user so user must enter TOTP at login. Users will be blocked if too many supicious activity discovered.See 1.3.1 and 2.4.1|
|6.2.11     |2    |**Not implemented, refactored OWASP security**. Context-specific words not implemented to prevent easy to guess password. See 6.1.2|
|6.2.12     |2    |**Not implemented, refactored OWASP security**.  Password created at account registration or password changes are not checked against a set of breach passwords. Admins has the option to block user registration and to require multi-factor authentication TOTP for a user at login. See 6.2.11.|
|***V6.3***|    |***General Authentication Security***|
|6.3.1      |1    |**Implemented**.  All login attempts with Ip and geolocation info are available for admins. An IP adress will be blocked after too many failed login attempts. See 2.4.1, 3.1.1, 6.1.1 and 7.4.5|
|6.3.2      |1    |**Implemented, refactored OWASP security**.  Default admin account is not disabled and admin account can only be used in admin app. Admin user must be able to login in the admin app to monitor the users activities and the apps available.|
|6.3.3      |2    |**Implemented, refactored OWASP security**.  Multi factor authentication is implemented and is used when the user is inactivate at login, signup and for any user info change. OTP key and TOTP that hardware solutions use are implemented using the same algorithms in the OTP app and the stateless app can/should be accessed from another device/network/geolocation (hardware server) that the user can also install as localhost without network access at all providing refactored security compared to a stateful hardware device saving the OTP key within the hardware. The users OTP is only displayed once at user registration.|
|6.3.4      |2    |**Implemented**.  All pathways are documented and implemented using OpenApi. Users will be blocked for too many failed path attempts.|
|6.3.5      |3    |**Implemented, refactored OWASP security**.  Uses IAM request authentication control that includes accessing wrong paths, blocked user-agents, blocked ip adresses and more. Users are only answered with http code 401 nothing else without exposing any explanation. User can access from any location or client (since there exist no "unusual location or client" on internet as directive), during any inactivity period and after any amount of attempts as long as they are not blocked by IAM request authentication control. Admin also have the possibility to block all user logins, all new user registrations and/or client IP ranges|
|6.3.6      |3    |**Implemented**.  Directive is that email is obsolete and unsecure and not implemented at all. Own developed email pattern implemented and at the moment only used to send messages to admin and not part of any authentication|
|6.3.7      |3    |**Implemented, refactored OWASP security**.  User are not notified anywhere as increased security measurement. The user is automatically logged out after any user info change and current access token is invalidated in server and server side message instructs app to log out immediately without any info or questions.|
|6.3.8      |3    |**Implemented**.  All failed authentication requests will respond with 401 without exposing any information and explanation of any kind. Project has not implemented unsecure forgot password process.|
|***V6.4***|    |***Authentication Factor Lifecycle and Recovery***|
|6.4.1      |1    |**Implemented**.  First time installation creates different SHA256 secrets for different id and access tokens and for user password server encryption. Server parameter IAM_SERVER_UPDATE_SECRETS_START=1 that means all secrets will be updated at each restart and this functionality can be disabled. Admin must enter password first time and no passwords are generated. Admin can create demo users by entering passwords.|
|6.4.2      |1    |**Implemented**.  Password reminder field implemented for the user and is not exposed outside users session. No knowledge base questions are implemented to guess passwords.|
|6.4.3      |2    |**Implemented, refactored OWASP security**.  Forgotten password process not allowed.|
|6.4.4      |2    |**Implemented, refactored OWASP security**.  User must either contact admin or create new account if multifactor OTP key is lost.|
|6.4.5      |3    |**Not implemented,  refactored OWASP security**.  No renewal info to the user implemented. No info allowed to send to users and no configured automated reminder allowed since this would require unsecure third party dependencies like unsecure and obsolete stateful email or phone messages being saved in unknown places without control|
|6.4.6      |3    |**Implemented**.  Admin can set users to inactive that will require multifactor TOTP to be used at login. Password reset process is not implemented and not requried and allowed as directive|
|***V6.5***|    |***General Multi-factor authentication requirements***|
|6.5.1      |2    |**Implemented**. Multifactor TOTP is implemented and the only multifactor method|
|6.5.2      |2    |**Implemented**.  TOTP keys implemented using HMAC SHA256, RFC 3548, RFC 3648, RFC 4226 and RFC 6238.|
|6.5.3      |2    |**Implemented**.  See 6.5.2.|
|6.5.4      |2    |**Implemented**.  See 6.5.2.|
|6.5.5      |2    |**Implemented**.  All tokens have individual customizable expire and secret parameters documented in OpenApi See 6.5.2 for TOTP with maximum lifetime of 30 seconds.|
|6.5.6      |3    |**Implemented**.  TOTP authentication factor can be revoked by admin that can change the OTP key.|
|6.5.7      |3    |**Not implemented,  refactored OWASP security**.  Thirdparty stateful uncontrolable biometric authentication mechanism not allowed.|
|6.5.8      |3    |**Implemented**.  Own develop TOTP app developed and authenticated in server only without any third party dependencies.See 6.5.2|
|***V6.6***|    |***Out-of-Band authentication mechanism***|
|6.6.1      |2    |**Implemented**.  TOTP not allowed to be sent anywhere.See 6.4.5|
|6.6.2      |2    |**Implemented**.  Shop app receives one short time token for given payment request using 8192 bit encrypted key inside customizable Web Crypto Api pattern using 256 bit encryption.|
|6.6.3      |2    |**Implemented**.  Rater limiter is implemented. See 2.4.1 about rate limiter and 6.6.2 about encryption|
|6.6.4      |3    |**Not applicable**. No push notification implemented for multifactor authentication. See also 2.4.1|
|***V6.7***|    |***Cryptographic authentication mechanism***|
|6.7.1      |3    |**Implemented**.  All security secrets includig private and public keys stored in server only accessed by admin.|
|6.7.2      |3    |**Implemented**.  See 6.5.2 and 6.6.2.|
|***V6.8***|    |***Authentication with an identity Provider***|
|6.8.1      |2    |**Not applicable**.  Only one identity provider (IAM) implemented and allowed.|
|6.8.2      |2    |**Implemented**.  Different role based JWT uses HS256 and RFC 7519 are implemented. They are validated in the server and rejected if they have invalid signatures or are expired|
|6.8.3      |2    |**Not applicable**.  SAML not implemented.|
|6.8.4      |2    |**Implemented**. Own developed IAM is implemented as identity provider and the only one allowed. OpenApi with integrated JSDoc documentation that explains all token security, single factor and multi factor authentication is implemented and displayed in the Documentation app.|


**V7 Session Management**
|{#2kv}Requirement|Level|Status|
|:----------|:----|:-----|
|***V7.1***|    |***Session Management Documentation***|
|7.1.1      |2    |**Implemented**.  Uses OpenApi integrated with JSDoc documentation presented in the Documentation app including customizable absolute maximum session lifetime parameters and information how apps display the info. Inactivity timeout is not implemented according to NIST SP 800-63B and implements only automatic logout of expired session initiated and forced by server side message that invalidates the token in the server and logs out the user in the app and users should keep track of remaining session lifetime as directive. |
|7.1.2      |2    |**Implemented**.  Maximum number of concurrent sessions for one account is documented and defined as server parameter and the user will be denied authorization to login when max concurrent sessions for one account is reached.|
|7.1.3      |2    |**Not implemented,  refactored OWASP security**.  Uses IAM pattern and is documented in OpenAPI and in the Documentation app. Federated identity management ecosystem not allowed in project and not implemented since all users must be authenticated using same host only and must be able to be authenticated without using any network if necessary.|
|***V7.2***|    |***Fundamental Session Management Security***|
|7.2.1      |1    |**Implemented**.  All session token verifications are done in the server and by own developed logic and refactored solution of popular third party solutions.|
|7.2.2      |1    |**Implemented**.  Uses JWT tokens and RFC 7519 and are dynamically created. Each access token also must include id token, unique for each app instance, with different secrets than the access token|
|7.2.3      |1    |**Implemented**.  A tokens is authenticated in the server that the token is unique. See also 7.2.2.|
|7.2.4      |1    |**Implemented**.  A new token is generated for each user authentication. Re-authentication is not allowed. See 7.1.1|
|***V7.3***|    |***Session Timeout***|
|7.3.1      |2    |**Implemented**.  See 7.2.4.|
|7.3.2      |2    |**Implemented**.  See 7.1.1.|
|***V7.4***|    |***Session Termination***|
|7.4.1      |1    |**Implemented**.  Uses server function to check expired tokens with given parameter interval that sends server side message to apps so the user is automatically logged out in the apps and the token is invalidated at the same time. Server also invalidates the token if the user logs out in the app. All tokens saved and authenticated in the ORM database|
|7.4.2      |1    |**Implemented**.  User is logged out automatically if the admin deletes the user or sets the user to inactive and the token is set to expired. See also 6.3.7|
|7.4.3      |2    |**Implemented**.  User is set to inactive and logged out, token is invalidated and the user requires multifactor TOTP to login again to activate account again if a user changes username or password or if admin changes username, password, OTP key, type, user level or status.|
|7.4.4      |2    |**Implemented**.  Uses multiapp SPA app design and user menu is available in all apps where user have easy and visible access to log out functionality.|
|7.4.5      |2    |**Implemented, refactored OWASP security**.  Admin can terminate all users sessions by sending maintenance messages to all users so all apps will be reloaded and all sessions terminated or admin can inactive a user or multiple users so this will automatically trigger the token to be invalidated and terminates the session for the given user or the users or admin can also restart the server so all tokens are erased and all apps in use are terminated by the lost socket connection function.|
|***V7.5***|    |***Defenses Against Session Abuse***|
|7.5.1      |2    |**Implemented**.  User must use password and multifactor TOTP to change user info.|
|7.5.2      |2    |**Not implemented**.  User is not able to view and terminate any or all active sessions.|
|7.5.3      |3    |**Implemented**.  Manual approval is required of payment request in the bank app when shop creates payment request. See also 7.5.1|
|***V7.6***|    |***Federated Re-authentication***|
|7.6.1      |2    |**Not applicable**.  Relying party (RP) or identify provider (IdP) code is not implemented. See also 7.1.3 about federated identity management|
|7.6.2      |2    |**Not applicable**.  See 7.6.1.|

**V8 Authorization**
|{#2kv}Requirement|Level|Status|
|:----------|:----|:-----|
|***V8.1***|    |***Authorization Documentation***|
|8.1.1      |1    |**Implemented**.  Uses OpenApi integrated with JSDoc documentation and added documentation in the Documentation app that documents role base authorization, rules for restricted function-level, how to monitor users, how to restrict user access with supervised and unsupervised methods, data specific access for different roles and how access to resources are authenticated using IAM.|
|8.1.2      |2    |**Implemented**. Field-level access is authenticated when applicable in IAM and documented as mentioned in 8.1.1.|
|8.1.3      |3    |**Implemented**. Uses OpenApi to define environment and contextual attributes to make security decisions. See 8.1.1.|
|8.1.4      |3    |**Implemented**. Uses IAM with access management that displays how environmental and contextual factors are used in decision-making. See 8.1.1.|
|***V8.2***|    |***General Authorization Design***|
|8.2.1      |1    |**Implemented**. Function level access using role based REST API and OpenApi. See 8.1.1.|
|8.2.2      |1    |**Implemented**. Data specific access is restricted as explained in 8.1.1 with encrypted only access mentioned in 3.1.1 to more than mitigate and to eliminate completly insecure direct object reference (IDOR) and broken object level authorization (BOLA). Any failed encryption caused by user manipulation will block the user if too many attempts tried|
|8.2.3      |2    |**Implemented**. See 8.2.2|
|8.2.4      |3    |**Implemented**. All security controls are for each requests. See 6.1.1 and 8.1.1.|
|***V8.3***|    |***Operation Level Authorization***|
|8.3.1      |1    |**Implemented**. All authentication and authorization is in server replacing third party dependencies with refactored solutions as directive. Serverless function pattern is additionaly used to enhance security by moving logic from client to server|
|8.3.2      |3    |**Implemented**. See 6.3.5, 8.2.4 and 8.3.1.|
|8.3.3      |3    |**Implemented**. See 7.1.3|
|***V8.4***|    |***Other Authorization Considerations***|
|8.4.1      |2    |**Implemented**. Multi SPA app where the user has permission to interact with all apps. See also 8.1.1|
|8.4.2      |3    |**Implemented**. Admin app uses different security parameters than user apps. See also 8.2.4|

**V9 Selfâ€‘contained Tokens**
|{#2kv}Requirement|Level|Status|
|:----------|:----|:-----|
|***V9.1***|    |***Token source and integrity***|
|9.1.1      |1    |**Implemented**. JWT pattern implemented. See 6.8.2|
|9.1.2      |1    |**Implemented**. Algorithm HS256 used is the only one allowed. See 6.8.2|
|9.1.3      |1    |**Implemented**. Own developed refactored JWT pattern without any third party dependencies implemented. See also 6.8.4 and 9.1.1|
|***V9.2***|    |***Token content***|
|9.2.1      |1    |**Implemented**. Nbf and exp keys are authenticated. See also 9.1.1|
|9.2.2      |2    |**Implemented**. Different role based access tokens and id tokens with different individual parameters implemented. See also 6.8.2|
|9.2.3      |2    |**Implemented**. Aud key is saved in the JWT token with the only audience implemented. Higher security is implemented to authenticate token as explained in 6.8.2 so implicitly not applicable|
|9.2.4      |2    |**Implemented**. Only one audience implemented. See also 9.2.2|

**V10 OAuth and OIDC**
|{#2kv}Requirement|Level|Status|
|:----------|:----|:-----|
|***V10.1***|    |***Generic OAuth and OIDC Security***|
|10.1.1      |2    |**Implemented**. Third party OAuth and OIDC not allowed and not implemented and replaced with IAM as mentioned in 7.1.3 however tokens are only sent to components when needed.|
|10.1.2      |2    |**Implemented**. Client only acccepts values including Id Token from the only authorized server. See 10.1.1|
|***V10.2***|    |***OAuth Client***|
|10.2.1      |2    |**Implemented**. See 10.1.1 about OAuth and OIDC and cross site request forgery is not possible since cookies are not allowed in clients and dynamic app instance secrets are hidden using stateless closure pattern and only authorized to be used with the given app instance. All authentications including browser fingerprint and authorization is done in the server and all request must be encrypted.|
|10.2.2      |2    |**Implemented**. Client can only interact with one server. Iss key is saved in token. See also 9.2.3 with analogic answer and 10.1.1.|
|10.2.3      |3    |**Implemented**. Scope is implemented. See also 9.1.1 and 10.1.1.|
|***V10.3***|    |***OAuth Resource Server***|
|10.3.1      |2    |**Implemented**. See 9.2.2, 9.2.3 and 10.1.1|
|10.3.2      |2    |**Implemented**. Claims are authenticated and sub key is saved in the token. See also 9.2.3 with analogic answer and 10.1.1.|
|10.3.3      |2    |**Implemented**. Claims, iss and sub keys are saved in the token. See 9.2.3 with analogic answer and 10.1.1.|
|10.3.4      |2    |**Implemented**. See 9.2.3 and 10.1.1.|
|10.3.5      |3    |**Implemented**. Stolen access token can not be used anywhere but within the same app instance. See 10.1.1 and 10.2.1.|
|***V10.4***|    |***OAuth Authorization Server***|
|10.4.1      |1    |**Implemented**. Verified and redirect is not allowed. See 3.7.2 and 10.1.1.|
|10.4.2      |1    |**Implemented**. Server does not return any authorization codes however see 4.1.5 about bank and shop implementation where access token, not code, has a very short lifetime. See 10.1.1.|
|10.4.3      |1    |**Implemented**. See 10.4.2 and 10.1.1.|
|10.4.4      |1    |**Implemented**. See 6.8.2 and 10.1.1|
|10.4.5      |1    |**Implemented**. Refresh token not allowed and not implemented. See 10.1.1.|
|10.4.6      |2    |**Implemented**. See 10.1.1.|
|10.4.7      |2    |**Implemented**. No unauthenticated dynamic client registration allowed or implemented. See 7.1.3 and 10.1.1.|
|10.4.8      |2    |**Implemented**. Refresh token not allowed and not implemented. See 10.1.1.|
|10.4.9      |2    |**Implemented**. Refresh token not allowed and not implemented. Admin can invalidate stateless access tokens by restarting server. See 10.3.5 and 10.1.1.|
|10.4.10     |2    |**Not applicable**. See 10.1.1.|
|10.4.11     |2    |**Implemented**. See 10.1.1.|
|10.4.12     |3    |**Not applicable**. See 10.1.1.|
|10.4.13     |3    |**Not applicable**. See 10.1.1.|
|10.4.14     |3    |**Not applicable**. See 10.1.1.|
|10.4.15     |3    |**Not applicable**. See 10.1.1.|
|10.4.16     |3    |**Not applicable**. See 10.1.1.|
|***V10.5***|    |***OIDC Client***|
|10.5.1      |2    |**Not applicable**. See 10.1.1.|
|10.5.2      |2    |**Not applicable**. See 10.1.1.|
|10.5.3      |2    |**Not applicable**. See 10.1.1.|
|10.5.4      |2    |**Not applicable**. See 10.1.1.|
|10.5.5      |2    |**Not applicable**. See 10.1.1.|
|***V10.6***|    |***OpenID Provider***|
|10.6.1      |2    |**Not applicable**. See 10.1.1.|
|10.6.2      |2    |**Not applicable**. See 10.1.1.|
|***V10.7***|    |***Consent Management***|
|10.7.1      |2    |**Not applicable**. See 10.1.1.|
|10.7.2      |2    |**Not applicable**. See 10.1.1.|
|10.7.3      |2    |**Not applicable**. See 10.1.1.|

**V11 Cryptography**
|{#2kv}Requirement|Level|Status|
|:----------|:----|:-----|
|***V11.1***|    |***Cryptographic Inventory and Documentation***|
|11.1.1      |2    |**Implemented**. Uses OpenApi with JSDoc integrated documentation that is displayed in the Documentation app with additional security documentation includes about policy for management of cryptographic keys and cryptographic key lifecycle defined in NIST SP 800-57 as secure generation, storage, distribution, use and destruction.|
|11.1.2      |2    |**Implemented**. See 11.1.1|
|11.1.3      |3    |**Implemented**. See 11.1.1|
|11.1.4      |3    |**Implemented**. Documented plan that outlines migration path to new cryptographic standards available in the Documentation App and the security implementation menu item. See 11.1.1. |
|***V11.2***|    |***Secure Cryptographiy Implementation***|
|11.2.1      |2    |**Implemented**. Implements refactored security solutions. See 11.1.1|
|11.2.2      |2    |**Implemented**. Security is customizable using OpenApi server configuration parameters and be changed at any moment by the admin in the admin app. See also 11.2.1 and 11.1.4.|
|11.2.3      |2    |**Implemented**. All security by default minimum 256 bit encryption and can be modified to use higher encryption by admin. Bank and shop app use default 8192 bit encryption inside Web Crypto Api pattern using 256 bit performance optimized transport encryption.|
|11.2.4      |3    |**Implemented** See 3.1.1|
|11.2.5      |3    |**Implemented** See 3.1.1|
|***V11.3***|    |***Encryption Algorithms***|
|11.3.1      |1    |**Implemented** See 3.1.1|
|11.3.2      |1    |**Implemented, refactored OWASP security** Restricted third party Web Crypto API using AES with GCM replaced with unrestricted Web Crypto API pattern using AES and CFB. See 3.1.1 and 15.1.1|
|11.3.3      |2    |**Implemented** See 3.1.1|
|11.3.4      |3    |**Implemented** See 3.1.1|
|11.3.5      |3    |**Implemented** See 3.1.1|
|***V11.4***|    |***Hashing and Hash-based Functions***|
|11.4.1      |1    |**Implemented** See 3.1.1|
|11.4.2      |2    |**Implemented** See 3.1.1|
|11.4.3      |2    |**Implemented** See 3.1.1|
|11.4.4      |2    |**Implemented** See 3.1.1|
|***V11.5***|    |***Random values***|
|11.5.1      |2    |**Implemented** See 2.4.1 and 3.1.1|
|11.5.2      |3    |**Implemented** See 3.1.1|
|***V11.6***|    |***Public Key Cryptography***|
|11.6.1      |2    |**Implemented** RSA keys using 8192 bits are implemented for bank and shop payment request and the encrypted data is inside secure Web Crypto Api 256 bit encrypted transport. See 3.1.1|
|11.6.2      |3    |**Implemented** See 3.1.1|
|***V11.7***|    |***In-Use Data Cryptography***|
|11.7.1      |3    |**Implemented** See 3.1.1|
|11.7.2      |3    |**Implemented** See 3.1.1|

**V12 Secure Communication**
|{#2kv}Requirement|Level|Status|
|:----------|:----|:-----|
|***V12.1***|    |***General TLS Security Guidance***|
|12.1.1      |1    |**Not implemented,  refactored OWASP security**. See 3.7.4.|
|12.1.2      |2    |**Not implemented,  refactored OWASP security**. See 3.7.4.|
|12.1.3      |2    |**Not implemented,  refactored OWASP security**. See 3.7.4.|
|12.1.4      |3    |**Not implemented,  refactored OWASP security**. See 3.7.4 and 4.1.2 about why not use OCSP.|
|12.1.5      |3    |**Not implemented,  refactored OWASP security**. See 3.7.4.|
|***V12.2***|    |***HTTPS Communication with External Facing Services***|
|12.2.1      |1    |**Not implemented,  refactored OWASP security**. See 3.7.4 and 4.1.2 about why HTTPS and OCSP are replaced with safe custom Web Crypto API pattern and HTTP.|
|12.2.2      |1    |**Not implemented,  refactored OWASP security**. See 3.7.4.|
|***V12.3***|    |***General Service to Service Communication Security***|
|12.3.1      |2    |**Not implemented,  refactored OWASP security**. See 3.7.4.|
|12.3.2      |2    |**Not implemented,  refactored OWASP security**. See 3.7.4.|
|12.3.3      |2    |**Not implemented,  refactored OWASP security**. See 3.7.4.|
|12.3.4      |2    |**Not implemented,  refactored OWASP security**. See 3.7.4.|
|12.3.5      |3    |**Not implemented,  refactored OWASP security**. See 3.7.4. Microservices use different and enhanced security configuration compared to user security accessed from the browser and are by default blocked from public access in the firewall|

**V13 Configuration**
|{#2kv}Requirement|Level|Status|
|:----------|:----|:-----|
|***V13.1***|    |***Configuration Documentation***|
|13.1.1      |2    |**Implemented**. Uses OpenApi.|
|13.1.2      |3    |**Implemented**. Maximum number of concurrent connections is documented and defined as server parameter and clients will be denied access if too many concurrent connections. See also 2.4.1 about rater limiter and IAM request control|
|13.1.3      |3    |**Implemented**. Uses OpenApi and JSDoc integrated documentation that includes rater limiter, IAM request control, resource-release procedures in ORM, failure handling and rolebased customizable request timeout parameters with backoff algorithm including customizable retry limits.|
|13.1.4      |3    |**Implemented**. Uses OpenApi and explains schedule for rotating secrets and expire info implemented at server restart according to server parameter value |
|***V13.2***|    |***Backend Communication Configuration***|
|13.2.1      |2    |**Implemented**.  All communications at the backend are authenticated and explained in the Documentation app|
|13.2.2      |2    |**Implemented**.  All communications at the backend are authenticated with least necessary privileges|
|13.2.3      |2    |**Implemented**.  Default credentials are not used anywhere|
|13.2.4      |2    |**Implemented**.  Uses OpenApi to define and to document what is allowed to access and presented in the Documentation app|
|13.2.5      |2    |**Implemented**.  See 13.2.4|
|13.2.6      |3    |**Not applicable**.  Uses OpenApi to allow client to access to main server only. Accessing microservice is from the server only. There is no maximum parallel connections implemented for microservices and only batch microservice is implemented and not accessed from clients so requirement not applicable. See also 13.1.3|
|***V13.3***|    |***Secret Management***|
|13.3.1      |2    |**Implemented**.  Secrets are only saved in and controlled by own developed ORM database with closure pattern and OpenApi restricts access only to admin. No access to third parties. No build step implemented that could include secrets. Level 3: Hardware security module (HSM) implemented is the hardware server using ORM database using closure pattern so secrets cannot be accessed without rolebased function calls defined in OpenApi and integrated JSDoc documentation|
|13.3.2      |2    |**Implemented**.  Role based secrets are accessed with least privileges and according to role|
|13.3.3      |3    |**Implemented**.  All cryptographic server operations are performed in isolated security module and explained in security menu in the Documentation app|
|13.3.4      |3    |**Implemented**.  See 13.1.4|
|***V13.4***|    |***Unintended Information Leakage***|
|13.4.1      |1    |**Implemented**.  App is deployed with source control folder on server to be able to implement CI/CD and this folder is not accessible externally and not included as accessible in OpenApi|
|13.4.2      |2    |**Implemented**.  Debug modes are not implemented and not exposed in production|
|13.4.3      |2    |**Implemented**.  Directory list of files only allowed for admin when listing available log files and explained in OpenApi|
|13.4.4      |2    |**Implemented**.  HTTP TRACE method is not used and not allowed in implemented OpenApi|
|13.4.5      |2    |**Implemented**.  OpenApi is displayed in the Documentation app including inaccessible private paths from clients, public available paths and system parameters removed. All paths are rolebased and with monitoring path displayed that can not be accessed without admin authorization and not without authenticated admin encryption secrets|
|13.4.6      |3    |**Implemented**.  No detailed version information of backend components displayed|
|13.4.7      |3    |**Implemented**.  Uses OpenApi, see 13.1.3|

**V14 Data Protection**
|{#2kv}Requirement|Level|Status|
|:----------|:----|:-----|
|***V14.1***|    |***Data Protection Documentation***|
|14.1.1      |2    |**Implemented**.  Uses closure pattern in client and in server. Frontend for backend (FFB) sends and receives from Backend for frontend (BFF) encoded base64 data inside encrypted request and response data using Web Crypto API pattern so no data and explanation are exposed including url, header, body request and response. Data is protected from third parties by not using HTTPS explained in 4.1.2 and by using stateless pattern including not using cookies as explained in 3.3.1. See also 3.1.1 and info pages in start page with disclaimer, privacy policy and terms.|
|14.1.2      |2    |**Implemented**.  Uses OpenApi, 14.1.1|
|***V14.2***|    |***General Data Protection***|
|14.2.1      |1    |**Implemented**.  See 14.1.1|
|14.2.2      |2    |**Implemented**.  See 14.1.1|
|14.2.3      |2    |**Implemented**.  Application works without network if needed to avoid 100% untrusted third parties. See 14.1.1|
|14.2.4      |2    |**Implemented**.  See 14.1.1|
|14.2.5      |3    |**Not applicable, refactored OWASP security**. Unsecure browser cache functionality not allowed and replaced with application managing cache using closure pattern. See 3.2.1 and 14.1.1 |
|14.2.6      |3    |**Implemented**.  Application returns minimum required sensitve data. Application does not return passwords except for admin when listing users but password not displayed in app. See also 6.2.6.|
|14.2.7      |3    |**Implemented**.  Sensitive data including user access and user encryption keys used in app instance can be erased completely by restarting server by admin, as the situation requires, since all sensitive data are saved in memory only objects in the ORM database. See 14.1.1|
|14.2.8      |3    |**Not applicable**.  User submitted files not implemented and not allowed. See 14.1.1|
|***V14.3***|    |***Client-side Data Protection***|
|14.3.1      |1    |**Implemented**.  See 14.2.5|
|14.3.2      |2    |**Implemented**.  Cache-control no store is used. See also 14.2.5|
|14.3.3      |2    |**Implemented**.  See 14.2.5|

**V15 Secure Coding and Architecture**
|{#2kv}Requirement|Level|Status|
|:----------|:----|:-----|
|***V15.1***|    |***Secure Coding and Architecture Documentation***|
|15.1.1      |1    |**Implemented**.  Third party dependencies removed completely. However server machine, server firmware, all apt installed software, systemctl/systemd and server software NodeJs have no defined documenation about risk remediation time frames but since **OWASP states: "A 'risky component' a 3rd party library" in V15.1, it does not matter if these software are updated or not so they could be classified both as risky and dangerous to use**. They will be a risk before and after any update. All third party npm modules are removed in NodeJs in production. Terraform installs server removing unnecessary server software and this script that is executed is the place to decide what server software and versions to use. See also 3.1.1|
|15.1.2      |2    |**Implemented**.  See 15.1.1|
|15.1.3      |2    |**Implemented**.  Cube solve is very resource demanding and explained in the Documentation app. Admin has the control to decide when to execute resource demanding Behaviour Driven Development (BDD) and performance reports. See also 3.1.1|
|15.1.4      |3    |**Implemented**.  See 15.1.1|
|15.1.5      |3    |**Implemented**.  See 15.1.1|
|***V15.2***|    |***Security Architecture and Dependencies***|
|15.2.1      |1    |**Implemented**.  See 15.1.1|
|15.2.2      |2    |**Implemented**.  See 13.1.3|
|15.2.3      |2    |**Implemented**.  See 15.1.1|
|15.2.4      |3    |**Implemented**.  See 15.1.1|
|15.2.5      |3    |**Implemented**.  See 15.1.1|
|***V15.3***|    |***Defensive Coding***|
|15.3.1      |1    |**Implemented**.  Uses ISO20022. See also 3.1.1|
|15.3.2      |2    |**Implemented**.  Server requests are rejected if not status codes 200 or 201 are returned|
|15.3.3      |2    |**Implemented**.  Uses ORM database pattern and constraints in all objects that controls columns when applicable and tree shaking pattern. See also 3.1.1|
|15.3.4      |2    |**Implemented**.  Uses IP address that NodeJs captures in the request. Users have the right to use dynamic IP, VPN or corporate firewalls and more fingerprint data is used as explained in 3.1.1, 3.3.1, 3.5.1, 4.1.3, 4.1.5 and 10.2.1|
|15.3.5      |2    |**Implemented**.  See 15.3.3|
|15.3.6      |2    |**Implemented**.  Objects are sealed when necessary in server. Closure pattern is used so functions can only manipulate data. See 3.1.1|
|15.3.7      |2    |**Implemented**.  See 1.5.2, 2.4.1 and 3.1.1|
|***V15.4***|    |***Safe Concurrency***|
|15.4.1      |3    |**Implemented**.  Locks, rollback, commit and race condition patterns implemented. Se also 3.1.1|
|15.4.2      |3    |**Implemented**.  See 15.4.1|
|15.4.3      |3    |**Implemented**.  See 15.4.1|
|15.4.4      |3    |**Implemented**.  See 13.1.3, 15.1.3 and 15.4.1|

**V16 Security Logging and Error Handling**
|{#2kv}Requirement|Level|Status|
|:----------|:----|:-----|
|***V16.1***|    |***Security Logging Documentation***|
|16.1.1      |2    |**Implemented**.  Uses OpenApi integrated with JSDoc documentation and added documentation in the Documentation app that documents logging, what events are logged, log formats (JSON), where the logging is stored (ORM), how it is used, how access is controlled. Admin decides how long time to keep logs|
|***V16.2***|    |***General Logging***|
|16.2.1      |2    |**Implemented**.  Logs contain info about when, where, who and what.|
|16.2.2      |2    |**Implemented**.  UTC is used in server. All regional settings are supported in client|
|16.2.3      |2    |**Implemented**.  See 16.1.1|
|16.2.4      |2    |**Implemented**.  See 16.1.1|
|16.2.5      |2    |**Implemented**.  Encrypted request data in request body is not logged. Only request metadata is logged. All app instance security user data, including encryption keys, secrets, tokens and identifiers, is stored in memory only in server using closure pattern and dissapears when server is restarted. Access token is saved in ORM database for IAM functionality and not in logs. All objects can be changed to in memory only and access token can be erased by changing to in memory only for the given object in the ORM database and restart the server|
|***V16.3***|    |***Security Events***|
|16.3.1      |2    |**Implemented**.  All authentication operations are logged including type of authentication, successful, unsuccesful or failed attempts|
|16.3.2      |2    |**Implemented**.  See 16.3.1|
|16.3.3      |2    |**Implemented**.  See 3.1.1 and 16.3.1|
|16.3.4      |2    |**Implemented**.  See 3.1.1, 3.7.4 and 16.3.1|
|***V16.4***|    |***Log Protection***|
|16.4.1      |2    |**Implemented**.  Using tree shaking pattern to save log data|
|16.4.2      |2    |**Implemented**.  Logs only accessed by admin and can not be modified since no update or delete function implemented for logs|
|16.4.3      |2    |**Implemented**.  Logs are stored on same server only. Logs are not allowed to be transmitted to separate third party systems. Admin decides to transfer logs to localhost when necessary using tools such as rsync or microservice batch implemented|
|***V16.5***|    |***Error Handling***|
|16.5.1      |2    |**Implemented**.  User receives generic logographic error message whithout explanation while admin receives full information|
|16.5.2      |2    |**Implemented**.  Circuit breakers for microservices and Backend for External (BFE) implemented|
|16.5.3      |2    |**Implemented**.  Uses OpenApi that explains all error management. See also 3.1.1 and 16.5.1|
|16.5.4      |3    |**Implemented**.  uncaughtException and unhandledRejection server errors are implemented and logged. See also 16.5.3|

**V17 WebRTC**
|{#2kv}Requirement|Level|Status|
|:----------|:----|:-----|
|***V17.1***|    |***TURN Server***|
|17.1.1      |2    |**Not applicable**.  WebRTC not implemented|
|17.1.2      |3    |**Not applicable**.  WebRTC not implemented|
|***V17.2***|    |***Media***|
|17.2.1      |2    |**Not applicable**.  WebRTC not implemented|
|17.2.2      |2    |**Not applicable**.  WebRTC not implemented|
|17.2.3      |2    |**Not applicable**.  WebRTC not implemented|
|17.2.4      |2    |**Not applicable**.  WebRTC not implemented|
|17.2.5      |3    |**Not applicable**.  WebRTC not implemented|
|17.2.6      |3    |**Not applicable**.  WebRTC not implemented|
|17.2.7      |3    |**Not applicable**.  WebRTC not implemented|
|17.2.8      |3    |**Not applicable**.  WebRTC not implemented|
|***V17.3***|    |***Signaling***|
|17.3.1      |2    |**Not applicable**.  WebRTC not implemented|
|17.3.2      |2    |**Not applicable**.  WebRTC not implemented|